---
title: "Big Meadows Data Analysis"
author: "Jordan Coscia"
date: "`r Sys.Date()`"
output:
    html_document:
      theme: lumen
      toc: true
      toc_depth: 4
      toc_float:
        collapsed: true
---

Visualization and analysis of the trends in the plant and ground cover data in response to treatments conducted in Shenandoah National Park's Big Meadows between 1998 and 2022.

```{r Changelog, eval=FALSE, include=FALSE}
#June 6, 2024: Copied from May 2024 version. Added plots for tall oatgrass.

#June 18, 2024: Edited code to load in updated csv versions of all data. Cleaned up species consolidation and assigned statuses to genera. Added count to species list. Updated Woody, Forb, and Graminoid models.

#June 20, 2024: Updated Rare, Exotic, Robinia, Rubus, and Celastrus models. Updated effects panel plot.

#June 25, 2024: Set "echo=TRUE" for all model selection code chunks.

#January 21, 2025: Added export of plotly response variable and NMDS plots as widgets.
```
```{r R and Knitr Set Up, include=FALSE}
#Set Knitr Options
knitr::opts_chunk$set(echo=FALSE, warning=FALSE, message=FALSE, comment=NA)

#Set Up Scrolling Output
options(width = 60)
local({
  hook_output <- knitr::knit_hooks$get('output')
  knitr::knit_hooks$set(output = function(x, options) {
    if (!is.null(options$max.height)) options$attr.output <- c(
      options$attr.output,
      sprintf('style="max-height: %s;"', options$max.height))
    hook_output(x, options)})
})

#Set NA Value for Tables
options(knitr.kable.NA="-")
```
```{r Setup, include=FALSE}
#Clear Work Space
rm(list=ls())

#Load Libraries
library(cowplot) #Extract Plot Legends
library(DHARMa) #Mixed Model Diagnostics
library(easystats) #Model Checking & Reporting
library(effects) #Plot Interaction Terms
library(ggplot2) #Plots
library(ICC) #Intraclass Correlation
library(gridExtra) #Multi-Panel Plots
library(kableExtra)
library(leaflet) #Maps
library(lme4) #Mixed Models
library(MASS) #Negative Binomial Models
library(MuMIn) #Model Averaging
library(naniar) #Working with NAs
library(plotly) #Interactive Plots
library(raster) #Read .shp
library(readxl) #Read .xlsx
library(scatterplot3d) #Static 3D Plots
library(sjPlot) #Fancy Model Tables
library(tidyverse) #Data Management
library(tiff) #Import .tiff files
library(vegan) #Diversity Indices
library(zoo) #Missing Value Imputation

#Load Functions
source("Functions/addgrids3d.R") #source("http://www.sthda.com/sthda/RDoc/functions/addgrids3d.r")
source("Functions/pchIcons.r")
source("Functions/pairsPannelFunctions.r")

#Set Dplyr's Select Function as Default
select<-dplyr::select

#Set Plot Theme
theme_set(theme_classic())
Colors<-c("#FFB000", "#75BB6F", "#DC267F", "#648FFF", "#FE6100", "#8E57D0", "#59C3CE", "#9B9A9E")
Symbols<-c(23,21,22,24,25)
Shapes<-c("diamond", "circle", "square")
```

# Data Preparation

```{r Prepeare Transect Data}
#Load Data
Raw_Transects<-read.csv(file="Data/V_BM_zdd_Transects.csv")
Sites<-read.csv(file="Data/R_zdd_Sites.csv")
Points<-read.csv("Data/BM_Transect_Midpoints.csv")

#Merge Site and Point Coordinate Data
Transects<-Raw_Transects %>% 
  merge(Sites[,c("SiteID", "Site_Name")], by.x="TransID", by.y="SiteID") %>% 
  merge(Points, by.x="Label", by.y="TRNSC_ID", all.x=TRUE) %>% 
  select(TransID, Sampling_Group, Area, Management_Zone, LON, LAT) %>% 
  rename(Transect=TransID, Group=Sampling_Group, Zone=Management_Zone, Longitude=LON, Latitude=LAT) 

#Clear Unneeded Items
rm(list=c("Raw_Transects", "Sites", "Points"))
```

## Climate Data Sources

Total seasonal precipitation data for Big Meadows (Site ID VA28) from 1998 to 2024 in units of mg/L was obtained from the National Atmospheric Deposition Program's [National Trends Network Database](https://nadp.slh.wisc.edu/networks/national-trends-network/). Precipitation data for 2023 was not yet available at the time of download (June 18, 2024). Hourly ambient temperature and relative humidity data for Big Meadows (Site ID SHEN-BM) from January 1, 1998 to January 1, 2024 was obtained using the National Park Service's [Gaseous Pollutant & Meteorological Data Access](https://ard-request.air-resource.com).

```{r Prepare Climate Data}
Raw_Temperature<-read.csv("Data/NPS_GPMD_Shen_BM.csv", skip=9)
Raw_Precipitation<-read.csv("Data/NTN-va28-s-s-mgl.csv")

#Total Spring Precipitation
Precipitation<-Raw_Precipitation %>% 
  filter(seas=="Spring") %>% 
  select(yr, ppt) %>% 
  rename(Year=yr, Total_Spring_Precip=ppt)

#Date of Last Frost
Temperature<-Raw_Temperature %>% 
  select(-X) %>% 
  filter(SHEN.BM_TMP_DEGC!=-999) %>% 
  separate_wider_delim(DATE_TIME, " ", names=c("Date", "Hour", "AM/PM"), cols_remove=FALSE) %>% 
  mutate(Date=as.Date(Date, "%m/%d/%Y"), Year=as.numeric(format(Date, "%Y")), Month=as.numeric(format(Date, "%m"))) %>%
  group_by(Date, Month, Year) %>% 
  summarize(Min_Temp=round(min(SHEN.BM_TMP_DEGC), 2), .groups="keep") %>% 
  filter(Month==1|Month==2|Month==3|Month==4|Month==5|Month==6) %>% 
  filter(Min_Temp<=0) %>% 
  group_by(Year) %>%
  summarize(Last_Freeze=max(Date)) %>% 
  mutate(Last_Freeze=as.numeric(format(Last_Freeze, "%j")))

#Combine Climate Data
Climate<-Precipitation %>% 
  merge(Temperature, by="Year", all.y=TRUE)

#Clear Unneeded Items
rm(list=c("Raw_Temperature", "Temperature", "Raw_Precipitation", "Precipitation"))
```

## Treatment Data Formatting

Variables containing the number of years that have passed between the most recent burn, mow, fallow, cut, and sample treatment and a given year were calculated from a digitized version of the "Big Meadows Maintenance Schedule" chart. 

```{r Prepare Treatments Data}
#Load Data
Raw_Treatments<-read.csv("Data/Big_Meadows_Maintenance_Schedule.csv")

#Create Years Since Treatment Columns
Mow<-Raw_Treatments %>% 
  select(Year, Mow) %>% 
  mutate(East=case_when(grepl("E", Mow)~0), Central=case_when(grepl("C", Mow)~0), West=case_when(grepl("W", Mow)~0)) %>%
  group_by(East_Temp=cumsum(!is.na(East))) %>%
  mutate(East=East[1] + 1*(0:(length(East)-1))) %>%
  ungroup() %>% 
  group_by(Central_Temp=cumsum(!is.na(Central))) %>%
  mutate(Central=Central[1] + 1*(0:(length(Central)-1))) %>%
  ungroup() %>% 
  group_by(West_Temp=cumsum(!is.na(West))) %>%
  mutate(West=West[1] + 1*(0:(length(West)-1))) %>%
  ungroup() %>% 
  select(Year, East, West, Central) %>% 
  pivot_longer(cols=c("East", "West", "Central"), names_to="Group", values_to="Years_Since_Mow")
Burn<-Raw_Treatments %>% 
  select(Year, Burn) %>% 
  mutate(East=case_when(grepl("E", Burn)~0), Central=case_when(grepl("C", Burn)~0), West=case_when(grepl("W", Burn)~0)) %>%
  group_by(East_Temp=cumsum(!is.na(East))) %>%
  mutate(East=East[1] + 1*(0:(length(East)-1))) %>%
  ungroup() %>% 
  group_by(Central_Temp=cumsum(!is.na(Central))) %>%
  mutate(Central=Central[1] + 1*(0:(length(Central)-1))) %>%
  ungroup() %>% 
  group_by(West_Temp=cumsum(!is.na(West))) %>%
  mutate(West=West[1] + 1*(0:(length(West)-1))) %>%
  ungroup() %>% 
  select(Year, East, West, Central) %>% 
  pivot_longer(cols=c("East", "West", "Central"), names_to="Group", values_to="Years_Since_Burn")
Fallow<-Raw_Treatments %>% 
  select(Year, Fallow) %>% 
  mutate(East=case_when(grepl("E", Fallow)~0), Central=case_when(grepl("C", Fallow)~0), West=case_when(grepl("W", Fallow)~0)) %>%
  group_by(East_Temp=cumsum(!is.na(East))) %>%
  mutate(East=East[1] + 1*(0:(length(East)-1))) %>%
  ungroup() %>% 
  group_by(Central_Temp=cumsum(!is.na(Central))) %>%
  mutate(Central=Central[1] + 1*(0:(length(Central)-1))) %>%
  ungroup() %>% 
  group_by(West_Temp=cumsum(!is.na(West))) %>%
  mutate(West=West[1] + 1*(0:(length(West)-1))) %>%
  ungroup() %>% 
  select(Year, East, West, Central) %>% 
  pivot_longer(cols=c("East", "West", "Central"), names_to="Group", values_to="Years_Since_Fallow")
Cut<-Raw_Treatments %>% 
  select(Year, Cut) %>% 
  mutate(East=case_when(grepl("E", Cut)~0), Central=case_when(grepl("C", Cut)~0), West=case_when(grepl("W", Cut)~0)) %>%
  group_by(East_Temp=cumsum(!is.na(East))) %>%
  mutate(East=East[1] + 1*(0:(length(East)-1))) %>%
  ungroup() %>% 
  group_by(Central_Temp=cumsum(!is.na(Central))) %>%
  mutate(Central=Central[1] + 1*(0:(length(Central)-1))) %>%
  ungroup() %>% 
  group_by(West_Temp=cumsum(!is.na(West))) %>%
  mutate(West=West[1] + 1*(0:(length(West)-1))) %>%
  ungroup() %>% 
  select(Year, East, West, Central) %>% 
  pivot_longer(cols=c("East", "West", "Central"), names_to="Group", values_to="Years_Since_Cut")
Sample<-Raw_Treatments %>% 
  select(Year, Sample) %>% 
  mutate(East=case_when(grepl("E", Sample)~0), Central=case_when(grepl("C", Sample)~0), West=case_when(grepl("W", Sample)~0)) %>%
  group_by(East_Temp=cumsum(!is.na(East))) %>%
  mutate(East=East[1] + 1*(0:(length(East)-1))) %>%
  ungroup() %>% 
  group_by(Central_Temp=cumsum(!is.na(Central))) %>%
  mutate(Central=Central[1] + 1*(0:(length(Central)-1))) %>%
  ungroup() %>% 
  group_by(West_Temp=cumsum(!is.na(West))) %>%
  mutate(West=West[1] + 1*(0:(length(West)-1))) %>%
  ungroup() %>% 
  select(Year, East, West, Central) %>% 
  pivot_longer(cols=c("East", "West", "Central"), names_to="Group", values_to="Years_Since_Sample")

#Combine Into Treatment Data Frame
Treatments<-Mow %>% 
  merge(Burn, by=c("Year", "Group")) %>% 
  merge(Fallow, by=c("Year", "Group")) %>% 
  merge(Cut, by=c("Year", "Group")) %>% 
  merge(Sample, by=c("Year", "Group"))

#Clear Unneeded Items
rm(list=c("Raw_Treatments", "Mow", "Burn", "Fallow", "Cut", "Sample"))
```

Data from 1998 and 1999 were excluded from analysis due to incomparable survey methods to the remaining data (5 plots vs transects, plant data not able to be converted to number of encounters). Data from 2000 and 2003 were excluded because only woody species were surveyed in those years. Data from 2004 was excluded because plants were only identified to genus in this year.

```{r Prepare Visits Data}
#Load Data
Raw_Visits<-read.csv(file="Data/R_SiteVisits.csv")

#Reorganize Columns, Remove Spring Surveys, and Exclude 1998 and Woody-Only Survey Years
Visits<-Raw_Visits %>% 
  filter(!grepl("Location dropped", Notes)) %>% 
  separate(col=SiteVisit_ID, into=c("Year", "Month", "Day_Pole"), sep="-", remove=FALSE) %>% 
  separate(col=Day_Pole, into=c("Day", "TransID"), sep="_") %>% 
  filter(Season=="Summer") %>% 
  select(SiteVisit_ID, TransID, Year) %>% 
  rename(Visit=SiteVisit_ID, Transect=TransID) %>% 
  merge(Transects, by="Transect", all.x=TRUE) %>% 
  merge(Climate, by="Year", all.x=TRUE) %>% 
  merge(Treatments, by=c("Year", "Group"), all.x=TRUE) %>% 
  select(Visit, Transect, Year, Group, Area:Years_Since_Sample) %>% 
  filter(Year!=1998&Year!=1999&Year!=2000&Year!=2003&Year!=2007)

#Set All Wetland Mowings and Cuttings to Unknown/NA
Visits$Years_Since_Mow[Visits$Zone=="Wetland"]<-NA
Visits$Years_Since_Mow[Visits$Zone=="Wetland"]<-NA

#Fix Column Types
Visits$Year<-as.numeric(Visits$Year)
Visits$Group<-as.factor(Visits$Group)
Visits$Area<-as.factor(Visits$Area)
Visits$Zone<-as.factor(Visits$Zone)

#Clear Unneeded Items
rm(list=c("Raw_Visits", "Climate"))
```
```{r Prepare Species Data}
#Load Data
Raw_Species<-read.csv("Data/Shenandoah_Species_List_wbc011024.csv", na.strings=c(""))

#Change Column Names
Species<-Raw_Species %>% 
  rename("Corrected_Code"="Corrected_Codes", "Consolidated_Code"="Consolidated.Corrected_Codes")

#Correct Names and Consolidated Codes
Species$Genus[Species$Genus=="Botrychium"]<-"Sceptridium"
#Species$Consolidated_Code[Species$Latin=="Rubus setosus"]<-"RUBSET"
Species$Consolidated_Code[Species$Consolidated_Code=="ACTRAC"]<-"Actaea"
Species$Consolidated_Code[Species$Consolidated_Code=="Aronia"]<-"AROSPP"
Species$Consolidated_Code[Species$Consolidated_Code=="AROMEL"]<-"AROSPP"
Species$Consolidated_Code[Species$Consolidated_Code=="Aster"]<-"Symphy"
Species$Consolidated_Code[Species$Consolidated_Code=="Aster_f"]<-"Astera_f"
Species$Consolidated_Code[Species$Consolidated_Code=="ELETEN"]<-"Eleoch"
Species$Consolidated_Code[Species$Consolidated_Code=="LOLPRA"]<-"Lolium"
Species$Consolidated_Code[Species$Consolidated_Code=="LOLPER"]<-"Lolium"
Species$Consolidated_Code[Species$Consolidated_Code=="SCHARU"]<-"Lolium"
Species$Consolidated_Code[Species$Consolidated_Code=="MUHGLO"]<-"Muhlen"
Species$Consolidated_Code[Species$Consolidated_Code=="POLCAE"]<-"Polygo"
Species$Consolidated_Code[Species$Consolidated_Code=="POACOM"]<-"Poa"
Species$Consolidated_Code[Species$Consolidated_Code=="POAPRA"]<-"Poa"
Species$Consolidated_Code[Species$Consolidated_Code=="RUBSET"]<-"Rubus"
Species$Consolidated_Code[Species$Consolidated_Code=="THATHA"]<-"Thalic"

#Add Code Rows for Smilax, Sceptr, SCEMUL, PERSAG, LOLARU, and Oenoth
Species<-Species %>% 
  add_row(Code="Smilax", Alt_Code="Smilax", Corrected_Code="Smilax", Consolidated_Code="Smilax", Latin="Smilax spp.", Family="Smilacaceae", Genus="Smilax", Lifeform="Vine", Status="N", GRank="G5", SRank="S5") %>% 
  add_row(Code="Sceptr", Alt_Code="Sceptr", Corrected_Code="Sceptr", Consolidated_Code="Sceptr", Latin="Sceptridium spp.", Family="Ophioglossaceae", Genus="Sceptridium", Lifeform="Fern", Status="N") %>% 
  add_row(Code="SCEMUL", Alt_Code="SCEMUL", Corrected_Code="SCEMUL", Consolidated_Code="SCEMUL", Latin="Sceptridium multifidum", Family="Ophioglossaceae", Genus="Sceptridium", Lifeform="Fern", Status="N", GRank="G5", SRank="S1") %>%
  add_row(Code="PERSAG", Alt_Code="POLSAG", Corrected_Code="POLSAG", Consolidated_Code="Polygo", Latin="Polygonum sagittatum", Family="Polygonaceae", Genus="Polygonum", Lifeform="Herb", Status="N") %>%
  add_row(Code="LOLARU", Alt_Code="LOLARU", Corrected_Code="LOLARU", Consolidated_Code="Lolium", Latin="Lolium arundinaceum", Family="Poaceae", Genus="Lolium", Lifeform="Graminoid", Status="Ex") %>%
  add_row(Code="Oenoth", Alt_Code="Oenoth", Corrected_Code="Oenoth", Consolidated_Code="Oenoth", Latin="Oenothera spp.", Family="Ongraceae", Genus="Oenothera", Lifeform="Herb", Status="U")

#Assign GRank and SRank to Species Noted in "Rare Species"Big.Meadows.Rare.Species" Column and Remove "GNR", "SNR", and "SNA"
Species$GRank[Species$Latin=="Sceptridium multifidum"]<-"G5"
Species$SRank[Species$Latin=="Sceptridium multifidum"]<-"S1"
Species$GRank[Species$Latin=="Sceptridium oneidense"]<-"G4"
Species$SRank[Species$Latin=="Sceptridium oneidense"]<-"S1"
Species$GRank[Species$Latin=="Abies balsamea"]<-"G5"
Species$SRank[Species$Latin=="Abies balsamea"]<-"S1"
Species$GRank[Species$GRank=="GNR"]<-NA
Species$SRank[Species$SRank=="SNR"]<-NA
Species$SRank[Species$SRank=="SNA"]<-NA

#Assign Native Status to Genera with Only Native Species Occurring in Big Meadows
Species$Status[Species$Latin=="Actaea spp."]<-"N"
Species$Status[Species$Latin=="Ambrosia spp."]<-"N"
Species$Status[Species$Latin=="Anemone spp."]<-"N"
Species$Status[Species$Latin=="Antennaria spp."]<-"N"
Species$Status[Species$Latin=="Apocynum spp."]<-"N"
Species$Status[Species$Latin=="Aronia spp."]<-"N"
Species$Status[Species$Latin=="Asclepias spp."]<-"N"
Species$Status[Species$Latin=="Betula spp."]<-"N"
Species$Status[Species$Latin=="Calystegia spp."]<-"N"
Species$Status[Species$Latin=="Carex spp."]<-"N"
Species$Status[Species$Latin=="Carya spp."]<-"N"
Species$Status[Species$Latin=="Corylus spp."]<-"N"
Species$Status[Species$Latin=="Crataegus spp."]<-"N"
Species$Status[Species$Latin=="Danthonia spp."]<-"N"
Species$Status[Species$Latin=="Dichanthelium spp."]<-"N"
Species$Status[Species$Latin=="Eleocharis spp."]<-"N"
Species$Status[Species$Latin=="Epilobium spp."]<-"N"
Species$Status[Species$Latin=="Erigeron spp."]<-"N"
Species$Status[Species$Latin=="Eurybia spp."]<-"N"
Species$Status[Species$Latin=="Geum spp."]<-"N"
Species$Status[Species$Latin=="Gnaphalium spp."]<-"N"
Species$Status[Species$Latin=="Houstonia spp."]<-"N"
Species$Status[Species$Latin=="Ilex spp."]<-"N"
Species$Status[Species$Latin=="Juncus spp."]<-"N"
Species$Status[Species$Latin=="Lilium spp."]<-"N"
Species$Status[Species$Latin=="Lycopus spp."]<-"N"
Species$Status[Species$Latin=="Melanthium spp."]<-"N"
Species$Status[Species$Latin=="Muhlenbergia spp."]<-"N"
Species$Status[Species$Latin=="Oxalis spp."]<-"N"
Species$Status[Species$Latin=="Pinus spp."]<-"N"
Species$Status[Species$Latin=="Polygonum spp."]<-"N"
Species$Status[Species$Latin=="Prenanthes spp."]<-"N"
Species$Status[Species$Latin=="Quercus spp."]<-"N"
Species$Status[Species$Latin=="Rhododendron spp."]<-"N"
Species$Status[Species$Latin=="Rhus spp."]<-"N"
Species$Status[Species$Latin=="Rubus spp."]<-"N"
Species$Status[Species$Latin=="Solidago spp."]<-"N"
Species$Status[Species$Latin=="Spiranthes spp."]<-"N"
Species$Status[Species$Latin=="Symphyotrichum spp."]<-"N"
Species$Status[Species$Latin=="Thalictrum spp."]<-"N"
Species$Status[Species$Latin=="Uvularia spp."]<-"N"
Species$Status[Species$Latin=="Vaccinium spp."]<-"N"
Species$Status[Species$Latin=="Viola spp."]<-"N"

#Assign Exotic Status to Genera with Only Exotic Species Occurring in Big Meadows
Species$Status[Species$Latin=="Agrostis spp."]<-"Ex"
Species$Status[Species$Latin=="Carduus spp."]<-"Ex"
Species$Status[Species$Latin=="Lolium spp."]<-"Ex"
Species$Status[Species$Latin=="Poa spp."]<-"Ex"
Species$Status[Species$Latin=="Tragopogon spp."]<-"Ex"
Species$Status[Species$Latin=="Trifolium spp."]<-"Ex"

#Assign Unknown Status Genera with Both Native and Exotic Species Occuring in Big Meadows
Species$Status[Species$Latin=="Allium spp."]<-"U"
Species$Status[Species$Latin=="Cerastium spp."]<-"U"
Species$Status[Species$Latin=="Cirsium spp."]<-"U"
Species$Status[Species$Latin=="Dioscorea spp."]<-"U"
Species$Status[Species$Latin=="Fallopia spp."]<-"U"
Species$Status[Species$Latin=="Festuca spp."]<-"U"
Species$Status[Species$Latin=="Galium spp."]<-"U"
Species$Status[Species$Latin=="Geranium spp."]<-"U"
Species$Status[Species$Latin=="Helianthus spp."]<-"U"
Species$Status[Species$Latin=="Hieracium spp."]<-"U"
Species$Status[Species$Latin=="Hypericum spp."]<-"U"
Species$Status[Species$Latin=="Lactuca spp."]<-"U"
Species$Status[Species$Latin=="Picea spp."]<-"U"
Species$Status[Species$Latin=="Plantago spp."]<-"U"
Species$Status[Species$Latin=="Potentilla spp."]<-"U"
Species$Status[Species$Latin=="Prunus spp."]<-"U"
Species$Status[Species$Latin=="Ranunculus spp."]<-"U"
Species$Status[Species$Latin=="Rosa spp."]<-"U"
Species$Status[Species$Latin=="Stellaria spp."]<-"U"

#Clear Unneeded Items
rm(list=c("Raw_Species"))
```

## Plant Data Preparation

Plant data for each survey is prepared by summarizing the total number of times a plant species was encountered in each survey. This is done by summarizing the total length of all of sections of each species recorded per visit for high plants (from the "Sh_Length" variable the file "V_BM_Transects_High_info") and the total number of times a plant species was encountered per visit for the low plants (by either counting the number of distinct values per visit in the "" variable in the file "V_BM_Transects_Low" file or by summing the "HITS" values for each visit from the files "V_BM_Transects_Low_1999" and "V_BM_Transects_Low_2000").

```{r Prepeare High Plant Data}
#Load Data
Raw_High_Plants<-read.csv(file="Data/V_BM_Transects_High_info.csv")

#Clean Up Species Data, Round Lengths to Meter Counts
High_Plants<-Raw_High_Plants %>% 
  select(SiteVisit_ID, SppCode, Sh_Length) %>% 
  filter(SppCode!="NONE"&SppCode!="TRAILS"&SppCode!="UNKSPP"&SppCode!="UNKDIC"&SppCode!="UNKMON"&!is.na(Sh_Length)) %>% 
  rename(Code=SppCode) %>%
  group_by(SiteVisit_ID, Code) %>% 
  summarize(Length=sum(Sh_Length), .groups="keep") %>% 
  ungroup() %>%
  mutate(Count=case_when(Length<1~1, Length>=1~round(Length, 0))) %>% 
  select(-Length) %>% 
  rename(Visit=SiteVisit_ID)

#Clear Unneeded Items
rm(list=c("Raw_High_Plants"))
```
```{r Prepeare Low Plant Data}
#Load Data
Raw_Low_Plants<-read.csv(file="Data/V_BM_Transects_Low.csv")
Low_Plants_2000<-read.csv(file="Data/V_BM_Transects_Low_2000.csv")

#Create Species by Total Hits Data Frame from Raw 1999 and 2000+ Data
Low_Plants_Recent<-Raw_Low_Plants %>%
  select(SiteVisit_ID, SppCode, Dist_m) %>% 
  filter(SppCode!="NONE"&SppCode!="TRAILS"&SppCode!="UNKSPP"&SppCode!="UNKDIC"&SppCode!="UNKMON"&!is.na(Dist_m)) %>% 
  group_by(SiteVisit_ID, SppCode) %>% 
  summarize(HITS=n(), .groups="keep") %>% 
  ungroup() %>% 
  rename(SPPCODE=SppCode)

#Combine All Data and Clean Up Species Data
Low_Plants<-Low_Plants_Recent %>% 
  rbind(Low_Plants_2000) %>% 
  filter(SPPCODE!="NONE"&SPPCODE!="TRAILS"&SPPCODE!="UNKSPP"&SPPCODE!="UNKDIC"&SPPCODE!="UNKMON") %>% 
  rename(Code=SPPCODE) %>% 
  group_by(SiteVisit_ID, Code) %>% 
  summarize(Count=sum(HITS), .groups="keep") %>% 
  ungroup() %>%
  rename(Visit=SiteVisit_ID)

#Clear Unneeded Items
rm(list=c("Raw_Low_Plants", "Low_Plants_2000", "Low_Plants_Recent"))
```
```{r Prepare Combined Data}
#Combine High and Low Plant Data for Visits in "Visit" Data
Plants<-High_Plants %>% 
  rbind(Low_Plants) %>% 
  filter(Visit %in% Visits$Visit) %>% 
  group_by(Visit, Code) %>% 
  summarize(Count=sum(Count), .groups="keep") %>% 
  ungroup() %>% 
  merge(Species, by="Code", all.x=TRUE) %>% 
  select(Visit, Code, Corrected_Code, Consolidated_Code, Count, Latin, Family, Genus, Lifeform, Status, GRank, SRank) %>% 
  arrange(Visit)

#Combine Easily Confused Species by Consolidated Code, Remove Family IDs
Plants<-Plants %>% 
  filter(!grepl("_f$", Consolidated_Code)) %>% 
  group_by(Visit, Consolidated_Code) %>% 
  summarize(Count=sum(Count), .groups="keep") %>% 
  ungroup() %>% 
  rename(Code=Consolidated_Code) %>% 
  merge(Species, by="Code", all.x=TRUE) %>% 
  select(Visit, Code, Count, Latin, Family, Genus, Lifeform, Status, GRank, SRank) %>% 
  arrange(Visit)

#Fix Column Types
Plants$Lifeform<-as.factor(Plants$Lifeform)
Plants$Status<-as.factor(Plants$Status)
Plants$GRank<-as.factor(Plants$GRank)
Plants$SRank<-as.factor(Plants$SRank)
  
#Clear Unneeded Items
rm(list=c("High_Plants", "Low_Plants", "Species"))
```


## Response Variable Calculations

The percent of native woody plants, native forbs, native graminoids, rare native plants, exotic plants, *Robinia*, and *Rubus* out of total plants encountered for each visit were calculated to create response variables for use in modeling.

```{r Calcualte Other Response Variables}
#Calculate Total Counts
Total_Count<-Plants %>%
  group_by(Visit) %>%
  summarize(Total_Count=sum(Count))

#Calculate Percent Count Response Variables
Woody<-Plants %>%
  filter(Lifeform=="Tree"|Lifeform=="Shrub"|Lifeform=="Vine") %>%
  group_by(Visit) %>%
  summarize(Woody_Count=sum(Count)) %>%
  merge(Total_Count, by="Visit") %>%
  mutate(Percent_Woody=(round(Woody_Count/Total_Count,3))*100) %>% 
  select(-Total_Count)
Forb<-Plants %>%
  filter(Lifeform=="Herb"|Lifeform=="Fern") %>%
  group_by(Visit) %>%
  summarize(Forb_Count=sum(Count)) %>%
  merge(Total_Count, by="Visit") %>%
  mutate(Percent_Forb=(round(Forb_Count/Total_Count,3))*100) %>% 
  select(-Total_Count)
Graminoid<-Plants %>%
  filter(Lifeform=="Graminoid") %>%
  group_by(Visit) %>%
  summarize(Graminoid_Count=sum(Count)) %>%
  merge(Total_Count, by="Visit") %>%
  mutate(Percent_Graminoid=(round(Graminoid_Count/Total_Count,3))*100) %>%
  select(-Total_Count)
Rare<-Plants %>%
  filter(GRank=="G1"|GRank=="G2"|SRank=="S1"|SRank=="S2"|SRank=="S1S2") %>%
  group_by(Visit) %>%
  summarize(Rare_Count=sum(Count)) %>%
  merge(Total_Count, by="Visit") %>%
  mutate(Percent_Rare=(round(Rare_Count/Total_Count,3))*100) %>%
  select(-Total_Count)
Exotic<-Plants %>%
  filter(Status=="Ex") %>%
  group_by(Visit) %>%
  summarize(Exotic_Count=sum(Count)) %>%
  merge(Total_Count, by="Visit") %>%
  mutate(Percent_Exotic=(round(Exotic_Count/Total_Count,3))*100)  %>%
  select(-Total_Count)
Robinia<-Plants %>%
  filter(Genus=="Robinia") %>%
  group_by(Visit) %>%
  summarize(Robinia_Count=sum(Count)) %>%
  merge(Total_Count, by="Visit") %>%
  mutate(Percent_Robinia=(round(Robinia_Count/Total_Count,3))*100)  %>%
  select(-Total_Count)
Rubus<-Plants %>%
  filter(Genus=="Rubus") %>%
  group_by(Visit) %>%
  summarize(Rubus_Count=sum(Count)) %>%
  merge(Total_Count, by="Visit") %>%
  mutate(Percent_Rubus=(round(Rubus_Count/Total_Count,3))*100)  %>%
  select(-Total_Count)
Oatgrass<-Plants %>%
  filter(Latin=="Arrhenatherum elatius") %>%
  group_by(Visit) %>%
  summarize(Oatgrass_Count=sum(Count)) %>%
  merge(Total_Count, by="Visit") %>%
  mutate(Percent_Oatgrass=(round(Oatgrass_Count/Total_Count,3))*100)  %>%
  select(-Total_Count)
Celastrus<-Plants %>%
  filter(Code=="CELORB") %>%
  group_by(Visit) %>%
  summarize(Celastrus_Count=sum(Count)) %>%
  merge(Total_Count, by="Visit") %>%
  mutate(Percent_Celastrus=(round(Celastrus_Count/Total_Count,3))*100)  %>%
  select(-Total_Count)

#Combine Response Variables, Filling NAs with 0s
Response_Variables<-Total_Count %>% 
  merge(Woody, by="Visit", all.x=TRUE) %>% 
  merge(Forb, by="Visit", all.x=TRUE) %>% 
  merge(Graminoid, by="Visit", all.x=TRUE) %>%
  merge(Rare, by="Visit", all.x=TRUE) %>%
  merge(Exotic, by="Visit", all.x=TRUE) %>%
  merge(Robinia, by="Visit", all.x=TRUE) %>% 
  merge(Rubus, by="Visit", all.x=TRUE) %>% 
  merge(Oatgrass, by="Visit", all.x=TRUE) %>% 
  merge(Celastrus, by="Visit", all.x=TRUE) %>% 
  replace(is.na(.), 0)

#Add Response Variables to Visit and Remove Visit with No Data
Visits<-Visits %>% 
  merge(Response_Variables, by="Visit", all.x=TRUE) %>% 
  filter(Visit!="2015-07-01_BMMC08")

#Set Factor Level Order for Zone and Group
Visits$Zone<-factor(Visits$Zone, levels=c("Central", "East", "West", "Wetland"))
Visits$Group<-factor(Visits$Group, levels=c("Central", "East", "West"))

#Clear Unneeded Items
rm(list=c("Woody", "Forb", "Graminoid", "Rare", "Exotic", "Robinia", "Rubus", "Oatgrass", "Celastrus", "Response_Variables"))
```

Prior to analysis, all transects within a treatment group were used to create yearly per-group average values to prevent error inflation due to sub-sampling.

```{r Calculate Variable Averages, message=FALSE, warning=FALSE}
#Create Species by Total Count Matrix
Matrix<-Plants[,c("Visit", "Code","Count")] %>% 
  pivot_wider(names_from=Code, values_from=Count, values_fill=0, names_sort=TRUE)

#Make Matrix of Percent Counts
Counts<-Matrix %>% 
  merge(Total_Count, by="Visit") %>%
  mutate(across(2:ncol(Matrix), ~(round(.x/Total_Count,3))*100)) %>% 
  select(-Total_Count)

#Get First and Last Species in Matrix
First_Spp<-colnames(Matrix[,2])
Last_Spp<-colnames(Matrix[,ncol(Matrix)])

#Create Full Data Matrix
Full<-Visits %>% 
  merge(Counts, by="Visit")

#Average Treatments Separately (no need for sd)
Treat_Avs<-Full %>% 
  group_by(Year, Zone) %>% 
  summarize(Total_Spring_Precip=mean(Total_Spring_Precip), Last_Freeze=max(Last_Freeze), across(Years_Since_Mow:Years_Since_Cut, ~mean(.x)), .groups="keep")

#Calculate Variable Averages per Year for Each Zone
Var_Avs<-Full %>% 
  group_by(Year, Zone) %>% 
  summarize(across(Woody_Count:Percent_Celastrus, list(Mean=mean, SD=sd)), .groups="keep") %>% 
  mutate(across(Woody_Count_Mean:Percent_Celastrus_SD, round, 1))

#Calculate Plant Species Averages per Year for Each Zone
Plant_Avs<-Full %>% 
  group_by(Year, Zone) %>% 
  summarize(across(First_Spp:Last_Spp, ~mean(.x)), .groups="keep") %>% 
  mutate(across(First_Spp:Last_Spp, round, 1))

#Combine Averaged Data
Zones<-Treat_Avs %>% 
  merge(Var_Avs, by=c("Year","Zone")) %>% 
  merge(Plant_Avs, by=c("Year","Zone"))

#Set Factor Levels
Zones$Zone<-factor(Zones$Zone, levels=levels(Visits$Zone))

#Convert to Data Frame for Plotly
Zones<-as.data.frame(Zones)

#Clear Unneeded Items
rm(list=c("Counts", "Total_Count", "Treat_Avs", "Var_Avs", "Plant_Avs", "Matrix"))
```

# Species List

The list below contains all taxa used in this analysis. Genera with species that were often confused during data collection were analyzed at the genus level with the exception of state or globally rare species of interest, which were kept at the species level even when other species in their genus were grouped to genus.

```{r Species List}
#Generate Species List
Species_List<-Plants %>%
  group_by(Code, Latin, Lifeform, Status, GRank, SRank) %>%
  count(Code) %>%
  ungroup() %>% 
  arrange(Latin) %>%
  rename(Count=n)

#Print Species List
Species_List %>%
  kable(col.names=c("Code", "Scientific Name", "Lifeform", "Status", "Global Rank", "State Rank", "Total Count"), align=c("l", "l", "l", "c", "c", "c", "c"), caption="Table 1: Taxa Used in Analysis") %>%
  column_spec(1, italic=TRUE, width_max="3.5in") %>% 
  kable_styling("striped", full_width=F, fixed_thead=T) %>% 
  scroll_box( height="500px")

#Save Species List
write.csv(Species_List, "Output/Species_List.csv")
```

# Map

Map was created using the R package [leaflet](https://cran.r-project.org/web/packages/leaflet/leaflet.pdf).

```{r Create Plot Style Guides}
#Create Zone Plot Color and Shape Guide
Zone_Colors<-data.frame(Zone=levels(Visits$Zone)) %>%
  mutate(Color=rep(Colors,len=(length(levels(Visits$Zone))))) %>%
  mutate(Symbol=rep(Symbols,len=(length(levels(Visits$Zone))))) %>% 
  mutate(Shape=rep(Shapes,len=(length(levels(Visits$Zone))))) %>% 
  select(Zone, Color, Symbol, Shape)
Zone_Colors$Zone<-factor(Zone_Colors$Zone, levels=levels(Visits$Zone))

#Create Group Plot Color and Shape Guide
Group_Colors<-Zone_Colors %>% 
  filter(Zone!="Wetland") %>% 
  rename(Group=Zone)
Group_Colors$Group<-factor(Group_Colors$Group, levels=levels(Visits$Group))
```
```{r Map}
#Load Shapefiles
Raw_Zones<-raster::shapefile("Shapefiles/bm_zones_ply.shp")

#Project Shapefiles
Zone_Polygons<-spTransform(Raw_Zones, CRS("+proj=longlat +datum=WGS84 +no_defs"))

#Add Colors to Map Data
Map_Data<-Transects %>% 
  merge(Zone_Colors, by="Zone") %>% 
  rename(Zone_Color=Color, Zone_Symbol=Symbol, Zone_Shape=Shape) %>% 
  merge(Group_Colors, by="Group") %>% 
  rename(Group_Color=Color, Group_Symbol=Symbol, Group_Shape=Shape) %>% 
  select(Transect, Group, Zone, Longitude, Latitude, Zone_Color:Group_Shape)
Map_Data$Zone<-factor(Map_Data$Zone, levels=levels(Visits$Zone))
Map_Data$Group<-factor(Map_Data$Group, levels=levels(Visits$Group))

#Make Map
leaflet(Map_Data, options=leafletOptions(minZoom=15, maxZoom=18)) %>% 
  addProviderTiles(providers$Esri.WorldImagery) %>%
  addScaleBar(position="bottomright") %>% 
  addPolygons(data=Zone_Polygons, color=c("#DC267F","#75BB6F","#FFB000","#648FFF"), weight=3, smoothFactor=0.5, opacity=1.0, fillOpacity=0.25, fillColor=c("#DC267F","#75BB6F","#FFB000","#648FFF"), label=Zone_Polygons@data[["SECT_NAME"]]) %>%
  addMarkers(data=Map_Data, group="Zone", popup=paste("<b>", Map_Data$Transect, "<b>"), label=paste(Map_Data$Transect), icon=~icons(iconUrl=pchIcons(pch=Zone_Symbol, col="black", bg=Zone_Color, width=40, height=40, lwd=4), iconAnchorX=20, iconAnchorY=20, popupAnchorX=20, popupAnchorY=0)) %>% 
  addLegend(title="Zone", group="Zone", colors=Zone_Colors$Color, labels=Zone_Colors$Zone, opacity=1) %>% 
  addMarkers(data=Map_Data, group="Group", popup=paste("<b>", Map_Data$Transect, "<b>"), label=paste(Map_Data$Transect), icon=~icons(iconUrl=pchIcons(pch=Group_Symbol, col="black", bg=Group_Color, width=40, height=40, lwd=4), iconAnchorX=20, iconAnchorY=20, popupAnchorX=20, popupAnchorY=0)) %>% 
  addLayersControl(baseGroups=c("Zone", "Group"), options=(layersControlOptions(collapsed=FALSE))) %>%
  hideGroup("Group")

#Export Map Data
#write.csv(Map_Data,"Big_Meadows_Map_Data.csv")

#Clear Unneeded Items
#rm(list=c("Colors", "Shapes", "Symbols", "pchIcons", "Raw_Zones", "Raster", "Zone_Polygons", "Map_Data", "Group_Colors", "Transects", "Visits"))
```

# Chosen Response Variables

Response variable plot was created using the R package [plotly](https://cran.r-project.org/web/packages/plotly/plotly.pdf).

```{r Prep Burn, Mow, and Cut Years}
#Remove Wetland Points
Zones<-Zones %>% 
  filter(Zone!="Wetland")
Full<-Full %>% 
  filter(Zone!="Wetland")

#Select Response Variable Columns
Response_Variables<-c("Percent_Woody_Mean", "Percent_Forb_Mean", "Percent_Graminoid_Mean", "Percent_Rare_Mean", "Percent_Exotic_Mean", "Percent_Robinia_Mean", "Percent_Rubus_Mean", "Percent_Oatgrass_Mean", "Percent_Celastrus_Mean")

#Select Burn Years
Central_Burn_Years<-Treatments %>% 
  filter(Years_Since_Burn==0 & Group=="Central") %>% 
  select(Year) %>% 
  filter(Year!=2000)
East_Burn_Years<-Treatments %>% 
  filter(Years_Since_Burn==0 & Group=="East") %>% 
  select(Year) %>% 
  filter(Year!=2000)
West_Burn_Years<-Treatments %>% 
  filter(Years_Since_Burn==0 & Group=="West") %>% 
  select(Year) %>% 
  filter(Year!=2000&Year!=2022)

#Complete Response Values for Missing Burn Years Using Interpolation
Central_Burn_Values<-Zones %>% 
  filter(Zone=="Central") %>% 
  select(Year,  Zone, paste(Response_Variables)) %>% 
  merge(Central_Burn_Years, all=TRUE) %>% 
  mutate(Burn_Year=case_when(Year %in% Central_Burn_Years$Year~"Y")) %>% 
  mutate(across(Percent_Woody_Mean:Percent_Celastrus_Mean, ~na.approx(.x))) %>% 
  filter(Burn_Year=="Y") %>% 
  replace_na(list(Zone="Central")) %>% 
  select(-Burn_Year)
East_Burn_Values<-Zones %>% 
  filter(Zone=="East") %>% 
  select(Year, Zone, paste(Response_Variables)) %>% 
  merge(East_Burn_Years, all=TRUE) %>% 
  mutate(Burn_Year=case_when(Year %in% East_Burn_Years$Year~"Y")) %>% 
  mutate(across(Percent_Woody_Mean:Percent_Celastrus_Mean, ~na.approx(.x))) %>% 
  filter(Burn_Year=="Y") %>% 
  replace_na(list(Zone="East")) %>% 
  select(-Burn_Year)
West_Burn_Values<-Zones %>% 
  filter(Zone=="West") %>% 
  select(Year, Zone, paste(Response_Variables)) %>% 
  merge(West_Burn_Years, all=TRUE) %>% 
  mutate(Burn_Year=case_when(Year %in% West_Burn_Years$Year~"Y")) %>% 
  mutate(across(Percent_Woody_Mean:Percent_Celastrus_Mean, ~na.approx(.x))) %>% 
  filter(Burn_Year=="Y") %>% 
  replace_na(list(Zone="West")) %>% 
  select(-Burn_Year)

#Combine All Burn Year Data
Burn_Years<-Central_Burn_Values %>% 
  rbind(East_Burn_Values, West_Burn_Values)

#Select Mow Years
Central_Mow_Years<-Treatments %>% 
  filter(Years_Since_Mow==0 & Group=="Central") %>% 
  select(Year) %>% 
  filter(Year!=2000)
East_Mow_Years<-Treatments %>% 
  filter(Years_Since_Mow==0 & Group=="East") %>% 
  select(Year) %>% 
  filter(Year!=2000)
West_Mow_Years<-Treatments %>% 
  filter(Years_Since_Mow==0 & Group=="West") %>% 
  select(Year) %>% 
  filter(Year!=2000&Year!=2023)

#Complete Response Values for Missing Mow Years Using Interpolation
Central_Mow_Values<-Zones %>% 
  filter(Zone=="Central") %>% 
  select(Year,  Zone, paste(Response_Variables)) %>% 
  merge(Central_Mow_Years, all=TRUE) %>% 
  mutate(Mow_Year=case_when(Year %in% Central_Mow_Years$Year~"Y")) %>% 
  mutate(across(Percent_Woody_Mean:Percent_Celastrus_Mean, ~na.approx(.x))) %>% 
  filter(Mow_Year=="Y") %>% 
  replace_na(list(Zone="Central")) %>% 
  select(-Mow_Year)
East_Mow_Values<-Zones %>% 
  filter(Zone=="East") %>% 
  select(Year, Zone, paste(Response_Variables)) %>% 
  merge(East_Mow_Years, all=TRUE) %>% 
  mutate(Mow_Year=case_when(Year %in% East_Mow_Years$Year~"Y")) %>% 
  mutate(across(Percent_Woody_Mean:Percent_Celastrus_Mean, ~na.approx(.x))) %>% 
  filter(Mow_Year=="Y") %>% 
  replace_na(list(Zone="East")) %>% 
  select(-Mow_Year)
West_Mow_Values<-Zones %>% 
  filter(Zone=="West") %>% 
  select(Year, Zone, paste(Response_Variables)) %>% 
  merge(West_Mow_Years, all=TRUE) %>% 
  mutate(Mow_Year=case_when(Year %in% West_Mow_Years$Year~"Y")) %>% 
  mutate(across(Percent_Woody_Mean:Percent_Celastrus_Mean, ~na.approx(.x))) %>% 
  filter(Mow_Year=="Y") %>% 
  replace_na(list(Zone="West")) %>% 
  select(-Mow_Year)

#Combine All Mow Year Data
Mow_Years<-Central_Mow_Values %>% 
  rbind(East_Mow_Values, West_Mow_Values)

#Select Cut Years
Central_Cut_Years<-Treatments %>% 
  filter(Years_Since_Cut==0 & Group=="Central") %>% 
  select(Year) %>% 
  filter(Year!=2000)
East_Cut_Years<-Treatments %>% 
  filter(Years_Since_Cut==0 & Group=="East") %>% 
  select(Year) %>% 
  filter(Year!=2000)
West_Cut_Years<-Treatments %>% 
  filter(Years_Since_Cut==0 & Group=="West") %>% 
  select(Year) %>% 
  filter(Year!=2000)

#Complete Response Values for Missing Cut Years Using Interpolation
Central_Cut_Values<-Zones %>% 
  filter(Zone=="Central") %>% 
  select(Year,  Zone, paste(Response_Variables)) %>% 
  merge(Central_Cut_Years, all=TRUE) %>% 
  mutate(Cut_Year=case_when(Year %in% Central_Cut_Years$Year~"Y")) %>% 
  mutate(across(Percent_Woody_Mean:Percent_Celastrus_Mean, ~na.approx(.x))) %>% 
  filter(Cut_Year=="Y") %>% 
  replace_na(list(Zone="Central")) %>% 
  select(-Cut_Year)
East_Cut_Values<-Zones %>% 
  filter(Zone=="East") %>% 
  select(Year, Zone, paste(Response_Variables)) %>% 
  merge(East_Cut_Years, all=TRUE) %>% 
  mutate(Cut_Year=case_when(Year %in% East_Cut_Years$Year~"Y")) %>% 
  mutate(across(Percent_Woody_Mean:Percent_Celastrus_Mean, ~na.approx(.x))) %>% 
  filter(Cut_Year=="Y") %>% 
  replace_na(list(Zone="East")) %>% 
  select(-Cut_Year)
West_Cut_Values<-Zones %>% 
  filter(Zone=="West") %>% 
  select(Year, Zone, paste(Response_Variables)) %>% 
  merge(West_Cut_Years, all=TRUE) %>% 
  mutate(Cut_Year=case_when(Year %in% West_Cut_Years$Year~"Y")) %>% 
  mutate(across(Percent_Woody_Mean:Percent_Celastrus_Mean, ~na.approx(.x))) %>% 
  filter(Cut_Year=="Y") %>% 
  replace_na(list(Zone="West")) %>% 
  select(-Cut_Year)

#Combine All Cut Year Data
Cut_Years<-Central_Cut_Values %>% 
  rbind(East_Cut_Values, West_Cut_Values)
  
#Clear Unneeded Items
rm(list=c("Central_Burn_Values", "East_Burn_Values", "West_Burn_Values", "Central_Mow_Values", "East_Mow_Values", "West_Mow_Values", "Central_Cut_Values", "East_Cut_Values", "West_Cut_Values"))
```
```{r Response Variable Charts, warning=FALSE}
#Make Interactive Plot
Response_Plot<-plot_ly() %>%
  add_trace(data=Zones, x=~Year, color=~Zone, colors=Zone_Colors$Color, symbol=~Zone, symbols=Zone_Colors$Symbol, marker=list(size=12), y=~Percent_Woody_Mean, type="scatter", mode="lines+markers", error_y=~list(array=Percent_Woody_SD, opacity=0.3)) %>%
  add_trace(x=Burn_Years$Year, y=Burn_Years$Percent_Woody_Mean, color=Burn_Years$Zone, colors=Zone_Colors$Color, type="scatter", mode="markers", marker=list(symbol="circle-open", size=16, line=list(width=1)), opacity=0.7, name="Burn", hoverinfo=Burn_Years$Year) %>%
  add_trace(x=Mow_Years$Year, y=Mow_Years$Percent_Woody_Mean, color=Mow_Years$Zone, colors=Zone_Colors$Color, type="scatter", mode="markers", marker=list(symbol="square-open", size=16, line=list(width=1)), opacity=0.7, name="Mow", hoverinfo=Mow_Years$Year) %>%
  add_trace(x=Cut_Years$Year, y=Cut_Years$Percent_Woody_Mean, color=Cut_Years$Zone, colors=Zone_Colors$Color, type="scatter", mode="markers", marker=list(symbol="diamond-open", size=16, line=list(width=1)), opacity=0.7, name="Cut", hoverinfo=Cut_Years$Year) %>%
  add_trace(data=Zones, x=~Year, color=~Zone, colors=Zone_Colors$Color, symbol=~Zone, symbols=Zone_Colors$Symbol, marker=list(size=12), y=~Percent_Forb_Mean, type="scatter", mode="lines+markers", error_y=~list(array=Percent_Forb_SD, opacity=0.3), visible=FALSE) %>%
  add_trace(x=Burn_Years$Year, y=Burn_Years$Percent_Forb_Mean, color=Burn_Years$Zone, colors=Zone_Colors$Color, type="scatter", mode="markers", marker=list(symbol="circle-open", size=16, line=list(width=1)), opacity=0.7, name="Burn", hoverinfo=Burn_Years$Year, visible=FALSE) %>%
  add_trace(x=Mow_Years$Year, y=Mow_Years$Percent_Forb_Mean, color=Mow_Years$Zone, colors=Zone_Colors$Color, type="scatter", mode="markers", marker=list(symbol="square-open", size=16, line=list(width=1)), opacity=0.7, name="Mow", hoverinfo=Mow_Years$Year, visible=FALSE) %>%
  add_trace(x=Cut_Years$Year, y=Cut_Years$Percent_Forb_Mean, color=Cut_Years$Zone, colors=Zone_Colors$Color, type="scatter", mode="markers", marker=list(symbol="diamond-open", size=16, line=list(width=1)), opacity=0.7, name="Cut", hoverinfo=Cut_Years$Year, visible=FALSE) %>%
  add_trace(data=Zones, x=~Year, color=~Zone, colors=Zone_Colors$Color, symbol=~Zone, symbols=Zone_Colors$Symbol, marker=list(size=12), y=~Percent_Graminoid_Mean, type="scatter", mode="lines+markers", error_y=~list(array=Percent_Graminoid_SD, opacity=0.3), visible=FALSE) %>%
  add_trace(x=Burn_Years$Year, y=Burn_Years$Percent_Graminoid_Mean, color=Burn_Years$Zone, colors=Zone_Colors$Color, type="scatter", mode="markers", marker=list(symbol="circle-open", size=16, line=list(width=1)), opacity=0.7, name="Burn", hoverinfo=Burn_Years$Year, visible=FALSE) %>%
  add_trace(x=Mow_Years$Year, y=Mow_Years$Percent_Graminoid_Mean, color=Mow_Years$Zone, colors=Zone_Colors$Color, type="scatter", mode="markers", marker=list(symbol="square-open", size=16, line=list(width=1)), opacity=0.7, name="Mow", hoverinfo=Mow_Years$Year, visible=FALSE) %>%
  add_trace(x=Cut_Years$Year, y=Cut_Years$Percent_Graminoid_Mean, color=Cut_Years$Zone, colors=Zone_Colors$Color, type="scatter", mode="markers", marker=list(symbol="diamond-open", size=16, line=list(width=1)), opacity=0.7, name="Cut", hoverinfo=Cut_Years$Year, visible=FALSE) %>%
  add_trace(data=Zones, x=~Year, color=~Zone, colors=Zone_Colors$Color, symbol=~Zone, symbols=Zone_Colors$Symbol, marker=list(size=12), y=~Percent_Rare_Mean, type="scatter", mode="lines+markers", error_y=~list(array=Percent_Rare_SD, opacity=0.3), visible=FALSE) %>%
  add_trace(x=Burn_Years$Year, y=Burn_Years$Percent_Rare_Mean, color=Burn_Years$Zone, colors=Zone_Colors$Color, type="scatter", mode="markers", marker=list(symbol="circle-open", size=16, line=list(width=1)), opacity=0.7, name="Burn", hoverinfo=Burn_Years$Year, visible=FALSE) %>%
  add_trace(x=Mow_Years$Year, y=Mow_Years$Percent_Rare_Mean, color=Mow_Years$Zone, colors=Zone_Colors$Color, type="scatter", mode="markers", marker=list(symbol="square-open", size=16, line=list(width=1)), opacity=0.7, name="Mow", hoverinfo=Mow_Years$Year, visible=FALSE) %>%
  add_trace(x=Cut_Years$Year, y=Cut_Years$Percent_Rare_Mean, color=Cut_Years$Zone, colors=Zone_Colors$Color, type="scatter", mode="markers", marker=list(symbol="diamond-open", size=16, line=list(width=1)), opacity=0.7, name="Cut", hoverinfo=Cut_Years$Year, visible=FALSE) %>%
 add_trace(data=Zones, x=~Year, color=~Zone, colors=Zone_Colors$Color, symbol=~Zone, symbols=Zone_Colors$Symbol, marker=list(size=12), y=~Percent_Exotic_Mean, type="scatter", mode="lines+markers", error_y=~list(array=Percent_Exotic_SD, opacity=0.3), visible=FALSE) %>%
  add_trace(x=Burn_Years$Year, y=Burn_Years$Percent_Exotic_Mean, color=Burn_Years$Zone, colors=Zone_Colors$Color, type="scatter", mode="markers", marker=list(symbol="circle-open", size=16, line=list(width=1)), opacity=0.7, name="Burn", hoverinfo=Burn_Years$Year, visible=FALSE) %>%
  add_trace(x=Mow_Years$Year, y=Mow_Years$Percent_Exotic_Mean, color=Mow_Years$Zone, colors=Zone_Colors$Color, type="scatter", mode="markers", marker=list(symbol="square-open", size=16, line=list(width=1)), opacity=0.7, name="Mow", hoverinfo=Mow_Years$Year, visible=FALSE) %>%
  add_trace(x=Cut_Years$Year, y=Cut_Years$Percent_Exotic_Mean, color=Cut_Years$Zone, colors=Zone_Colors$Color, type="scatter", mode="markers", marker=list(symbol="diamond-open", size=16, line=list(width=1)), opacity=0.7, name="Cut", hoverinfo=Cut_Years$Year, visible=FALSE) %>%
  add_trace(data=Zones, x=~Year, color=~Zone, colors=Zone_Colors$Color, symbol=~Zone, symbols=Zone_Colors$Symbol, marker=list(size=12), y=~Percent_Robinia_Mean, type="scatter", mode="lines+markers", error_y=~list(array=Percent_Robinia_SD, opacity=0.3), visible=FALSE) %>%
  add_trace(x=Burn_Years$Year, y=Burn_Years$Percent_Robinia_Mean, color=Burn_Years$Zone, colors=Zone_Colors$Color, type="scatter", mode="markers", marker=list(symbol="circle-open", size=16, line=list(width=1)), opacity=0.7, name="Burn", hoverinfo=Burn_Years$Year, visible=FALSE) %>%
  add_trace(x=Mow_Years$Year, y=Mow_Years$Percent_Robinia_Mean, color=Mow_Years$Zone, colors=Zone_Colors$Color, type="scatter", mode="markers", marker=list(symbol="square-open", size=16, line=list(width=1)), opacity=0.7, name="Mow", hoverinfo=Mow_Years$Year, visible=FALSE) %>%
  add_trace(x=Cut_Years$Year, y=Cut_Years$Percent_Robinia_Mean, color=Cut_Years$Zone, colors=Zone_Colors$Color, type="scatter", mode="markers", marker=list(symbol="diamond-open", size=16, line=list(width=1)), opacity=0.7, name="Cut", hoverinfo=Cut_Years$Year, visible=FALSE) %>%
  add_trace(data=Zones, x=~Year, color=~Zone, colors=Zone_Colors$Color, symbol=~Zone, symbols=Zone_Colors$Symbol, marker=list(size=12), y=~Percent_Rubus_Mean, type="scatter", mode="lines+markers", error_y=~list(array=Percent_Rubus_SD, opacity=0.3), visible=FALSE) %>%
  add_trace(x=Burn_Years$Year, y=Burn_Years$Percent_Rubus_Mean, color=Burn_Years$Zone, colors=Zone_Colors$Color, type="scatter", mode="markers", marker=list(symbol="circle-open", size=16, line=list(width=1)), opacity=0.7, name="Burn", hoverinfo=Burn_Years$Year, visible=FALSE) %>%
  add_trace(x=Mow_Years$Year, y=Mow_Years$Percent_Rubus_Mean, color=Mow_Years$Zone, colors=Zone_Colors$Color, type="scatter", mode="markers", marker=list(symbol="square-open", size=16, line=list(width=1)), opacity=0.7, name="Mow", hoverinfo=Mow_Years$Year, visible=FALSE) %>%
  add_trace(x=Cut_Years$Year, y=Cut_Years$Percent_Rubus_Mean, color=Cut_Years$Zone, colors=Zone_Colors$Color, type="scatter", mode="markers", marker=list(symbol="diamond-open", size=16, line=list(width=1)), opacity=0.7, name="Cut", hoverinfo=Cut_Years$Year, visible=FALSE) %>%
  add_trace(data=Zones, x=~Year, color=~Zone, colors=Zone_Colors$Color, symbol=~Zone, symbols=Zone_Colors$Symbol, marker=list(size=12), y=~Percent_Oatgrass_Mean, type="scatter", mode="lines+markers", error_y=~list(array=Percent_Oatgrass_SD, opacity=0.3), visible=FALSE) %>%
  add_trace(x=Burn_Years$Year, y=Burn_Years$Percent_Oatgrass_Mean, color=Burn_Years$Zone, colors=Zone_Colors$Color, type="scatter", mode="markers", marker=list(symbol="circle-open", size=16, line=list(width=1)), opacity=0.7, name="Burn", hoverinfo=Burn_Years$Year, visible=FALSE) %>%
  add_trace(x=Mow_Years$Year, y=Mow_Years$Percent_Oatgrass_Mean, color=Mow_Years$Zone, colors=Zone_Colors$Color, type="scatter", mode="markers", marker=list(symbol="square-open", size=16, line=list(width=1)), opacity=0.7, name="Mow", hoverinfo=Mow_Years$Year, visible=FALSE) %>%
  add_trace(x=Cut_Years$Year, y=Cut_Years$Percent_Oatgrass_Mean, color=Cut_Years$Zone, colors=Zone_Colors$Color, type="scatter", mode="markers", marker=list(symbol="diamond-open", size=16, line=list(width=1)), opacity=0.7, name="Cut", hoverinfo=Cut_Years$Year, visible=FALSE) %>%
  add_trace(data=Zones, x=~Year, color=~Zone, colors=Zone_Colors$Color, symbol=~Zone, symbols=Zone_Colors$Symbol, marker=list(size=12), y=~Percent_Celastrus_Mean, type="scatter", mode="lines+markers", error_y=~list(array=Percent_Celastrus_SD, opacity=0.3), visible=FALSE) %>%
  add_trace(x=Burn_Years$Year, y=Burn_Years$Percent_Celastrus_Mean, color=Burn_Years$Zone, colors=Zone_Colors$Color, type="scatter", mode="markers", marker=list(symbol="circle-open", size=16, line=list(width=1)), opacity=0.7, name="Burn", hoverinfo=Burn_Years$Year, visible=FALSE) %>%
  add_trace(x=Mow_Years$Year, y=Mow_Years$Percent_Celastrus_Mean, color=Mow_Years$Zone, colors=Zone_Colors$Color, type="scatter", mode="markers", marker=list(symbol="square-open", size=16, line=list(width=1)), opacity=0.7, name="Mow", hoverinfo=Mow_Years$Year, visible=FALSE) %>%
  add_trace(x=Cut_Years$Year, y=Cut_Years$Percent_Celastrus_Mean, color=Cut_Years$Zone, colors=Zone_Colors$Color, type="scatter", mode="markers", marker=list(symbol="diamond-open", size=16, line=list(width=1)), opacity=0.7, name="Cut", hoverinfo=Cut_Years$Year, visible=FALSE) %>%
  layout(xaxis=list(title="Year"), yaxis=list(title="Average Percent Plants Encountered", range=c(0,70)), legend=list(title=list(text="Zone")), updatemenus=list(list(type="buttons", direction="right", xanchor="center", yanchor="top", pad=list('r'=0, 't'=10, 'b'=10), x=0.5, y=1.17, buttons=list(
    list(method="update", args=list(list(visible=c(rep(TRUE, 12), rep(FALSE, 12), rep(FALSE, 12), rep(FALSE, 12), rep(FALSE, 12), rep(FALSE, 12), rep(FALSE, 12), rep(FALSE, 12), rep(FALSE, 12)))), label="Woody"),
    list(method="update", args=list(list(visible=c(rep(FALSE, 12), rep(TRUE, 12), rep(FALSE, 12), rep(FALSE, 12), rep(FALSE, 12), rep(FALSE, 12), rep(FALSE, 12), rep(FALSE, 12), rep(FALSE, 12)))), label="Forb"),
        list(method="update", args=list(list(visible=c(rep(FALSE, 12), rep(FALSE, 12), rep(TRUE, 12), rep(FALSE, 12), rep(FALSE, 12), rep(FALSE, 12), rep(FALSE, 12), rep(FALSE, 12), rep(FALSE, 12)))), label="Graminoid"),
    list(method="update", args=list(list(visible=c(rep(FALSE, 12), rep(FALSE, 12), rep(FALSE, 12), rep(TRUE, 12), rep(FALSE, 12), rep(FALSE, 12), rep(FALSE, 12), rep(FALSE, 12), rep(FALSE, 12)))), label="Rare"),
    list(method="update", args=list(list(visible=c(rep(FALSE, 12), rep(FALSE, 12), rep(FALSE, 12), rep(FALSE, 12), rep(TRUE, 12), rep(FALSE, 12), rep(FALSE, 12), rep(FALSE, 12), rep(FALSE, 12)))), label="Exotic"),
    list(method="update", args=list(list(visible=c(rep(FALSE, 12), rep(FALSE, 12), rep(FALSE, 12), rep(FALSE, 12), rep(FALSE, 12), rep(TRUE, 12), rep(FALSE, 12), rep(FALSE, 12), rep(FALSE, 12)))), label="Robinia"),
        list(method="update", args=list(list(visible=c(rep(FALSE, 12), rep(FALSE, 12), rep(FALSE, 12), rep(FALSE, 12), rep(FALSE, 12), rep(FALSE, 12), rep(TRUE, 12), rep(FALSE, 12)))), label="Rubus"),
    list(method="update", args=list(list(visible=c(rep(FALSE, 12), rep(FALSE, 12), rep(FALSE, 12), rep(FALSE, 12), rep(FALSE, 12), rep(FALSE, 12), rep(FALSE, 12), rep(TRUE, 12), rep(FALSE, 12)))), label="Oatgrass"),
        list(method="update", args=list(list(visible=c(rep(FALSE, 12), rep(FALSE, 12), rep(FALSE, 12), rep(FALSE, 12), rep(FALSE, 12), rep(FALSE, 12), rep(FALSE, 12), rep(FALSE, 12), rep(TRUE, 12)))), label="Celastrus"))))) %>% 
    config(toImageButtonOptions=list(format="png", filename="Big_Meadows_Response_Variables", width=NULL, height=NULL, scale=6))

#Print Plot
Response_Plot

#Save Plot as Widget
htmlwidgets::saveWidget(as_widget(Response_Plot), "Output/Respone_Variable_Plot.html")
```
```{r Print Legends, warning=FALSE}
#Make Simple Plots for Legend Extraction
Zone_Plot<-ggplot(Zones, aes(y=Percent_Woody_Mean, x=Year, Zone=Zone, color=Zone, fill=Zone, shape=Zone)) +
  geom_point(size=5) +
  scale_color_manual(values=Zone_Colors$Color) +
  scale_shape_manual(values=c(Zone_Colors$Symbol)) +
  scale_fill_manual(values=Zone_Colors$Color)
Treatment_Plot<-ggplot() +
  geom_point(data=Burn_Years, aes(y=Percent_Woody_Mean, x=Year, alpha="Burn"), shape=1, size=5, stroke=0.5) +
  geom_point(data=Mow_Years, aes(y=Percent_Woody_Mean, x=Year, alpha="Mow"), shape=0, size=5, stroke=0.5) +
  geom_point(data=Cut_Years, aes(y=Percent_Woody_Mean, x=Year, alpha="Cut"), shape=5, size=5, stroke=0.5) +
  scale_alpha_manual(name="Treatment", values=c(1, 1, 1), breaks=c("Burn", "Mow", "Cut"), guide=guide_legend(override.aes=list(shape=c(1, 0, 5))))

#Print Legends
tiff("Output/Vertical_Legend.tif", height=2.25, width=1, units='in', res=300)
grid.arrange(get_legend(Zone_Plot), get_legend(Treatment_Plot), nrow=2)
invisible(dev.off())
tiff("Output/Horizontal_Legend.tif", height=1, width=2, units='in', res=300)
grid.arrange(get_legend(Zone_Plot), get_legend(Treatment_Plot), nrow=1)
invisible(dev.off())
```
```{r Print Static Response Plots, warning=FALSE}
#Percent Woody Plants Static Chart
Woody_Plot<-ggplot(Zones, aes(y=Percent_Woody_Mean, x=Year, Zone=Zone, color=Zone, fill=Zone, shape=Zone)) +
  geom_point(size=3) +
  geom_point(data=Burn_Years, aes(y=Percent_Woody_Mean, x=Year, alpha="Burn"), shape=1, size=5, stroke=0.5) +
  geom_point(data=Mow_Years, aes(y=Percent_Woody_Mean, x=Year, alpha="Mow"), shape=0, size=5, stroke=0.5) +
  geom_point(data=Cut_Years, aes(y=Percent_Woody_Mean, x=Year, alpha="Cut"), shape=5, size=5, stroke=0.5) +
  geom_errorbar(aes(ymin=Percent_Woody_Mean-Percent_Woody_SD, ymax=Percent_Woody_Mean+Percent_Woody_SD), width=.3, alpha=0.3) +
  geom_line() +
  xlab("Year") +
  geom_hline(yintercept=0, linetype=2, linewidth=0.2) +
  ylab("Percent Woody Plants") +
  scale_color_manual(values=Zone_Colors$Color) +
  scale_shape_manual(values=c(Zone_Colors$Symbol)) +
  scale_fill_manual(values=Zone_Colors$Color) +
  scale_alpha_manual(name="Treatment", values=c(1, 1, 1), breaks=c("Burn", "Mow", "Cut"), guide=guide_legend(override.aes=list(shape=c(1, 0, 5)))) +
  theme(axis.text.x=element_text(angle=45, vjust=1, hjust=1))
tiff("Output/Woody_Response.tif", width=8, height=5, units="in", res=300)
Woody_Plot
invisible(dev.off())

#Percent Forbs Static Chart
Forb_Plot<-ggplot(Zones, aes(y=Percent_Forb_Mean, x=Year, Zone=Zone, color=Zone, fill=Zone, shape=Zone)) +
  geom_point(size=3) +
  geom_point(data=Burn_Years, aes(y=Percent_Forb_Mean, x=Year, alpha="Burn"), shape=1, size=5, stroke=0.5) +
  geom_point(data=Mow_Years, aes(y=Percent_Forb_Mean, x=Year, alpha="Mow"), shape=0, size=5, stroke=0.5) +
  geom_point(data=Cut_Years, aes(y=Percent_Forb_Mean, x=Year, alpha="Cut"), shape=5, size=5, stroke=0.5) +
  geom_errorbar(aes(ymin=Percent_Forb_Mean-Percent_Forb_SD, ymax=Percent_Forb_Mean+Percent_Forb_SD), width=.3, alpha=0.3) +
  geom_line() +
  xlab("Year") +
  geom_hline(yintercept=0, linetype=2, linewidth=0.2) +
  ylab("Percent Forbs") +
  scale_color_manual(values=Zone_Colors$Color) +
  scale_shape_manual(values=c(Zone_Colors$Symbol)) +
  scale_fill_manual(values=Zone_Colors$Color) +
  scale_alpha_manual(name="Treatment", values=c(1, 1, 1), breaks=c("Burn", "Mow", "Cut"), guide=guide_legend(override.aes=list(shape=c(1, 0, 5)))) +
  theme(axis.text.x=element_text(angle=45, vjust=1, hjust=1))
tiff("Output/Forb_Response.tif", width=8, height=5, units="in", res=300)
Forb_Plot
invisible(dev.off())

#Percent Graminoids Static Chart
Graminoid_Plot<-ggplot(Zones, aes(y=Percent_Graminoid_Mean, x=Year, Zone=Zone, color=Zone, fill=Zone, shape=Zone)) +
  geom_point(size=3) +
  geom_point(data=Burn_Years, aes(y=Percent_Graminoid_Mean, x=Year, alpha="Burn"), shape=1, size=5, stroke=0.5) +
  geom_point(data=Mow_Years, aes(y=Percent_Graminoid_Mean, x=Year, alpha="Mow"), shape=0, size=5, stroke=0.5) +
  geom_point(data=Cut_Years, aes(y=Percent_Graminoid_Mean, x=Year, alpha="Cut"), shape=5, size=5, stroke=0.5) +
  geom_errorbar(aes(ymin=Percent_Graminoid_Mean-Percent_Graminoid_SD, ymax=Percent_Graminoid_Mean+Percent_Graminoid_SD), width=.3, alpha=0.3) +
  geom_line() +
  xlab("Year") +
  geom_hline(yintercept=0, linetype=2, linewidth=0.2) +
  ylab("Percent Graminoids") +
  scale_color_manual(values=Zone_Colors$Color) +
  scale_shape_manual(values=c(Zone_Colors$Symbol)) +
  scale_fill_manual(values=Zone_Colors$Color) +
  scale_alpha_manual(name="Treatment", values=c(1, 1, 1), breaks=c("Burn", "Mow", "Cut"), guide=guide_legend(override.aes=list(shape=c(1, 0, 5)))) +
  theme(axis.text.x=element_text(angle=45, vjust=1, hjust=1))
tiff("Output/Graminoid_Response.tif", width=8, height=5, units="in", res=300)
Graminoid_Plot
invisible(dev.off())

#Percent Rare Plants Static Chart
Rare_Plot<-ggplot(Zones, aes(y=Percent_Rare_Mean, x=Year, Zone=Zone, color=Zone, fill=Zone, shape=Zone)) +
  geom_point(size=3) +
  geom_point(data=Burn_Years, aes(y=Percent_Rare_Mean, x=Year, alpha="Burn"), shape=1, size=5, stroke=0.5) +
  geom_point(data=Mow_Years, aes(y=Percent_Rare_Mean, x=Year, alpha="Mow"), shape=0, size=5, stroke=0.5) +
  geom_point(data=Cut_Years, aes(y=Percent_Rare_Mean, x=Year, alpha="Cut"), shape=5, size=5, stroke=0.5) +
  geom_errorbar(aes(ymin=Percent_Rare_Mean-Percent_Rare_SD, ymax=Percent_Rare_Mean+Percent_Rare_SD), width=.3, alpha=0.3) +
  geom_line() +
  xlab("Year") +
  geom_hline(yintercept=0, linetype=2, linewidth=0.2) +
  ylab("Percent Rare Plants") +
  scale_color_manual(values=Zone_Colors$Color) +
  scale_shape_manual(values=c(Zone_Colors$Symbol)) +
  scale_fill_manual(values=Zone_Colors$Color) +
  scale_alpha_manual(name="Treatment", values=c(1, 1, 1), breaks=c("Burn", "Mow", "Cut"), guide=guide_legend(override.aes=list(shape=c(1, 0, 5)))) +
  theme(axis.text.x=element_text(angle=45, vjust=1, hjust=1))
tiff("Output/Rare_Response.tif", width=8, height=5, units="in", res=300)
Rare_Plot
invisible(dev.off())

#Percent Exotic Plants Static Chart
Exotic_Plot<-ggplot(Zones, aes(y=Percent_Exotic_Mean, x=Year, Zone=Zone, color=Zone, fill=Zone, shape=Zone)) +
  geom_point(size=3) +
  geom_point(data=Burn_Years, aes(y=Percent_Exotic_Mean, x=Year, alpha="Burn"), shape=1, size=5, stroke=0.5) +
  geom_point(data=Mow_Years, aes(y=Percent_Exotic_Mean, x=Year, alpha="Mow"), shape=0, size=5, stroke=0.5) +
  geom_point(data=Cut_Years, aes(y=Percent_Exotic_Mean, x=Year, alpha="Cut"), shape=5, size=5, stroke=0.5) +
  geom_errorbar(aes(ymin=Percent_Exotic_Mean-Percent_Exotic_SD, ymax=Percent_Exotic_Mean+Percent_Exotic_SD), width=.3, alpha=0.3) +
  geom_line() +
  xlab("Year") +
  geom_hline(yintercept=0, linetype=2, linewidth=0.2) +
  ylab("Percent Exotic Plants") +
  scale_color_manual(values=Zone_Colors$Color) +
  scale_shape_manual(values=c(Zone_Colors$Symbol)) +
  scale_fill_manual(values=Zone_Colors$Color) +
  scale_alpha_manual(name="Treatment", values=c(1, 1, 1), breaks=c("Burn", "Mow", "Cut"), guide=guide_legend(override.aes=list(shape=c(1, 0, 5)))) +
  theme(axis.text.x=element_text(angle=45, vjust=1, hjust=1))
tiff("Output/Exotic_Response.tif", width=8, height=5, units="in", res=300)
Exotic_Plot
invisible(dev.off())

#Percent Robinia Static Chart
Robinia_Plot<-ggplot(Zones, aes(y=Percent_Robinia_Mean, x=Year, Zone=Zone, color=Zone, fill=Zone, shape=Zone)) +
  geom_point(size=3) +
  geom_point(data=Burn_Years, aes(y=Percent_Robinia_Mean, x=Year, alpha="Burn"), shape=1, size=5, stroke=0.5) +
  geom_point(data=Mow_Years, aes(y=Percent_Robinia_Mean, x=Year, alpha="Mow"), shape=0, size=5, stroke=0.5) +
  geom_point(data=Cut_Years, aes(y=Percent_Robinia_Mean, x=Year, alpha="Cut"), shape=5, size=5, stroke=0.5) +
  geom_errorbar(aes(ymin=Percent_Robinia_Mean-Percent_Robinia_SD, ymax=Percent_Robinia_Mean+Percent_Robinia_SD), width=.3, alpha=0.3) +
  geom_line() +
  xlab("Year") +
  geom_hline(yintercept=0, linetype=2, linewidth=0.2) +
  ylab("Percent Robinia") +
  scale_color_manual(values=Zone_Colors$Color) +
  scale_shape_manual(values=c(Zone_Colors$Symbol)) +
  scale_fill_manual(values=Zone_Colors$Color) +
  scale_alpha_manual(name="Treatment", values=c(1, 1, 1), breaks=c("Burn", "Mow", "Cut"), guide=guide_legend(override.aes=list(shape=c(1, 0, 5)))) +
  theme(axis.text.x=element_text(angle=45, vjust=1, hjust=1))
tiff("Output/Robinia_Response.tif", width=8, height=5, units="in", res=300)
Robinia_Plot
invisible(dev.off())

#Percent Rubus Static Chart
Rubus_Plot<-ggplot(Zones, aes(y=Percent_Rubus_Mean, x=Year, Zone=Zone, color=Zone, fill=Zone, shape=Zone)) +
  geom_point(size=3) +
  geom_point(data=Burn_Years, aes(y=Percent_Rubus_Mean, x=Year, alpha="Burn"), shape=1, size=5, stroke=0.5) +
  geom_point(data=Mow_Years, aes(y=Percent_Rubus_Mean, x=Year, alpha="Mow"), shape=0, size=5, stroke=0.5) +
  geom_point(data=Cut_Years, aes(y=Percent_Rubus_Mean, x=Year, alpha="Cut"), shape=5, size=5, stroke=0.5) +
  geom_errorbar(aes(ymin=Percent_Rubus_Mean-Percent_Rubus_SD, ymax=Percent_Rubus_Mean+Percent_Rubus_SD), width=.3, alpha=0.3) +
  geom_line() +
  xlab("Year") +
  geom_hline(yintercept=0, linetype=2, linewidth=0.2) +
  ylab("Percent Rubus") +
  scale_color_manual(values=Zone_Colors$Color) +
  scale_shape_manual(values=c(Zone_Colors$Symbol)) +
  scale_fill_manual(values=Zone_Colors$Color) +
  scale_alpha_manual(name="Treatment", values=c(1, 1, 1), breaks=c("Burn", "Mow", "Cut"), guide=guide_legend(override.aes=list(shape=c(1, 0, 5)))) +
  theme(axis.text.x=element_text(angle=45, vjust=1, hjust=1))
tiff("Output/Rubus_Response.tif", width=8, height=5, units="in", res=300)
Rubus_Plot
invisible(dev.off())

#Percent Oatgrass Static Chart
Oatgrass_Plot<-ggplot(Zones, aes(y=Percent_Oatgrass_Mean, x=Year, Zone=Zone, color=Zone, fill=Zone, shape=Zone)) +
  geom_point(size=3) +
  geom_point(data=Burn_Years, aes(y=Percent_Oatgrass_Mean, x=Year, alpha="Burn"), shape=1, size=5, stroke=0.5) +
  geom_point(data=Mow_Years, aes(y=Percent_Oatgrass_Mean, x=Year, alpha="Mow"), shape=0, size=5, stroke=0.5) +
  geom_point(data=Cut_Years, aes(y=Percent_Oatgrass_Mean, x=Year, alpha="Cut"), shape=5, size=5, stroke=0.5) +
  geom_errorbar(aes(ymin=Percent_Oatgrass_Mean-Percent_Oatgrass_SD, ymax=Percent_Oatgrass_Mean+Percent_Oatgrass_SD), width=.3, alpha=0.3) +
  geom_line() +
  xlab("Year") +
  geom_hline(yintercept=0, linetype=2, linewidth=0.2) +
  ylab("Percent Oatgrass") +
  scale_color_manual(values=Zone_Colors$Color) +
  scale_shape_manual(values=c(Zone_Colors$Symbol)) +
  scale_fill_manual(values=Zone_Colors$Color) +
  scale_alpha_manual(name="Treatment", values=c(1, 1, 1), breaks=c("Burn", "Mow", "Cut"), guide=guide_legend(override.aes=list(shape=c(1, 0, 5)))) +
  theme(axis.text.x=element_text(angle=45, vjust=1, hjust=1))
tiff("Output/Oatgrass_Response.tif", width=8, height=5, units="in", res=300)
Oatgrass_Plot
invisible(dev.off())

#Percent Celastrus Static Chart
Celastrus_Plot<-ggplot(Zones, aes(y=Percent_Celastrus_Mean, x=Year, Zone=Zone, color=Zone, fill=Zone, shape=Zone)) +
  geom_point(size=3) +
  geom_point(data=Burn_Years, aes(y=Percent_Celastrus_Mean, x=Year, alpha="Burn"), shape=1, size=5, stroke=0.5) +
  geom_point(data=Mow_Years, aes(y=Percent_Celastrus_Mean, x=Year, alpha="Mow"), shape=0, size=5, stroke=0.5) +
  geom_point(data=Cut_Years, aes(y=Percent_Celastrus_Mean, x=Year, alpha="Cut"), shape=5, size=5, stroke=0.5) +
  geom_errorbar(aes(ymin=Percent_Celastrus_Mean-Percent_Celastrus_SD, ymax=Percent_Celastrus_Mean+Percent_Celastrus_SD), width=.3, alpha=0.3) +
  geom_line() +
  xlab("Year") +
  geom_hline(yintercept=0, linetype=2, linewidth=0.2) +
  ylab("Percent Celastrus") +
  scale_color_manual(values=Zone_Colors$Color) +
  scale_shape_manual(values=c(Zone_Colors$Symbol)) +
  scale_fill_manual(values=Zone_Colors$Color) +
  scale_alpha_manual(name="Treatment", values=c(1, 1, 1), breaks=c("Burn", "Mow", "Cut"), guide=guide_legend(override.aes=list(shape=c(1, 0, 5)))) +
  theme(axis.text.x=element_text(angle=45, vjust=1, hjust=1))
tiff("Output/Celastrus_Response.tif", width=8, height=5, units="in", res=300)
Celastrus_Plot
invisible(dev.off())

#Multi-Panel Static Response Chart
tiff("Output/Response_Panel.tif", width=8, height=8, units="in", res=300)
grid.arrange(Woody_Plot+theme(legend.position="none")+labs(tag="A"), 
             Forb_Plot+theme(legend.position="none")+labs(tag="B"), 
             Graminoid_Plot+theme(legend.position="none")+labs(tag="C"), 
             Rare_Plot+theme(legend.position="none")+labs(tag="D"),
             Exotic_Plot+theme(legend.position="none")+labs(tag="E"),
             Robinia_Plot+theme(legend.position="none")+labs(tag="F"),
             Rubus_Plot+theme(legend.position="none")+labs(tag="G"),
             Celastrus_Plot+theme(legend.position="none")+labs(tag="H"),
             get_legend(Zone_Plot),
             get_legend(Treatment_Plot),
             layout_matrix=rbind(c(1,1,2,2,3,3),c(4,4,5,5,6,6), c(7,7,8,8,9,10)))
invisible(dev.off())
```

# Ordination

To visualize the changes in the vegetation community over time in multidimensional space, NMDS ordinations were created using the R package [vegan](https://cran.r-project.org/web/packages/vegan/vegan.pdf) function `metaMDS`. All NMDS used a Bray-Curtis distance metric and a maximum of 100 random starts. Ordinations were conducted with the "Wetland" zone excluded as management for the Wetland points were split between the East and Central groups. Surveys from the year 2004 were excluded prior to ordination as plants were only identified to genus in this year.

## Ordination by Zone

```{r Zone Ordination, include=FALSE}
#Prepare Data for Ordination
Zones_Matrix<-Zones %>%
  unite("Label", Year:Zone, remove=FALSE) %>%
  tibble::column_to_rownames("Label")
X<-match(First_Spp, names(Zones_Matrix))

#Run NDMS with 1 though 3 Dimensions
NMDS_1<-metaMDS(Zones_Matrix[,X:ncol(Zones_Matrix)], distance="bray", k=1, trymax=100, autotransform=FALSE, pc=FALSE, plot=FALSE)
NMDS_2<-metaMDS(Zones_Matrix[,X:ncol(Zones_Matrix)], distance="bray", k=2, trymax=100, autotransform=FALSE, pc=FALSE, plot=FALSE)
NMDS_3<-metaMDS(Zones_Matrix[,X:ncol(Zones_Matrix)], distance="bray", k=3, trymax=100, autotransform=FALSE, pc=FALSE, plot=FALSE)
NMDS_4<-metaMDS(Zones_Matrix[,X:ncol(Zones_Matrix)], distance="bray", k=4, trymax=100, autotransform=FALSE, pc=FALSE, plot=FALSE)
NMDS_5<-metaMDS(Zones_Matrix[,X:ncol(Zones_Matrix)], distance="bray", k=5, trymax=100, autotransform=FALSE, pc=FALSE, plot=FALSE)
NMDS_6<-metaMDS(Zones_Matrix[,X:ncol(Zones_Matrix)], distance="bray", k=6, trymax=100, autotransform=FALSE, pc=FALSE, plot=FALSE)

#Clear Unneeded Items
rm(list=c("Zones"))
```

### Ordination Selection

To determine the optimal number of axes, NMDS using 1 through 6 axes were conducted and compared in a scree plot. The NMDS ordination in two dimensions was chosen as the optimal solution to balance stress and ability to be visualized.

```{r Zone Scree and Stress Plots, fig.show="hold", out.width="50%"}
#Build Data Frame of Dimensions and Stress for Plots
Stress<-data.frame(Dimensions=c(1:6),Stress=c(NMDS_1$stress, NMDS_2$stress, NMDS_3$stress, NMDS_4$stress, NMDS_5$stress, NMDS_6$stress))

#Scree Plot
Scree_Plot<-ggplot(Stress, aes(x=Dimensions, y=Stress, label=round(Stress, 2))) +
  geom_line(color="red") +
  geom_point(color="red") +
  geom_text(nudge_y=0.015, color="red") +
  labs(x="Dimensions", y="Stress")
Scree_Plot

#Print Scree Plot
tiff("Output/Zone_Scree_Plot.tif", width=6, height=4, units="in", res=300, bg="transparent")
print(Scree_Plot)
invisible(dev.off())

#Select Number of Dimensions
NMDS<-NMDS_2

#Stress Plot
stressplot(NMDS)

#Print Stress Plot
tiff("Output/Zone_Stress_Plot.tif", width=6, height=4, units="in", res=300, bg="transparent")
stressplot(NMDS)
invisible(dev.off())

#Clear Unneeded Items
rm(list=c("NMDS_1", "NMDS_2", "NMDS_3", "NMDS_4", "NMDS_5", "NMDS_6", "Stress", "Scree_Plot"))
```

### Fitting Predictor Variables

The climate and management predictor variables were projected onto the ordination using the R package [vegan](https://cran.r-project.org/web/packages/vegan/vegan.pdf) function `envfit()` using 100 permutations.

```{r Zone Ordination Plot Variable Prep}
#Add NMDS Scores to Matrix
NMDS_Sites<-as.data.frame(scores(NMDS)$sites)
Plot_Matrix<-Zones_Matrix %>% 
  merge(NMDS_Sites, by="row.names") %>% 
  tibble::column_to_rownames("Row.names") %>% 
  select(Year, Zone, NMDS1, NMDS2, Total_Spring_Precip:ZIZAPT)

#Fit Management and Dependent Variables
NMDS_Fit<-envfit(NMDS, choices=c(1:2), Plot_Matrix[,c("Total_Spring_Precip", "Last_Freeze", "Years_Since_Mow", "Years_Since_Burn")], na.rm=TRUE, permu=100)
#Fit_Scores<-as.data.frame(NMDS_Fit$vectors$arrows) %>%
# mutate(r2=NMDS_Fit$vectors$r, pval=NMDS_Fit$vectors$pvals) %>%
#  arrange(pval)
Fit_Scores<-as.data.frame(scores(NMDS_Fit, "vectors")) %>% 
  mutate(r2=NMDS_Fit$vectors$r, pval=NMDS_Fit$vectors$pvals) %>%
  arrange(pval)

#Fit Scores Kable
Fit_Scores %>% 
  kable(col.names=c("NMDS 1", "NMDS 2", "$R^2$", "P-Value"), digits=2, caption="Table 2: Fit of Predictor Variables to NMDS Ordination") %>%
  column_spec(5, bold=ifelse(Fit_Scores$pval<=0.05, TRUE, FALSE)) %>%
  kable_styling("striped", full_width=F)

#Select Fit Scores for Plotting
Fit_Scores_Sig<-filter(Fit_Scores, pval<=0.05)
Fit_Scores_Insig<-filter(Fit_Scores, pval>0.05)

#Clear Unneeded Items
rm(list=c("Zones_Matrix", "NMDS_Sites", "Fit_Scores"))
```

### Ordination Plot

Ordination plot was created using the R package [plotly](https://cran.r-project.org/web/packages/plotly/plotly.pdf). Predictor variables with P-values<=0.05 are illustrated in the ordination plot in black, while predictor variables with P-values>0.05 are grey.

```{r Ordination Treatment Years}
#Complete Response Values for Missing Burn Years Using Interpolation
Central_Burn_Values<-Plot_Matrix %>% 
  filter(Zone=="Central") %>% 
  select(Year,  Zone, NMDS1, NMDS2) %>% 
  merge(Central_Burn_Years, all=TRUE) %>% 
  mutate(Burn_Year=case_when(Year %in% Central_Burn_Years$Year~"Y")) %>% 
  mutate(across(NMDS1:NMDS2, ~na.approx(.x))) %>% 
  filter(Burn_Year=="Y") %>% 
  replace_na(list(Zone="Central")) %>% 
  select(-Burn_Year)
East_Burn_Values<-Plot_Matrix %>% 
  filter(Zone=="East") %>% 
  select(Year, Zone, NMDS1, NMDS2) %>% 
  merge(East_Burn_Years, all=TRUE) %>% 
  mutate(Burn_Year=case_when(Year %in% East_Burn_Years$Year~"Y")) %>% 
  mutate(across(NMDS1:NMDS2, ~na.approx(.x))) %>% 
  filter(Burn_Year=="Y") %>% 
  replace_na(list(Zone="East")) %>% 
  select(-Burn_Year)
West_Burn_Values<-Plot_Matrix %>% 
  filter(Zone=="West") %>% 
  select(Year, Zone, NMDS1, NMDS2) %>% 
  merge(West_Burn_Years, all=TRUE) %>% 
  mutate(Burn_Year=case_when(Year %in% West_Burn_Years$Year~"Y")) %>% 
  mutate(across(NMDS1:NMDS2, ~na.approx(.x))) %>% 
  filter(Burn_Year=="Y") %>% 
  replace_na(list(Zone="West")) %>% 
  select(-Burn_Year)

#Combine All Burn Year Data
Burn_Years<-Central_Burn_Values %>% 
  rbind(East_Burn_Values, West_Burn_Values)

#Complete Response Values for Missing Mow Years Using Interpolation
Central_Mow_Values<-Plot_Matrix %>% 
  filter(Zone=="Central") %>% 
  select(Year,  Zone, NMDS1, NMDS2) %>% 
  merge(Central_Mow_Years, all=TRUE) %>% 
  mutate(Mow_Year=case_when(Year %in% Central_Mow_Years$Year~"Y")) %>% 
  mutate(across(NMDS1:NMDS2, ~na.approx(.x))) %>% 
  filter(Mow_Year=="Y") %>% 
  replace_na(list(Zone="Central")) %>% 
  select(-Mow_Year)
East_Mow_Values<-Plot_Matrix %>% 
  filter(Zone=="East") %>% 
  select(Year, Zone, NMDS1, NMDS2) %>% 
  merge(East_Mow_Years, all=TRUE) %>% 
  mutate(Mow_Year=case_when(Year %in% East_Mow_Years$Year~"Y")) %>% 
  mutate(across(NMDS1:NMDS2, ~na.approx(.x))) %>% 
  filter(Mow_Year=="Y") %>% 
  replace_na(list(Zone="East")) %>% 
  select(-Mow_Year)
West_Mow_Values<-Plot_Matrix %>% 
  filter(Zone=="West") %>% 
  select(Year, Zone, NMDS1, NMDS2) %>% 
  merge(West_Mow_Years, all=TRUE) %>% 
  mutate(Mow_Year=case_when(Year %in% West_Mow_Years$Year~"Y")) %>% 
  mutate(across(NMDS1:NMDS2, ~na.approx(.x))) %>% 
  filter(Mow_Year=="Y") %>% 
  replace_na(list(Zone="West")) %>% 
  select(-Mow_Year)

#Combine All Mow Year Data
Mow_Years<-Central_Mow_Values %>% 
  rbind(East_Mow_Values, West_Mow_Values)

#Complete Response Values for Missing Cut Years Using Interpolation
Central_Cut_Values<-Plot_Matrix %>% 
  filter(Zone=="Central") %>% 
  select(Year,  Zone, NMDS1, NMDS2) %>% 
  merge(Central_Cut_Years, all=TRUE) %>% 
  mutate(Cut_Year=case_when(Year %in% Central_Cut_Years$Year~"Y")) %>% 
  mutate(across(NMDS1:NMDS2, ~na.approx(.x))) %>% 
  filter(Cut_Year=="Y") %>% 
  replace_na(list(Zone="Central")) %>% 
  select(-Cut_Year)
East_Cut_Values<-Plot_Matrix %>% 
  filter(Zone=="East") %>% 
  select(Year, Zone, NMDS1, NMDS2) %>% 
  merge(East_Cut_Years, all=TRUE) %>% 
  mutate(Cut_Year=case_when(Year %in% East_Cut_Years$Year~"Y")) %>% 
  mutate(across(NMDS1:NMDS2, ~na.approx(.x))) %>% 
  filter(Cut_Year=="Y") %>% 
  replace_na(list(Zone="East")) %>% 
  select(-Cut_Year)
West_Cut_Values<-Plot_Matrix %>% 
  filter(Zone=="West") %>% 
  select(Year, Zone, NMDS1, NMDS2) %>% 
  merge(West_Cut_Years, all=TRUE) %>% 
  mutate(Cut_Year=case_when(Year %in% West_Cut_Years$Year~"Y")) %>% 
  mutate(across(NMDS1:NMDS2, ~na.approx(.x))) %>% 
  filter(Cut_Year=="Y") %>% 
  replace_na(list(Zone="West")) %>% 
  select(-Cut_Year)

#Combine All Cut Year Data
Cut_Years<-Central_Cut_Values %>% 
  rbind(East_Cut_Values, West_Cut_Values)

#Clear Unneeded Items
rm(list=c("Central_Burn_Values", "East_Burn_Values", "West_Burn_Values", "Central_Mow_Values", "East_Mow_Values", "West_Mow_Values", "Central_Cut_Values", "East_Cut_Values", "West_Cut_Values"))
```
```{r Get Species for NMDS Plot}
#Save NMDS Species Scores for Species of Concern
NMDS_Species<-as.data.frame(scores(NMDS)$species) %>% 
  filter(!is.na(NMDS1)) %>% 
  tibble::rownames_to_column("Code") %>% 
  merge(Species_List) %>% 
  mutate(Type=case_when(Code=="Rubus"|Code=="CELORB"|Code=="ROBPSE" ~ "Problem", Lifeform=="Tree"|Lifeform=="Shrub"|Lifeform=="Vine" ~ "Woody", Lifeform=="Herb"|Lifeform=="Fern" ~ "Forb", Lifeform=="Graminoid" ~ "Graminoid"))  %>% 
  mutate(Category=case_when(Code=="Rubus"|Code=="CELORB"|Code=="ROBPSE" ~ "Problem", SRank=="S1"|SRank=="S1S2"|SRank=="S2" ~ "Rare", Status=="Ex" ~ "Exotic", .default="Other")) %>% 
  mutate(Taxa=case_when(Code=="Rubus"|Code=="CELORB"|Code=="ROBPSE" ~ "Taxa of Concern", .default="Other Taxa")) %>% 
  select(Code, NMDS1, NMDS2, Type, Category, Taxa)

#Set Factor Levels
NMDS_Species$Type<-factor(NMDS_Species$Type, levels=c("Woody", "Forb", "Graminoid", "Problem"))
NMDS_Species$Category<-factor(NMDS_Species$Category, levels=c("Rare", "Exotic", "Problem", "Other"))
NMDS_Species$Taxa<-factor(NMDS_Species$Taxa, levels=c("Taxa of Concern", "Other Taxa"))

#Create Plot for Legend Extraction
Text_Plot<-ggplot() +
  geom_text(data=NMDS_Species, aes(x=NMDS1, y=NMDS2, label=Code, color=Taxa), size=5, fontface="italic") +
  scale_color_manual(values=c("#FE6100", "#9B9A9E"))
```
```{r Zone Ordination Plot}
#Interactive Biplot
NMDS_Plot<-plot_ly(data=Plot_Matrix, x=~NMDS1, y=~NMDS2) %>% 
  layout(xaxis=list(title="NMDS 1"), yaxis=list(title="NMDS 2"), legend=list(title=list(text="Zone"))) %>% 
  add_trace(type="scatter", mode="lines+markers+text", color=~Zone, colors=Zone_Colors$Color, symbol=~Zone, symbols=Zone_Colors$Symbol, marker=list(size=12), text=~paste(" ", Year), textposition="top") %>% 
  add_trace(x=Burn_Years$NMDS1, y=Burn_Years$NMDS2, type="scatter", mode="markers", color=Burn_Years$Zone, colors=Zone_Colors$Color, marker=list(symbol="circle-open", size=16, line=list(width=1)), opacity=0.5, name="Burn", hoverinfo=Burn_Years$Year) %>%
  add_trace(x=Mow_Years$NMDS1, y=Mow_Years$NMDS2, type="scatter", mode="markers", color=Mow_Years$Zone, colors=Zone_Colors$Color, marker=list(symbol="square-open", size=16, line=list(width=1)), opacity=0.5, name="Mow", hoverinfo=Mow_Years$Year) %>% 
  add_trace(x=Cut_Years$NMDS1, y=Cut_Years$NMDS2, type="scatter", mode="markers", color=Cut_Years$Zone, colors=Zone_Colors$Color, marker=list(symbol="diamond-open", size=16, line=list(width=1)), opacity=0.5, name="Cut", hoverinfo=Cut_Years$Year) %>% 
  add_annotations(x=0, y=0, xref='x', yref='y', ax=Fit_Scores_Sig$NMDS1, ay=Fit_Scores_Sig$NMDS2, axref='x', ayref='y', text=row.names(Fit_Scores_Sig), arrowside="start", arrowcolor="black", font=list(color="black"), hovertext=row.names(Fit_Scores_Sig)) %>% 
  add_annotations(x=0, y=0, xref='x', yref='y', ax=Fit_Scores_Insig$NMDS1, ay=Fit_Scores_Insig$NMDS2, axref='x', ayref='y', text=row.names(Fit_Scores_Insig), arrowside="start", arrowcolor="#9B9A9E", font=list(color="#9B9A9E"), hovertext=row.names(Fit_Scores_Insig)) %>% 
  add_trace(x=NMDS_Species$NMDS1, y=NMDS_Species$NMDS2, type="scatter", mode="text", text=sprintf("<i>%s</i>", NMDS_Species$Code), textfont=list(color="#9B9A9E", size=8), opacity=0.5, name="Taxa") %>%
  config(toImageButtonOptions=list(format="png", filename="Big_Meadows_Zone_NMDS", width=NULL, height=NULL, scale=6))

#Print Plot
NMDS_Plot

#Save Plot as Widget
htmlwidgets::saveWidget(as_widget(NMDS_Plot), "Output/NMDS_Plot.html")

#Clear Unneeded Items
#rm(list=c("Fit_Scores_Sig", "Fit_Scores_Insig", "NMDS", "NMDS_Fit", "Plot_Matrix"))
```
```{r Print Static Ordination Plots, warning=FALSE}
#Static Site Ordination Chart
Static_NMDS_Sites<-ggplot() +
  geom_segment(data=Fit_Scores_Sig, aes(x=0, xend=NMDS1, y=0, yend=NMDS2), color="black", arrow=arrow(length=unit(0.03, "npc"), type="closed"), show.legend=FALSE) +
  geom_text(data=Fit_Scores_Sig, aes(x=NMDS1, y=NMDS2, label=c("Years Since Burn")), color="black", size=3, vjust="outward", show.legend=FALSE) +
  geom_segment(data=Fit_Scores_Insig, aes(x=0, xend=NMDS1, y=0, yend=NMDS2), color="#9B9A9E", arrow=arrow(length=unit(0.03, "npc"), type="closed"), show.legend=FALSE) +
  geom_text(data=Fit_Scores_Insig, aes(x=NMDS1, y=NMDS2, label=c("Last Freeze", "Total Spring Precip", "Years Since Mow")), color="#9B9A9E", size=3, vjust="outward", show.legend=FALSE) +
  geom_point(data=Plot_Matrix, aes(x=NMDS1, y=NMDS2, color=Zone, fill=Zone, shape=Zone), size=3) +
  geom_path(data=Plot_Matrix, aes(x=NMDS1, y=NMDS2, color=Zone)) +
  geom_text(data=Plot_Matrix, aes(x=NMDS1, y=NMDS2, color=Zone, label=Year), size=3, vjust=-1.1, show.legend=FALSE) +
  geom_point(data=Burn_Years, aes(x=NMDS1, y=NMDS2, alpha="Burn", color=Zone, fill=Zone, shape=Zone), shape=1, size=5, stroke=0.5) +
  geom_point(data=Mow_Years, aes(x=NMDS1, y=NMDS2, alpha="Mow", color=Zone, fill=Zone, shape=Zone), shape=0, size=5, stroke=0.5) +
  geom_point(data=Cut_Years, aes(x=NMDS1, y=NMDS2, alpha="Cut", color=Zone, fill=Zone, shape=Zone), shape=5, size=5, stroke=0.5) +
  xlab("NMDS1") + 
  ylab("NMDS2") +
  geom_hline(yintercept=0, linetype=2, linewidth=0.2) +
  geom_vline(xintercept=0, linetype=2,  linewidth=0.2) +
  scale_color_manual(values=Zone_Colors$Color) +
  scale_shape_manual(values=c(Zone_Colors$Symbol)) +
  scale_fill_manual(values=Zone_Colors$Color) +
  scale_alpha_manual(name="Treatment", values=c(1, 1, 1), breaks=c("Burn", "Mow", "Cut"), guide=guide_legend(override.aes=list(shape=c(1, 0, 5)))) +
  theme(axis.text.x=element_text(angle=45, vjust=1, hjust=1))

#Print Site Plot with Custom Legend
tiff("Output/Site_NMDS.tif", width=8, height=5, units="in", res=300)
grid.arrange(Static_NMDS_Sites+theme(legend.position="none"),
             get_legend(Zone_Plot),
             get_legend(Treatment_Plot),
             layout_matrix=rbind(c(1,1,1,1,1,NA), c(1,1,1,1,1,2), c(1,1,1,1,1,3), c(1,1,1,1,1,NA)))
invisible(dev.off())

#Static Species Ordination Chart
Static_NMDS_Species<-ggplot() +
  geom_text(data=NMDS_Species, aes(x=NMDS1, y=NMDS2, label=Code, color=Taxa), size=2, fontface="italic", show.legend=FALSE) +
  geom_point(data=Plot_Matrix, aes(x=NMDS1, y=NMDS2, color=Zone, fill=Zone, shape=Zone), size=3) +
  geom_path(data=Plot_Matrix, aes(x=NMDS1, y=NMDS2, color=Zone)) +
  geom_text(data=Plot_Matrix, aes(x=NMDS1, y=NMDS2, color=Zone, label=Year), size=3, vjust=-1.1, show.legend=FALSE) +
  xlab("NMDS1") + 
  ylab("NMDS2") +
  geom_hline(yintercept=0, linetype=2, linewidth=0.2) +
  geom_vline(xintercept=0, linetype=2,  linewidth=0.2) +
  scale_color_manual(values=c("#FE6100", "#9B9A9E", Zone_Colors$Color)) +
  scale_shape_manual(values=c(Zone_Colors$Symbol)) +
  scale_fill_manual(values=Zone_Colors$Color) +
  theme(axis.text.x=element_text(angle=45, vjust=1, hjust=1))

#Print Species Plot with Custom Legend
tiff("Output/Species_NMDS.tif", width=8, height=5, units="in", res=300)
grid.arrange(Static_NMDS_Species+theme(legend.position="none"),
             get_legend(Zone_Plot),
             layout_matrix=rbind(c(1,1,1,1,1,NA), c(1,1,1,1,1,2), c(1,1,1,1,1,NA), c(1,1,1,1,1,NA)))
invisible(dev.off())

#Print Combined Plot
tiff("Output/NMDS_Panel.tif", width=7.5, height=8, units="in", res=300)
grid.arrange(Static_NMDS_Sites+theme(legend.position="none")+labs(tag="A"),
             Static_NMDS_Species+theme(legend.position="none")+labs(tag="B"),
             get_legend(Zone_Plot),
             get_legend(Treatment_Plot),
             get_legend(Zone_Plot),
             #layout_matrix=rbind(c(1,1,1), c(1,1,1), c(1,1,1), c(2,2,2), c(2,2,2), c(2,2,2), c(3,4,5)))
             layout_matrix=rbind(c(1,1,1,1,1,3), c(1,1,1,1,1,4), c(1,1,1,1,1,NA), c(1,1,1,1,1,NA), c(2,2,2,2,2,5), c(2,2,2,2,2,NA), c(2,2,2,2,2,NA), c(2,2,2,2,2,NA)))
invisible(dev.off())
```

## Full Ordination

```{r Full Ordination, include=FALSE}
#Prepare Data for Ordination
Full_Matrix<-Full %>%
  tibble::column_to_rownames("Visit")
X<-match(First_Spp, names(Full_Matrix))

#Run NDMS with 1 though 3 Dimensions
NMDS_1<-metaMDS(Full_Matrix[,X:ncol(Full_Matrix)], distance="bray", k=1, trymax=100, autotransform=FALSE, pc=FALSE, plot=FALSE)
NMDS_2<-metaMDS(Full_Matrix[,X:ncol(Full_Matrix)], distance="bray", k=2, trymax=100, autotransform=FALSE, pc=FALSE, plot=FALSE)
NMDS_3<-metaMDS(Full_Matrix[,X:ncol(Full_Matrix)], distance="bray", k=3, trymax=100, autotransform=FALSE, pc=FALSE, plot=FALSE)

#Clear Unneeded Items
rm(list=c("First_Spp", "Last_Spp", "X"))
```

### Ordination Selection

To determine the optimal number of axes, NMDS using 1 through 3 axes were conducted and compared in a scree plot. The NMDS ordination in two dimensions was chosen as the optimal solution to balance stress and ability to be visualized.

```{r Full Scree and Stress Plots, fig.show="hold", out.width="50%"}
#Build Data Frame of Dimensions and Stress for Plots
Stress<-data.frame(Dimensions=c(1:3),Stress=c(NMDS_1$stress, NMDS_2$stress, NMDS_3$stress))

#Scree Plot
Scree_Plot<-ggplot(Stress, aes(x=Dimensions, y=Stress, label=round(Stress, 2))) +
  geom_line(color="red") +
  geom_point(color="red") +
  geom_text(nudge_y=0.015, color="red") +
  labs(x="Dimensions", y="Stress")
Scree_Plot

#Print Scree Plot
tiff("Output/Full_Scree_Plot.tif", width=6, height=4, units="in", res=300, bg="transparent")
print(Scree_Plot)
invisible(dev.off())

#Select Number of Dimensions
Full_NMDS<-NMDS_3

#Stress Plot
stressplot(Full_NMDS)

#Print Stress Plot
tiff("Output/Full_Stress_Plot.tif", width=6, height=4, units="in", res=300, bg="transparent")
stressplot(Full_NMDS)
invisible(dev.off())

#Clear Unneeded Items
rm(list=c("NMDS_1", "NMDS_2", "NMDS_3", "Stress", "Scree_Plot"))
```

### Fitting Predictor Variables

The climate and management predictor variables were projected onto the ordination using the R package [vegan](https://cran.r-project.org/web/packages/vegan/vegan.pdf) function `envfit` using 100 permutations.

```{r Full Ordination Plot Variable Prep}
#Add NMDS Scores to Matrix
Full_NMDS_Scores<-as.data.frame(scores(Full_NMDS)$sites)
Full_Plot_Matrix<-Full_Matrix %>% 
  merge(Full_NMDS_Scores, by="row.names") %>% 
  tibble::column_to_rownames("Row.names") %>% 
  select(Year, Zone, NMDS1, NMDS2, NMDS3, Total_Spring_Precip:ZIZAPT)

#Fit Management and Dependent Variables
Full_NMDS_Fit<-envfit(Full_NMDS, choices=c(1:3), Full_Plot_Matrix[,c("Total_Spring_Precip", "Last_Freeze", "Years_Since_Mow", "Years_Since_Burn")], na.rm=TRUE, permu=100)
Full_Fit_Scores<-as.data.frame(Full_NMDS_Fit$vectors$arrows) %>%
  mutate(r2=Full_NMDS_Fit$vectors$r, pval=Full_NMDS_Fit$vectors$pvals) %>%
  arrange(pval)

#Fit Scores Kable
Full_Fit_Scores %>% 
  kable(col.names=c("NMDS 1", "NMDS 2", "NMDS 3", "$R^2$", "P-Value"), digits=2, caption="Table 3: Fit of Predictor Variables to Full NMDS Ordination") %>%
  column_spec(6, bold=ifelse(Full_Fit_Scores$pval<=0.05, TRUE, FALSE)) %>%
  kable_styling("striped", full_width=F)

#Select Fit Scores for Plotting
Full_Fit_Scores_Sig<-filter(Full_Fit_Scores, pval<=0.05)
Full_Fit_Scores_Insig<-filter(Full_Fit_Scores, pval>0.05)

#Clear Unneeded Items
rm(list=c("Full_Matrix", "Full_NMDS_Scores", "Full_Fit_Scores"))
```

### Full Ordination Plot

Ordination plot was created using the R package [plotly](https://cran.r-project.org/web/packages/plotly/plotly.pdf). Predictor variables with P-values<=0.05 are illustrated in the ordination plot in black, while predictor variables with P-values>0.05 are grey.

```{r Full Ordination Treatment Years}
#Calculate Year/Group Means
Full_NMDS_Means<-Full_Plot_Matrix %>% 
  select(Year:Years_Since_Cut) %>% 
  group_by(Year, Zone) %>% 
  summarize(across(NMDS1:Years_Since_Cut, ~mean(.x)), .groups="keep") %>% 
  ungroup()

#Complete Response Values for Missing Burn Years Using Interpolation
Central_Burn_Values<-Full_NMDS_Means %>% 
  filter(Zone=="Central") %>% 
  select(Year,  Zone, NMDS1, NMDS2, NMDS3) %>% 
  merge(Central_Burn_Years, all=TRUE) %>% 
  mutate(Burn_Year=case_when(Year %in% Central_Burn_Years$Year~"Y")) %>% 
  mutate(across(NMDS1:NMDS3, ~na.approx(.x))) %>% 
  filter(Burn_Year=="Y") %>% 
  replace_na(list(Zone="Central")) %>% 
  select(-Burn_Year)
East_Burn_Values<-Full_NMDS_Means %>% 
  filter(Zone=="East") %>% 
  select(Year, Zone, NMDS1, NMDS2, NMDS3) %>% 
  merge(East_Burn_Years, all=TRUE) %>% 
  mutate(Burn_Year=case_when(Year %in% East_Burn_Years$Year~"Y")) %>% 
  mutate(across(NMDS1:NMDS3, ~na.approx(.x))) %>% 
  filter(Burn_Year=="Y") %>% 
  replace_na(list(Zone="East")) %>% 
  select(-Burn_Year)
West_Burn_Values<-Full_NMDS_Means %>% 
  filter(Zone=="West") %>% 
  select(Year, Zone, NMDS1, NMDS2, NMDS3) %>% 
  merge(West_Burn_Years, all=TRUE) %>% 
  mutate(Burn_Year=case_when(Year %in% West_Burn_Years$Year~"Y")) %>% 
  mutate(across(NMDS1:NMDS3, ~na.approx(.x))) %>% 
  filter(Burn_Year=="Y") %>% 
  replace_na(list(Zone="West")) %>% 
  select(-Burn_Year)

#Combine All Burn Year Data
Burn_Years<-Central_Burn_Values %>% 
  rbind(East_Burn_Values, West_Burn_Values)

#Complete Response Values for Missing Mow Years Using Interpolation
Central_Mow_Values<-Full_NMDS_Means %>% 
  filter(Zone=="Central") %>% 
  select(Year,  Zone, NMDS1, NMDS2, NMDS3) %>% 
  merge(Central_Mow_Years, all=TRUE) %>% 
  mutate(Mow_Year=case_when(Year %in% Central_Mow_Years$Year~"Y")) %>% 
  mutate(across(NMDS1:NMDS3, ~na.approx(.x))) %>% 
  filter(Mow_Year=="Y") %>% 
  replace_na(list(Zone="Central")) %>% 
  select(-Mow_Year)
East_Mow_Values<-Full_NMDS_Means %>% 
  filter(Zone=="East") %>% 
  select(Year, Zone, NMDS1, NMDS2, NMDS3) %>% 
  merge(East_Mow_Years, all=TRUE) %>% 
  mutate(Mow_Year=case_when(Year %in% East_Mow_Years$Year~"Y")) %>% 
  mutate(across(NMDS1:NMDS3, ~na.approx(.x))) %>% 
  filter(Mow_Year=="Y") %>% 
  replace_na(list(Zone="East")) %>% 
  select(-Mow_Year)
West_Mow_Values<-Full_NMDS_Means %>% 
  filter(Zone=="West") %>% 
  select(Year, Zone, NMDS1, NMDS2, NMDS3) %>% 
  merge(West_Mow_Years, all=TRUE) %>% 
  mutate(Mow_Year=case_when(Year %in% West_Mow_Years$Year~"Y")) %>% 
  mutate(across(NMDS1:NMDS3, ~na.approx(.x))) %>% 
  filter(Mow_Year=="Y") %>% 
  replace_na(list(Zone="West")) %>% 
  select(-Mow_Year)

#Combine All Mow Year Data
Mow_Years<-Central_Mow_Values %>% 
  rbind(East_Mow_Values, West_Mow_Values)

#Complete Response Values for Missing Cut Years Using Interpolation
Central_Cut_Values<-Full_NMDS_Means %>% 
  filter(Zone=="Central") %>% 
  select(Year,  Zone, NMDS1, NMDS2, NMDS3) %>% 
  merge(Central_Cut_Years, all=TRUE) %>% 
  mutate(Cut_Year=case_when(Year %in% Central_Cut_Years$Year~"Y")) %>% 
  mutate(across(NMDS1:NMDS3, ~na.approx(.x))) %>% 
  filter(Cut_Year=="Y") %>% 
  replace_na(list(Zone="Central")) %>% 
  select(-Cut_Year)
East_Cut_Values<-Full_NMDS_Means %>% 
  filter(Zone=="East") %>% 
  select(Year, Zone, NMDS1, NMDS2, NMDS3) %>% 
  merge(East_Cut_Years, all=TRUE) %>% 
  mutate(Cut_Year=case_when(Year %in% East_Cut_Years$Year~"Y")) %>% 
  mutate(across(NMDS1:NMDS3, ~na.approx(.x))) %>% 
  filter(Cut_Year=="Y") %>% 
  replace_na(list(Zone="East")) %>% 
  select(-Cut_Year)
West_Cut_Values<-Full_NMDS_Means %>% 
  filter(Zone=="West") %>% 
  select(Year, Zone, NMDS1, NMDS2, NMDS3) %>% 
  merge(West_Cut_Years, all=TRUE) %>% 
  mutate(Cut_Year=case_when(Year %in% West_Cut_Years$Year~"Y")) %>% 
  mutate(across(NMDS1:NMDS3, ~na.approx(.x))) %>% 
  filter(Cut_Year=="Y") %>% 
  replace_na(list(Zone="West")) %>% 
  select(-Cut_Year)

#Combine All Cut Year Data
Cut_Years<-Central_Cut_Values %>% 
  rbind(East_Cut_Values, West_Cut_Values)

#Clear Unneeded Items
rm(list=c("Central_Burn_Years", "East_Burn_Years", "West_Burn_Years", "Central_Burn_Values", "East_Burn_Values", "West_Burn_Values", "Central_Mow_Years", "East_Mow_Years", "West_Mow_Years", "Central_Mow_Values", "East_Mow_Values", "West_Mow_Values", "Central_Cut_Years", "East_Cut_Years", "West_Cut_Years", "Central_Cut_Values", "East_Cut_Values", "West_Cut_Values"))
```
```{r Full Ordination Plot}
#Interactive Biplot
Plotly_Biplot<-plot_ly(data=Full_Plot_Matrix, x=~NMDS1, y=~NMDS2, z=~NMDS3) %>% 
  layout(scene=list(aspectratio=list(x=1, y=1, z=1))) %>% 
  add_trace(type="scatter3d", mode="markers", color=~Zone, colors=Zone_Colors$Color, symbol=~Zone, symbols=Zone_Colors$Symbol, marker=list(size=12), opacity=0.1, text=~paste(" ", Year), showlegend=FALSE) %>% 
  add_trace(data=Full_NMDS_Means, x=Full_NMDS_Means$NMDS1, y=Full_NMDS_Means$NMDS2, y=Full_NMDS_Means$NMDS3, type="scatter3d", mode="lines+markers+text", color=~Zone, colors=Zone_Colors$Color, symbol=~Zone, symbols=Zone_Colors$Symbol, marker=list(size=12), text=~paste(" ", Year), textposition="top") %>% 
  add_trace(x=Burn_Years$NMDS1, y=Burn_Years$NMDS2, z=Burn_Years$NMDS3, type="scatter3d", mode="markers", color=Burn_Years$Zone, colors=Zone_Colors$Color, marker=list(symbol="circle-open", size=16, line=list(width=0.5)), opacity=0.5, name="Burn", hoverinfo=Burn_Years$Year) %>%
  add_trace(x=Mow_Years$NMDS1, y=Mow_Years$NMDS2, z=Mow_Years$NMDS3, type="scatter3d", mode="markers", color=Mow_Years$Zone, colors=Zone_Colors$Color, marker=list(symbol="square-open", size=16, line=list(width=0.5)), opacity=0.5, name="Mow", hoverinfo=Mow_Years$Year) %>% 
  add_trace(x=Cut_Years$NMDS1, y=Cut_Years$NMDS2, z=Cut_Years$NMDS3, type="scatter3d", mode="markers", color=Cut_Years$Zone, colors=Zone_Colors$Color, marker=list(symbol="diamond-open", size=16, line=list(width=0.5)), opacity=0.5, name="Cut", hoverinfo=Cut_Years$Year)  %>% 
  config(toImageButtonOptions=list(format="png", filename="Big_Meadows_Full_NMDS", width=NULL, height=NULL, scale=6))
for (i in 1:nrow(Full_Fit_Scores_Sig)) {
   Plotly_Biplot<-Plotly_Biplot %>%
     add_trace(x=c(0, Full_Fit_Scores_Sig[i,1]), y=c(0, Full_Fit_Scores_Sig[i,2]), z=c(0, Full_Fit_Scores_Sig[i,3]), type="scatter3d", mode="lines", line=list(width=4, color="black"), showlegend=FALSE) }
for (i in 1:nrow(Full_Fit_Scores_Sig)) {
   Plotly_Biplot<-Plotly_Biplot %>%
     add_trace(x=Full_Fit_Scores_Sig[i,1], y=Full_Fit_Scores_Sig[i,2], z=Full_Fit_Scores_Sig[i,3], type="scatter3d", mode="text", text=paste(rownames(Full_Fit_Scores_Sig[i,])), textposition="middle center", textfont=list(color="black"), showlegend=FALSE) }
for (i in 1:nrow(Full_Fit_Scores_Insig)) {
   Plotly_Biplot<-Plotly_Biplot %>%
     add_trace(x=c(0, Full_Fit_Scores_Insig[i,1]), y=c(0, Full_Fit_Scores_Insig[i,2]), z=c(0, Full_Fit_Scores_Insig[i,3]), type="scatter3d", mode="lines", line=list(width=4, color="#9B9A9E"), showlegend=FALSE) }
for (i in 1:nrow(Full_Fit_Scores_Insig)) {
   Plotly_Biplot<-Plotly_Biplot %>%
     add_trace(x=Full_Fit_Scores_Insig[i,1], y=Full_Fit_Scores_Insig[i,2], z=Full_Fit_Scores_Insig[i,3], type="scatter3d", mode="text", text=paste(rownames(Full_Fit_Scores_Insig[i,])), textposition="middle center", textfont=list(color="#9B9A9E"), showlegend=FALSE) }
Plotly_Biplot<-Plotly_Biplot %>%
  layout(legend=list(title=list(text="Zone")), updatemenus=list(list(active=0, type="buttons", direction="right", xanchor="center", yanchor="top", pad=list('r'=0, 't'=10, 'b'=10), x=0.5, y=1.27, buttons=list(list(label="All Transects", method="update", args=list(list(visible=c(rep(TRUE, 23))))), list(label="Means Only",method="update",args=list(list(visible = c(rep(FALSE, 3), rep(TRUE, 20)))))))))
Plotly_Biplot

#Clear Unneeded Items
rm(list=c("Full_Fit_Scores_Sig", "Full_Fit_Scores_Insig", "Full_NMDS", "Full_NMDS_Fit", "Full_NMDS_Means", "Burn_Years", "Mow_Years", "Cut_Years", "Full_Plot_Matrix", "Zone_Colors", "Plotly_Biplot", "i"))
```

# Modeling

## Data Preparation

```{r Select Modeling Variables}
#Select Modeling Variables
Modeling_Variables<-Full %>% 
  select(Visit, Transect, Year, Zone, Total_Spring_Precip:Years_Since_Cut, Total_Count, Woody_Count:Percent_Celastrus)

#Correct Data Formats
Modeling_Variables$Zone<-factor(Modeling_Variables$Zone, levels=levels(Full$Zone))
Modeling_Variables$Transect<-as.factor(Modeling_Variables$Transect)
Modeling_Variables$Year<-as.factor(Modeling_Variables$Year)

#Select Predictor and Response Variables
Predictor_Variables<-c("Total_Spring_Precip", "Last_Freeze", "Years_Since_Mow", "Years_Since_Burn", "Years_Since_Cut")

#Clear Unneeded Items
#rm(list=c("Full"))
```

To improve model convergence, the variables for total spring precipitation and the date of the last freeze were re-scaled by dividing all values by 10. Therefore, when interpreting model coefficients, a unit increase in total spring precipitation represents a 10 ppt increase in rainfall, and a unit increase in date of last freeze represents a ten-day difference in date.

Of the four selected predictor variables (total spring precipitation, date of last freeze, years since last mow, and years since last burn), none had a degree of colinearity greater than |0.7| with the management or weather-related predictor variables, so all of them can be used in model building.

```{r Check Collinearity , warning=FALSE}
#Scale Predictor Variables
Modeling_Variables<-Modeling_Variables %>% 
  mutate(Total_Spring_Precip=Total_Spring_Precip/10) %>% 
  mutate(Last_Freeze=Last_Freeze/10)

#Create Collinearity Pairs Plot
pairs(Modeling_Variables[,c(Predictor_Variables)], panel=panel.smooth, upper.panel=panel.cor, diag.panel=panel.hist)

#Print Pairs Plot
tiff("Output/Pairs_Plot.tif", width=6, height=4, units="in", res=300)
pairs(Modeling_Variables[,c(Predictor_Variables)], panel=panel.smooth, upper.panel=panel.cor, diag.panel=panel.hist)
invisible(dev.off())

#Clear Unneeded Items
#rm(list=c("panel.cor", "panel.hist"))
```

## Woody Plants

### Woody Plants (As Percent)

#### Model Structure

Models were run using the functions `lm()` and `lmer()` from the R package [lme4](https://cran.r-project.org/web/packages/lme4/lme4.pdf), as the response variable is a percentage.

##### Random Effect Selection

Transect, Zone, and Year are grouping variables that may need to be accounted for as mixed effects when running models. Zone has fewer than five levels so it should not be used as a random effect on its own, however, each Transect is nested within a Zone. To determine the best structure of random effects, possible random effect structures based on the study design were modeled and the model with the best fixed effect structure of the group was selected using the R package [performance](https://cran.r-project.org/web/packages/performance/performance.pdf) function `compare_performance()`.

```{r Woody Random Model Selection, echo=TRUE}
#Run Models
Woody_Percent_Random_Models<-list(
  "Intercept"=lm(Percent_Woody ~ 1, data=Modeling_Variables),
  "Year"=lmer(Percent_Woody ~ (1|Year), data=Modeling_Variables),
  "Transect"=lmer(Percent_Woody ~ (1|Transect), data=Modeling_Variables),
  "Zone/Transect"=lmer(Percent_Woody ~ (1|Zone/Transect), data=Modeling_Variables),
  "Year+Transect"=lmer(Percent_Woody ~ (1|Year) + (1|Transect), data=Modeling_Variables),
  "Year+Zone/Transect"=lmer(Percent_Woody ~ (1|Year) + (1|Zone/Transect), data=Modeling_Variables))

#Compare Models
compare_performance(Woody_Percent_Random_Models, rank=TRUE)
plot(compare_performance(Woody_Percent_Random_Models))

#Clear Unneeded Items
rm(list=c("Woody_Percent_Random_Models"))
```

##### Fixed Effect Selection

Additive model selection was conducted after splitting the predictor variables into two groups: the "Climate" variables "Total Spring Precipitation" and "Date of Last Freeze" and the "Management" predictor variables "Years Since Last Burn" and "Years Since Last Mow".

For all variable groups, all possible fixed effect structures (including models of two-way interactions for the Climate and Management variables) were modeled, and the model with the best fixed effect structure of the group was selected using the R package [performance](https://cran.r-project.org/web/packages/performance/performance.pdf) function `compare_performance()`. To build a final model, all additive combinations of the best fixed effect structures from each group were modeled and the best model was selected.

##### Weather Variables

```{r Woody Weather Model Selection, echo=TRUE}
#Run Models
Woody_Percent_Weather_Models<-list(
  "Random"=lmer(Percent_Woody ~ (1|Year) + (1|Zone/Transect), data=Modeling_Variables),
  "Precip"=lmer(Percent_Woody ~ Total_Spring_Precip + (1|Year) + (1|Zone/Transect), data=Modeling_Variables),
  "Freeze"=lmer(Percent_Woody ~ Last_Freeze + (1|Year) + (1|Zone/Transect), data=Modeling_Variables),
  "Precip+Freeze"=lmer(Percent_Woody ~ Total_Spring_Precip + Last_Freeze + (1|Year) + (1|Zone/Transect), data=Modeling_Variables),
  "Precip*Freeze"=lmer(Percent_Woody ~ Total_Spring_Precip * Last_Freeze + (1|Year) + (1|Zone/Transect), data=Modeling_Variables))

#Compare Models
compare_performance(Woody_Percent_Weather_Models, rank=TRUE)
plot(compare_performance(Woody_Percent_Weather_Models))

#Clear Unneeded Items
rm(list=c("Woody_Percent_Weather_Models"))
```

##### Management Variables

```{r Woody Management Model Selection, echo=TRUE}
#Run Models
Woody_Percent_Manage_Models<-list(
  "Random"=lmer(Percent_Woody ~ (1|Year) + (1|Zone/Transect), data=Modeling_Variables),
  "Burn"=lmer(Percent_Woody ~ Years_Since_Burn + (1|Year) + (1|Zone/Transect), data=Modeling_Variables),
  "Mow"=lmer(Percent_Woody ~ Years_Since_Mow + (1|Year) + (1|Zone/Transect), data=Modeling_Variables),
  "Burn+Mow"=lmer(Percent_Woody ~ Years_Since_Burn + Years_Since_Mow + (1|Year) + (1|Zone/Transect), data=Modeling_Variables),
  "Burn*Mow"=lmer(Percent_Woody ~ Years_Since_Burn * Years_Since_Mow + (1|Year) + (1|Zone/Transect), data=Modeling_Variables))

#Compare Models
compare_performance(Woody_Percent_Manage_Models, rank=TRUE)
plot(compare_performance(Woody_Percent_Manage_Models))

#Clear Unneeded Items
rm(list=c("Woody_Percent_Manage_Models"))
```

##### Combining Variable Groups

```{r Woody Combined Model Selection, echo=TRUE}
#Run Models
Woody_Percent_Combined_Models<-list(
  "Random"=lmer(Percent_Woody ~ (1|Year) + (1|Zone/Transect), data=Modeling_Variables),
  "Precip"=lmer(Percent_Woody ~ Total_Spring_Precip + (1|Year) + (1|Zone/Transect), data=Modeling_Variables),
  "Burn"=lmer(Percent_Woody ~ Years_Since_Burn + (1|Year) + (1|Zone/Transect), data=Modeling_Variables),
  "Precip+Burn"=lmer(Percent_Woody ~ Total_Spring_Precip + Years_Since_Burn + (1|Year) + (1|Zone/Transect), data=Modeling_Variables),
  "Precip*Burn"=lmer(Percent_Woody ~ Total_Spring_Precip * Years_Since_Burn + (1|Year) + (1|Zone/Transect), data=Modeling_Variables))

#Compare Models
compare_performance(Woody_Percent_Combined_Models, rank=TRUE)
plot(compare_performance(Woody_Percent_Combined_Models))

#Select Best Model
Best_Woody_Percent_Model<-lmer(Percent_Woody ~ Total_Spring_Precip + Years_Since_Burn + (1|Year) + (1|Zone/Transect), data=Modeling_Variables)

#Clear Unneeded Items
rm(list=c("Woody_Percent_Combined_Models"))
```

### Woody Plants (As Poisson Count)

#### Model Structure

Models were run using the functions `glm()` and `glmer()` from the R package [lme4](https://cran.r-project.org/web/packages/lme4/lme4.pdf) with family=Poisson, as the response variable is a count variable.

##### Random Effect Selection

Transect, Zone, and Year are grouping variables that may need to be accounted for as mixed effects when running models. Zone has fewer than five levels so it should not be used as a random effect on its own, however, each Transect is nested within a Zone. To determine the best structure of random effects, possible random effect structures based on the study design were modeled and the model with the best fixed effect structure of the group was selected using the R package [performance](https://cran.r-project.org/web/packages/performance/performance.pdf) function `compare_performance()`.

```{r Woody Count Random Model Selection, echo=TRUE}
#Run Models
Woody_Count_P_Random_Models<-list(
  "Intercept"=glm(Woody_Count ~ 1, data=Modeling_Variables, family=poisson),
  "Year"=glmer(Woody_Count ~ (1|Year), data=Modeling_Variables, family=poisson),
  "Transect"=glmer(Woody_Count ~ (1|Transect), data=Modeling_Variables, family=poisson),
  "Zone/Transect"=glmer(Woody_Count ~ (1|Zone/Transect), data=Modeling_Variables, family=poisson),
  "Year+Transect"=glmer(Woody_Count ~ (1|Year) + (1|Transect), data=Modeling_Variables, family=poisson),
  "Year+Zone/Transect"=glmer(Woody_Count ~ (1|Year) + (1|Zone/Transect), data=Modeling_Variables, family=poisson))

#Compare Models
compare_performance(Woody_Count_P_Random_Models, rank=TRUE)
plot(compare_performance(Woody_Count_P_Random_Models))

#Clear Unneeded Items
rm(list=c("Woody_Count_P_Random_Models"))
```

##### Fixed Effect Selection

Additive model selection was conducted after splitting the predictor variables into two groups: the "Climate" variables "Total Spring Precipitation" and "Date of Last Freeze" and the "Management" predictor variables "Years Since Last Burn" and "Years Since Last Mow".

For all variable groups, all possible fixed effect structures (including models of two-way interactions for the Climate and Management variables) were modeled, and the model with the best fixed effect structure of the group was selected using the R package [performance](https://cran.r-project.org/web/packages/performance/performance.pdf) function `compare_performance()`. To build a final model, all additive combinations of the best fixed effect structures from each group were modeled and the best model was selected.

##### Weather Variables

```{r Woody Count Weather Model Selection, echo=TRUE}
#Run Models
Woody_Count_P_Weather_Models<-list(
  "Random"=glmer(Woody_Count ~ (1|Year) + (1|Zone/Transect), data=Modeling_Variables, family=poisson),
  "Precip"=glmer(Woody_Count ~ Total_Spring_Precip + (1|Year) + (1|Zone/Transect), data=Modeling_Variables, family=poisson),
  "Freeze"=glmer(Woody_Count ~ Last_Freeze + (1|Year) + (1|Zone/Transect), data=Modeling_Variables, family=poisson),
  "Precip+Freeze"=glmer(Woody_Count ~ Total_Spring_Precip + Last_Freeze + (1|Year) + (1|Zone/Transect), data=Modeling_Variables, family=poisson),
  "Precip*Freeze"=glmer(Woody_Count ~ Total_Spring_Precip * Last_Freeze + (1|Year) + (1|Zone/Transect), data=Modeling_Variables, family=poisson))

#Compare Models
compare_performance(Woody_Count_P_Weather_Models, rank=TRUE)
plot(compare_performance(Woody_Count_P_Weather_Models))

#Clear Unneeded Items
rm(list=c("Woody_Count_P_Weather_Models"))
```

##### Management Variables

```{r Woody Count Management Model Selection, echo=TRUE}
#Run Models
Woody_Count_P_Manage_Models<-list(
  "Random"=glmer(Woody_Count ~ (1|Year) + (1|Zone/Transect), data=Modeling_Variables, family=poisson),
  "Burn"=glmer(Woody_Count ~ Years_Since_Burn + (1|Year) + (1|Zone/Transect), data=Modeling_Variables, family=poisson),
  "Mow"=glmer(Woody_Count ~ Years_Since_Mow + (1|Year) + (1|Zone/Transect), data=Modeling_Variables, family=poisson),
  "Burn+Mow"=glmer(Woody_Count ~ Years_Since_Burn + Years_Since_Mow + (1|Year) + (1|Zone/Transect), data=Modeling_Variables, family=poisson),
  "Burn*Mow"=glmer(Woody_Count ~ Years_Since_Burn * Years_Since_Mow + (1|Year) + (1|Zone/Transect), data=Modeling_Variables, family=poisson))

#Compare Models
compare_performance(Woody_Count_P_Manage_Models, rank=TRUE)
plot(compare_performance(Woody_Count_P_Manage_Models))

#Clear Unneeded Items
rm(list=c("Woody_Count_P_Manage_Models"))
```

##### Combining Variable Groups

```{r Woody Count Combined Model Selection, echo=TRUE}
#Run Models
Woody_Count_P_Combined_Models<-list(
  "Random"=glmer(Woody_Count ~ (1|Year) + (1|Zone/Transect), data=Modeling_Variables, family=poisson),
  "Precip"=glmer(Woody_Count ~ Total_Spring_Precip + (1|Year) + (1|Zone/Transect), data=Modeling_Variables, family=poisson),
  "Burn"=glmer(Woody_Count ~ Years_Since_Burn + (1|Year) + (1|Zone/Transect), data=Modeling_Variables, family=poisson),
  "Precip+Burn"=glmer(Woody_Count ~ Total_Spring_Precip + Years_Since_Burn + (1|Year) + (1|Zone/Transect), data=Modeling_Variables, family=poisson),
  "Precip*Burn"=glmer(Woody_Count ~ Total_Spring_Precip * Years_Since_Burn + (1|Year) + (1|Zone/Transect), data=Modeling_Variables, family=poisson))

#Compare Models
compare_performance(Woody_Count_P_Combined_Models, rank=TRUE)
plot(compare_performance(Woody_Count_P_Combined_Models))

#Select Best Model
Best_Woody_Count_P_Model<-glmer(Woody_Count ~ Total_Spring_Precip + Years_Since_Burn + (1|Year) + (1|Zone/Transect), data=Modeling_Variables, family=poisson)

#Clear Unneeded Items
rm(list=c("Woody_Count_P_Combined_Models"))
```

### Woody Plants (As Negative Binomial Count)

#### Model Structure

Models were run using the functions `glm.nb()` and `glmer.nb()` from the R package [MASS](https://cran.r-project.org/web/packages/MASS/MASS.pdf), as the response variable is a count variable.

##### Random Effect Selection

Transect, Zone, and Year are grouping variables that may need to be accounted for as mixed effects when running models. Zone has fewer than five levels so it should not be used as a random effect on its own, however, each Transect is nested within a Zone. To determine the best structure of random effects, possible random effect structures based on the study design were modeled and the model with the best fixed effect structure of the group was selected using the R package [performance](https://cran.r-project.org/web/packages/performance/performance.pdf) function `compare_performance()`.

```{r Woody NB Count Random Model Selection, echo=TRUE}
#Run Models
Woody_Count_NB_Random_Models<-list(
  "Intercept"=glm.nb(Woody_Count ~ 1, data=Modeling_Variables),
  "Year"=glmer.nb(Woody_Count ~ (1|Year), data=Modeling_Variables),
  "Transect"=glmer.nb(Woody_Count ~ (1|Transect), data=Modeling_Variables),
  "Zone/Transect"=glmer.nb(Woody_Count ~ (1|Zone/Transect), data=Modeling_Variables),
  "Year+Transect"=glmer.nb(Woody_Count ~ (1|Year) + (1|Transect), data=Modeling_Variables),
  "Year+Zone/Transect"=glmer.nb(Woody_Count ~ (1|Year) + (1|Zone/Transect), data=Modeling_Variables))

#Compare Models
compare_performance(Woody_Count_NB_Random_Models, rank=TRUE)
plot(compare_performance(Woody_Count_NB_Random_Models))

#Clear Unneeded Items
rm(list=c("Woody_Count_NB_Random_Models"))
```

##### Fixed Effect Selection

Additive model selection was conducted after splitting the predictor variables into two groups: the "Climate" variables "Total Spring Precipitation" and "Date of Last Freeze" and the "Management" predictor variables "Years Since Last Burn" and "Years Since Last Mow".

For all variable groups, all possible fixed effect structures (including models of two-way interactions for the Climate and Management variables) were modeled, and the model with the best fixed effect structure of the group was selected using the R package [performance](https://cran.r-project.org/web/packages/performance/performance.pdf) function `compare_performance()`. To build a final model, all additive combinations of the best fixed effect structures from each group were modeled and the best model was selected.

##### Weather Variables

```{r Woody NB Count Weather Model Selection, echo=TRUE}
#Run Models
Woody_Count_NB_Weather_Models<-list(
  "Random"=glmer.nb(Woody_Count ~ (1|Year) + (1|Zone/Transect), data=Modeling_Variables),
  "Precip"=glmer.nb(Woody_Count ~ Total_Spring_Precip + (1|Year) + (1|Zone/Transect), data=Modeling_Variables),
  "Freeze"=glmer.nb(Woody_Count ~ Last_Freeze + (1|Year) + (1|Zone/Transect), data=Modeling_Variables),
  "Precip+Freeze"=glmer.nb(Woody_Count ~ Total_Spring_Precip + Last_Freeze + (1|Year) + (1|Zone/Transect), data=Modeling_Variables),
  "Precip*Freeze"=glmer.nb(Woody_Count ~ Total_Spring_Precip * Last_Freeze + (1|Year) + (1|Zone/Transect), data=Modeling_Variables))

#Compare Models
compare_performance(Woody_Count_NB_Weather_Models, rank=TRUE)
plot(compare_performance(Woody_Count_NB_Weather_Models))

#Clear Unneeded Items
rm(list=c("Woody_Count_NB_Weather_Models"))
```

##### Management Variables

```{r Woody NB Count Management Model Selection, echo=TRUE}
#Run Models
Woody_Count_NB_Manage_Models<-list(
  "Random"=glmer.nb(Woody_Count ~ (1|Year) + (1|Zone/Transect), data=Modeling_Variables),
  "Burn"=glmer.nb(Woody_Count ~ Years_Since_Burn + (1|Year) + (1|Zone/Transect), data=Modeling_Variables),
  "Mow"=glmer.nb(Woody_Count ~ Years_Since_Mow + (1|Year) + (1|Zone/Transect), data=Modeling_Variables),
  "Burn+Mow"=glmer.nb(Woody_Count ~ Years_Since_Burn + Years_Since_Mow + (1|Year) + (1|Zone/Transect), data=Modeling_Variables),
  "Burn*Mow"=glmer.nb(Woody_Count ~ Years_Since_Burn * Years_Since_Mow + (1|Year) + (1|Zone/Transect), data=Modeling_Variables))

#Compare Models
compare_performance(Woody_Count_NB_Manage_Models, rank=TRUE)
plot(compare_performance(Woody_Count_NB_Manage_Models))

#Clear Unneeded Items
rm(list=c("Woody_Count_NB_Manage_Models"))
```

##### Combining Variable Groups

```{r Woody NB Count Combined Model Selection, echo=TRUE}
#Run Models
Woody_Count_NB_Combined_Models<-list(
  "Random"=glmer.nb(Woody_Count ~ (1|Year) + (1|Zone/Transect), data=Modeling_Variables),
  "Precip"=glmer.nb(Woody_Count ~ Total_Spring_Precip + (1|Year) + (1|Zone/Transect), data=Modeling_Variables),
  "Burn"=glmer.nb(Woody_Count ~ Years_Since_Burn + (1|Year) + (1|Zone/Transect), data=Modeling_Variables),
  "Precip+Burn"=glmer.nb(Woody_Count ~ Total_Spring_Precip + Years_Since_Burn + (1|Year) + (1|Zone/Transect), data=Modeling_Variables),
  "Precip*Burn"=glmer.nb(Woody_Count ~ Total_Spring_Precip * Years_Since_Burn + (1|Year) + (1|Zone/Transect), data=Modeling_Variables))

#Compare Models
compare_performance(Woody_Count_NB_Combined_Models, rank=TRUE)
plot(compare_performance(Woody_Count_NB_Combined_Models))

#Select Best Model
Best_Woody_Count_NB_Model<-glmer.nb(Woody_Count ~ Total_Spring_Precip + Years_Since_Burn + (1|Year) + (1|Zone/Transect), data=Modeling_Variables)

#Clear Unneeded Items
rm(list=c("Woody_Count_NB_Combined_Models"))
```

### Woody Plants (As Binomial Proportion)

#### Model Structure

Models were run using the functions `glm()` and `glmer()` from the R package [lme4](https://cran.r-project.org/web/packages/lme4/lme4.pdf) with family=Binomial, as the response variable is a proportion.

##### Random Effect Selection

Transect, Zone, and Year are grouping variables that may need to be accounted for as mixed effects when running models. Zone has fewer than five levels so it should not be used as a random effect on its own, however, each Transect is nested within a Zone. To determine the best structure of random effects, possible random effect structures based on the study design were modeled and the model with the best fixed effect structure of the group was selected using the R package [performance](https://cran.r-project.org/web/packages/performance/performance.pdf) function `compare_performance()`.

```{r Woody Binomial Proportion Random Model Selection, echo=TRUE}
#Run Models
Woody_Binom_Prop_Random_Models<-list(
  "Intercept"=glm(cbind(Woody_Count, Total_Count-Woody_Count) ~ 1, data=Modeling_Variables, family=binomial),
  "Year"=glmer(cbind(Woody_Count, Total_Count-Woody_Count) ~ (1|Year), data=Modeling_Variables, family=binomial),
  "Transect"=glmer(cbind(Woody_Count, Total_Count-Woody_Count) ~ (1|Transect), data=Modeling_Variables, family=binomial),
  "Zone/Transect"=glmer(cbind(Woody_Count, Total_Count-Woody_Count) ~ (1|Zone/Transect), data=Modeling_Variables, family=binomial),
  "Year+Transect"=glmer(cbind(Woody_Count, Total_Count-Woody_Count) ~ (1|Year) + (1|Transect), data=Modeling_Variables, family=binomial),
  "Year+Zone/Transect"=glmer(cbind(Woody_Count, Total_Count-Woody_Count) ~ (1|Year) + (1|Zone/Transect), data=Modeling_Variables, family=binomial))

#Compare Models
compare_performance(Woody_Binom_Prop_Random_Models, rank=TRUE)
plot(compare_performance(Woody_Binom_Prop_Random_Models))

#Clear Unneeded Items
rm(list=c("Woody_Binom_Prop_Random_Models"))
```

##### Fixed Effect Selection

Additive model selection was conducted after splitting the predictor variables into two groups: the "Climate" variables "Total Spring Precipitation" and "Date of Last Freeze" and the "Management" predictor variables "Years Since Last Burn" and "Years Since Last Mow".

For all variable groups, all possible fixed effect structures (including models of two-way interactions for the Climate and Management variables) were modeled, and the model with the best fixed effect structure of the group was selected using the R package [performance](https://cran.r-project.org/web/packages/performance/performance.pdf) function `compare_performance()`. To build a final model, all additive combinations of the best fixed effect structures from each group were modeled and the best model was selected.

##### Weather Variables

```{r Woody Binomial Proportion Weather Model Selection, echo=TRUE}
#Run Models
Woody_Binom_Prop_Weather_Models<-list(
  "Random"=glmer(cbind(Woody_Count, Total_Count-Woody_Count) ~ (1|Year) + (1|Zone/Transect), data=Modeling_Variables, family=binomial),
  "Precip"=glmer(cbind(Woody_Count, Total_Count-Woody_Count) ~ Total_Spring_Precip + (1|Year) + (1|Zone/Transect), data=Modeling_Variables, family=binomial),
  "Freeze"=glmer(cbind(Woody_Count, Total_Count-Woody_Count) ~ Last_Freeze + (1|Year) + (1|Zone/Transect), data=Modeling_Variables, family=binomial),
  "Precip+Freeze"=glmer(cbind(Woody_Count, Total_Count-Woody_Count) ~ Total_Spring_Precip + Last_Freeze + (1|Year) + (1|Zone/Transect), data=Modeling_Variables, family=binomial),
  "Precip*Freeze"=glmer(cbind(Woody_Count, Total_Count-Woody_Count) ~ Total_Spring_Precip * Last_Freeze + (1|Year) + (1|Zone/Transect), data=Modeling_Variables, family=binomial))

#Compare Models
compare_performance(Woody_Binom_Prop_Weather_Models, rank=TRUE)
plot(compare_performance(Woody_Binom_Prop_Weather_Models))

#Clear Unneeded Items
rm(list=c("Woody_Binom_Prop_Weather_Models"))
```

##### Management Variables

```{r Woody Binomial Proportion Management Model Selection, echo=TRUE}
#Run Models
Woody_Binom_Prop_Manage_Models<-list(
  "Random"=glmer(cbind(Woody_Count, Total_Count-Woody_Count) ~ (1|Year) + (1|Zone/Transect), data=Modeling_Variables, family=binomial),
  "Burn"=glmer(cbind(Woody_Count, Total_Count-Woody_Count) ~ Years_Since_Burn + (1|Year) + (1|Zone/Transect), data=Modeling_Variables, family=binomial),
  "Mow"=glmer(cbind(Woody_Count, Total_Count-Woody_Count) ~ Years_Since_Mow + (1|Year) + (1|Zone/Transect), data=Modeling_Variables, family=binomial),
  "Burn+Mow"=glmer(cbind(Woody_Count, Total_Count-Woody_Count) ~ Years_Since_Burn + Years_Since_Mow + (1|Year) + (1|Zone/Transect), data=Modeling_Variables, family=binomial),
  "Burn*Mow"=glmer(cbind(Woody_Count, Total_Count-Woody_Count) ~ Years_Since_Burn * Years_Since_Mow + (1|Year) + (1|Zone/Transect), data=Modeling_Variables, family=binomial))

#Compare Models
compare_performance(Woody_Binom_Prop_Manage_Models, rank=TRUE)
plot(compare_performance(Woody_Binom_Prop_Manage_Models))

#Clear Unneeded Items
rm(list=c("Woody_Binom_Prop_Manage_Models"))
```

##### Combining Variable Groups

```{r Woody Binomial Proportion Combined Model Selection, echo=TRUE}
#Run Models
Woody_Binom_Prop_Combined_Models<-list(
  "Random"=glmer(cbind(Woody_Count, Total_Count-Woody_Count) ~ (1|Year) + (1|Zone/Transect), data=Modeling_Variables, family=binomial),
  "Precip"=glmer(cbind(Woody_Count, Total_Count-Woody_Count) ~ Total_Spring_Precip + (1|Year) + (1|Zone/Transect), data=Modeling_Variables, family=binomial),
  "Burn"=glmer(cbind(Woody_Count, Total_Count-Woody_Count) ~ Years_Since_Burn + (1|Year) + (1|Zone/Transect), data=Modeling_Variables, family=binomial),
  "Precip+Burn"=glmer(cbind(Woody_Count, Total_Count-Woody_Count) ~ Total_Spring_Precip + Years_Since_Burn + (1|Year) + (1|Zone/Transect), data=Modeling_Variables, family=binomial),
  "Precip*Burn"=glmer(cbind(Woody_Count, Total_Count-Woody_Count) ~ Total_Spring_Precip * Years_Since_Burn + (1|Year) + (1|Zone/Transect), data=Modeling_Variables, family=binomial))

#Compare Models
compare_performance(Woody_Binom_Prop_Combined_Models, rank=TRUE)
plot(compare_performance(Woody_Binom_Prop_Combined_Models))

#Select Best Model
Best_Woody_Binom_Prop_Model<-glmer(cbind(Woody_Count, Total_Count-Woody_Count) ~ Total_Spring_Precip + Years_Since_Burn + (1|Year) + (1|Zone/Transect), data=Modeling_Variables, family=binomial)

#Clear Unneeded Items
rm(list=c("Woody_Binom_Prop_Combined_Models"))
```

### Overall Best Woody Model

#### Model Selection

```{r Best Overall Woody Model, echo=TRUE}
#Run Models
Woody_All_Models<-list(
  "Linear Percentage"=Best_Woody_Percent_Model,
  "Poisson Count"=Best_Woody_Count_P_Model,
  "Negative Binomial Count"=Best_Woody_Count_NB_Model,
  "Binomial Proportion"=Best_Woody_Binom_Prop_Model)

#Compare Models
compare_performance(Woody_All_Models, rank=TRUE)
plot(compare_performance(Woody_All_Models))
```

#### Model Summary

```{r Overall Best Woody Model}
#Select Best Model
Best_Woody_Model<-Best_Woody_Percent_Model

#Model Summary
summary(Best_Woody_Model)
model_performance(Best_Woody_Model)

#Fancy Model Table
tab_model(Best_Woody_Model, dv.labels="Percent Woody Plants")

#Best Model Report
report(Best_Woody_Model)

#Clear Unneeded Items
rm(list=c("Woody_All_Models", "Best_Woody_Percent_Model", "Best_Woody_Count_P_Model", "Best_Woody_Count_NB_Model", "Best_Woody_Binom_Prop_Model"))
```

#### Model Diagnostics

```{r Best Woody Model Diagnostics}
#Diagnostic Tests
plot(simulateResiduals(fittedModel=Best_Woody_Model), title="Percent Woody Plants")

#Save DHARMa Plot
tiff("Output/Woody_DHARMa.tif", width=8, height=4, units="in", res=300)
plot(simulateResiduals(fittedModel=Best_Woody_Model), title="A Percent Woody Plants")
invisible(dev.off())
```

#### Effect Plots

```{r Best Woody Model Effects Plots}
#Fixed Effects Coefficients Plot
Woody_Effects<-plot(parameters(Best_Woody_Model, effects="fixed")) +
  annotate("text", x=c(4.33), y=c(1.1), color=c("#458DE1"), label=c("***"), size=8)
Woody_Effects

#Effects Plot
plot(allEffects(Best_Woody_Model), multiline=TRUE, main="")

#Print Effects Plot
tiff("Output/Woody_Model_Effects.tif", width=10, height=5, units="in", res=300, bg="transparent")
plot(allEffects(Best_Woody_Model), multiline=TRUE, main="")
invisible(dev.off())
```

## Forbs

### Percent

#### Model Structure

Models were run using the functions `lm()` and `lmer()` from the R package [lme4](https://cran.r-project.org/web/packages/lme4/lme4.pdf), as the response variable is a percentage.

##### Random Effect Selection

Transect, Zone, and Year are grouping variables that may need to be accounted for as mixed effects when running models. Zone has fewer than five levels so it should not be used as a random effect on its own, however, each Transect is nested within a Zone. To determine the best structure of random effects, possible random effect structures based on the study design were modeled and the model with the best fixed effect structure of the group was selected using the R package [performance](https://cran.r-project.org/web/packages/performance/performance.pdf) function `compare_performance()`.

```{r Forb Random Model Selection, echo=TRUE}
#Run Models
Forb_Percent_Random_Models<-list(
  "Intercept"=lm(Percent_Forb ~ 1, data=Modeling_Variables),
  "Year"=lmer(Percent_Forb ~ (1|Year), data=Modeling_Variables),
  "Transect"=lmer(Percent_Forb ~ (1|Transect), data=Modeling_Variables),
  "Zone/Transect"=lmer(Percent_Forb ~ (1|Zone/Transect), data=Modeling_Variables),
  "Year+Transect"=lmer(Percent_Forb ~ (1|Year) + (1|Transect), data=Modeling_Variables),
  "Year+Zone/Transect"=lmer(Percent_Forb ~ (1|Year) + (1|Zone/Transect), data=Modeling_Variables))

#Compare Models
compare_performance(Forb_Percent_Random_Models, rank=TRUE)
plot(compare_performance(Forb_Percent_Random_Models))

#Clear Unneeded Items
rm(list=c("Forb_Percent_Random_Models"))
```

##### Fixed Effect Selection

Additive model selection was conducted after splitting the predictor variables into two groups: the "Climate" variables "Total Spring Precipitation" and "Date of Last Freeze" and the "Management" predictor variables "Years Since Last Burn" and "Years Since Last Mow".

For all variable groups, all possible fixed effect structures (including models of two-way interactions for the Climate and Management variables) were modeled, and the model with the best fixed effect structure of the group was selected using the R package [performance](https://cran.r-project.org/web/packages/performance/performance.pdf) function `compare_performance()`. To build a final model, all additive combinations of the best fixed effect structures from each group were modeled and the best model was selected.

##### Weather Variables

```{r Forb Weather Model Selection, echo=TRUE}
#Run Models
Forb_Percent_Weather_Models<-list(
  "Random"=lmer(Percent_Forb ~ (1|Year) + (1|Zone/Transect), data=Modeling_Variables),
  "Precip"=lmer(Percent_Forb ~ Total_Spring_Precip + (1|Year) + (1|Zone/Transect), data=Modeling_Variables),
  "Freeze"=lmer(Percent_Forb ~ Last_Freeze + (1|Year) + (1|Zone/Transect), data=Modeling_Variables),
  "Precip+Freeze"=lmer(Percent_Forb ~ Total_Spring_Precip + Last_Freeze + (1|Year) + (1|Zone/Transect), data=Modeling_Variables),
  "Precip*Freeze"=lmer(Percent_Forb ~ Total_Spring_Precip * Last_Freeze + (1|Year) + (1|Zone/Transect), data=Modeling_Variables))

#Compare Models
compare_performance(Forb_Percent_Weather_Models, rank=TRUE)
plot(compare_performance(Forb_Percent_Weather_Models))

#Clear Unneeded Items
rm(list=c("Forb_Percent_Weather_Models"))
```

##### Management Variables

```{r Forb Management Model Selection, echo=TRUE}
#Run Models
Forb_Percent_Manage_Models<-list(
  "Random"=lmer(Percent_Forb ~ (1|Year) + (1|Zone/Transect), data=Modeling_Variables),
  "Burn"=lmer(Percent_Forb ~ Years_Since_Burn + (1|Year) + (1|Zone/Transect), data=Modeling_Variables),
  "Mow"=lmer(Percent_Forb ~ Years_Since_Mow + (1|Year) + (1|Zone/Transect), data=Modeling_Variables),
  "Burn+Mow"=lmer(Percent_Forb ~ Years_Since_Burn + Years_Since_Mow + (1|Year) + (1|Zone/Transect), data=Modeling_Variables),
  "Burn*Mow"=lmer(Percent_Forb ~ Years_Since_Burn * Years_Since_Mow + (1|Year) + (1|Zone/Transect), data=Modeling_Variables))

#Compare Models
compare_performance(Forb_Percent_Manage_Models, rank=TRUE)
plot(compare_performance(Forb_Percent_Manage_Models))

#Clear Unneeded Items
rm(list=c("Forb_Percent_Manage_Models"))
```

##### Combining Variable Groups

```{r Forb Combined Model Selection, echo=TRUE}
#Run Models
Forb_Percent_Combined_Models<-list(
  "Random"=lmer(Percent_Forb ~ (1|Year) + (1|Zone/Transect), data=Modeling_Variables),
  "Precip"=lmer(Percent_Forb ~ Total_Spring_Precip + (1|Year) + (1|Zone/Transect), data=Modeling_Variables),
  "Burn*Mow"=lmer(Percent_Forb ~ Years_Since_Burn * Years_Since_Mow + (1|Year) + (1|Zone/Transect), data=Modeling_Variables),
  "Precip+(Burn*Mow)"=lmer(Percent_Forb ~ Total_Spring_Precip + (Years_Since_Burn * Years_Since_Mow) + (1|Year) + (1|Zone/Transect), data=Modeling_Variables),
  "Precip*(Burn*Mow)"=lmer(Percent_Forb ~ Total_Spring_Precip * (Years_Since_Burn * Years_Since_Mow) + (1|Year) + (1|Zone/Transect), data=Modeling_Variables))

#Compare Models
compare_performance(Forb_Percent_Combined_Models, rank=TRUE)
plot(compare_performance(Forb_Percent_Combined_Models))

#Select Best Model
Best_Forb_Percent_Model<-lmer(Percent_Forb ~ Total_Spring_Precip + (Years_Since_Burn * Years_Since_Mow) + (1|Year) + (1|Zone/Transect), data=Modeling_Variables)

#Clear Unneeded Items
rm(list=c("Forb_Percent_Combined_Models"))
```

### Poisson Count

#### Model Structure

Models were run using the functions `glm()` and `glmer()` from the R package [lme4](https://cran.r-project.org/web/packages/lme4/lme4.pdf) with family=Poisson, as the response variable is a count variable.

##### Random Effect Selection

Transect, Zone, and Year are grouping variables that may need to be accounted for as mixed effects when running models. Zone has fewer than five levels so it should not be used as a random effect on its own, however, each Transect is nested within a Zone. To determine the best structure of random effects, possible random effect structures based on the study design were modeled and the model with the best fixed effect structure of the group was selected using the R package [performance](https://cran.r-project.org/web/packages/performance/performance.pdf) function `compare_performance()`.

```{r Forb Count Random Model Selection, echo=TRUE}
#Run Models
Forb_Count_P_Random_Models<-list(
  "Intercept"=glm(Forb_Count ~ 1, data=Modeling_Variables, family=poisson),
  "Year"=glmer(Forb_Count ~ (1|Year), data=Modeling_Variables, family=poisson),
  "Transect"=glmer(Forb_Count ~ (1|Transect), data=Modeling_Variables, family=poisson),
  "Zone/Transect"=glmer(Forb_Count ~ (1|Zone/Transect), data=Modeling_Variables, family=poisson),
  "Year+Transect"=glmer(Forb_Count ~ (1|Year) + (1|Transect), data=Modeling_Variables, family=poisson),
  "Year+Zone/Transect"=glmer(Forb_Count ~ (1|Year) + (1|Zone/Transect), data=Modeling_Variables, family=poisson))

#Compare Models
compare_performance(Forb_Count_P_Random_Models, rank=TRUE)
plot(compare_performance(Forb_Count_P_Random_Models))

#Clear Unneeded Items
rm(list=c("Forb_Count_P_Random_Models"))
```

##### Fixed Effect Selection

Additive model selection was conducted after splitting the predictor variables into two groups: the "Climate" variables "Total Spring Precipitation" and "Date of Last Freeze" and the "Management" predictor variables "Years Since Last Burn" and "Years Since Last Mow".

For all variable groups, all possible fixed effect structures (including models of two-way interactions for the Climate and Management variables) were modeled, and the model with the best fixed effect structure of the group was selected using the R package [performance](https://cran.r-project.org/web/packages/performance/performance.pdf) function `compare_performance()`. To build a final model, all additive combinations of the best fixed effect structures from each group were modeled and the best model was selected.

##### Weather Variables

```{r Forb Count Weather Model Selection, echo=TRUE}
#Run Models
Forb_Count_P_Weather_Models<-list(
  "Random"=glmer(Forb_Count ~ (1|Year) + (1|Zone/Transect), data=Modeling_Variables, family=poisson),
  "Precip"=glmer(Forb_Count ~ Total_Spring_Precip + (1|Year) + (1|Zone/Transect), data=Modeling_Variables, family=poisson),
  "Freeze"=glmer(Forb_Count ~ Last_Freeze + (1|Year) + (1|Zone/Transect), data=Modeling_Variables, family=poisson),
  "Precip+Freeze"=glmer(Forb_Count ~ Total_Spring_Precip + Last_Freeze + (1|Year) + (1|Zone/Transect), data=Modeling_Variables, family=poisson),
  "Precip*Freeze"=glmer(Forb_Count ~ Total_Spring_Precip * Last_Freeze + (1|Year) + (1|Zone/Transect), data=Modeling_Variables, family=poisson))

#Compare Models
compare_performance(Forb_Count_P_Weather_Models, rank=TRUE)
plot(compare_performance(Forb_Count_P_Weather_Models))

#Clear Unneeded Items
rm(list=c("Forb_Count_P_Weather_Models"))
```

##### Management Variables

```{r Forb Count Management Model Selection, echo=TRUE}
#Run Models
Forb_Count_P_Manage_Models<-list(
  "Random"=glmer(Forb_Count ~ (1|Year) + (1|Zone/Transect), data=Modeling_Variables, family=poisson),
  "Burn"=glmer(Forb_Count ~ Years_Since_Burn + (1|Year) + (1|Zone/Transect), data=Modeling_Variables, family=poisson),
  "Mow"=glmer(Forb_Count ~ Years_Since_Mow + (1|Year) + (1|Zone/Transect), data=Modeling_Variables, family=poisson),
  "Burn+Mow"=glmer(Forb_Count ~ Years_Since_Burn + Years_Since_Mow + (1|Year) + (1|Zone/Transect), data=Modeling_Variables, family=poisson),
  "Burn*Mow"=glmer(Forb_Count ~ Years_Since_Burn * Years_Since_Mow + (1|Year) + (1|Zone/Transect), data=Modeling_Variables, family=poisson))

#Compare Models
compare_performance(Forb_Count_P_Manage_Models, rank=TRUE)
plot(compare_performance(Forb_Count_P_Manage_Models))

#Clear Unneeded Items
rm(list=c("Forb_Count_P_Manage_Models"))
```

##### Combining Variable Groups

```{r Forb Count Combined Model Selection, echo=TRUE}
#Run Models
Forb_Count_P_Combined_Models<-list(
  "Random"=glmer(Forb_Count ~ (1|Year) + (1|Zone/Transect), data=Modeling_Variables, family=poisson),
  "Precip"=glmer(Forb_Count ~ Total_Spring_Precip + (1|Year) + (1|Zone/Transect), data=Modeling_Variables, family=poisson),
  "Burn+Mow"=glmer(Forb_Count ~ Years_Since_Burn + Years_Since_Mow + (1|Year) + (1|Zone/Transect), data=Modeling_Variables, family=poisson),
  "Precip+(Burn+Mow)"=glmer(Forb_Count ~ Total_Spring_Precip + (Years_Since_Burn + Years_Since_Mow) + (1|Year) + (1|Zone/Transect), data=Modeling_Variables, family=poisson),
  "Precip*(Burn+Mow)"=glmer(Forb_Count ~ Total_Spring_Precip * (Years_Since_Burn + Years_Since_Mow) + (1|Year) + (1|Zone/Transect), data=Modeling_Variables, family=poisson))

#Compare Models
compare_performance(Forb_Count_P_Combined_Models, rank=TRUE)
plot(compare_performance(Forb_Count_P_Combined_Models))

#Select Best Model
Best_Forb_Count_P_Model<-glmer(Forb_Count ~ Total_Spring_Precip + (Years_Since_Burn + Years_Since_Mow) + (1|Year) + (1|Zone/Transect), data=Modeling_Variables, family=poisson)

#Clear Unneeded Items
rm(list=c("Forb_Count_P_Combined_Models"))
```

### Negative Binomial Count

#### Model Structure

Models were run using the functions `glm.nb()` and `glmer.nb()` from the R package [MASS](https://cran.r-project.org/web/packages/MASS/MASS.pdf), as the response variable is a count variable.

##### Random Effect Selection

Transect, Zone, and Year are grouping variables that may need to be accounted for as mixed effects when running models. Zone has fewer than five levels so it should not be used as a random effect on its own, however, each Transect is nested within a Zone. To determine the best structure of random effects, possible random effect structures based on the study design were modeled and the model with the best fixed effect structure of the group was selected using the R package [performance](https://cran.r-project.org/web/packages/performance/performance.pdf) function `compare_performance()`.

```{r Forb NB Count Random Model Selection, echo=TRUE}
#Run Models
Forb_Count_NB_Random_Models<-list(
  "Intercept"=glm.nb(Forb_Count ~ 1, data=Modeling_Variables),
  "Year"=glmer.nb(Forb_Count ~ (1|Year), data=Modeling_Variables),
  "Transect"=glmer.nb(Forb_Count ~ (1|Transect), data=Modeling_Variables),
  "Zone/Transect"=glmer.nb(Forb_Count ~ (1|Zone/Transect), data=Modeling_Variables),
  "Year+Transect"=glmer.nb(Forb_Count ~ (1|Year) + (1|Transect), data=Modeling_Variables),
  "Year+Zone/Transect"=glmer.nb(Forb_Count ~ (1|Year) + (1|Zone/Transect), data=Modeling_Variables))

#Compare Models
compare_performance(Forb_Count_NB_Random_Models, rank=TRUE)
plot(compare_performance(Forb_Count_NB_Random_Models))

#Clear Unneeded Items
rm(list=c("Forb_Count_NB_Random_Models"))
```

##### Fixed Effect Selection

Additive model selection was conducted after splitting the predictor variables into two groups: the "Climate" variables "Total Spring Precipitation" and "Date of Last Freeze" and the "Management" predictor variables "Years Since Last Burn" and "Years Since Last Mow".

For all variable groups, all possible fixed effect structures (including models of two-way interactions for the Climate and Management variables) were modeled, and the model with the best fixed effect structure of the group was selected using the R package [performance](https://cran.r-project.org/web/packages/performance/performance.pdf) function `compare_performance()`. To build a final model, all additive combinations of the best fixed effect structures from each group were modeled and the best model was selected.

##### Weather Variables

```{r Forb NB Count Weather Model Selection, echo=TRUE}
#Run Models
Forb_Count_NB_Weather_Models<-list(
  "Random"=glmer.nb(Forb_Count ~ (1|Year) + (1|Zone/Transect), data=Modeling_Variables),
  "Precip"=glmer.nb(Forb_Count ~ Total_Spring_Precip + (1|Year) + (1|Zone/Transect), data=Modeling_Variables),
  "Freeze"=glmer.nb(Forb_Count ~ Last_Freeze + (1|Year) + (1|Zone/Transect), data=Modeling_Variables),
  "Precip+Freeze"=glmer.nb(Forb_Count ~ Total_Spring_Precip + Last_Freeze + (1|Year) + (1|Zone/Transect), data=Modeling_Variables),
  "Precip*Freeze"=glmer.nb(Forb_Count ~ Total_Spring_Precip * Last_Freeze + (1|Year) + (1|Zone/Transect), data=Modeling_Variables))

#Compare Models
compare_performance(Forb_Count_NB_Weather_Models, rank=TRUE)
plot(compare_performance(Forb_Count_NB_Weather_Models))

#Clear Unneeded Items
rm(list=c("Forb_Count_NB_Weather_Models"))
```

##### Management Variables

```{r Forb NB Count Management Model Selection, echo=TRUE}
#Run Models
Forb_Count_NB_Manage_Models<-list(
  "Random"=glmer.nb(Forb_Count ~ (1|Year) + (1|Zone/Transect), data=Modeling_Variables),
  "Burn"=glmer.nb(Forb_Count ~ Years_Since_Burn + (1|Year) + (1|Zone/Transect), data=Modeling_Variables),
  "Mow"=glmer.nb(Forb_Count ~ Years_Since_Mow + (1|Year) + (1|Zone/Transect), data=Modeling_Variables),
  "Burn+Mow"=glmer.nb(Forb_Count ~ Years_Since_Burn + Years_Since_Mow + (1|Year) + (1|Zone/Transect), data=Modeling_Variables),
  "Burn*Mow"=glmer.nb(Forb_Count ~ Years_Since_Burn * Years_Since_Mow + (1|Year) + (1|Zone/Transect), data=Modeling_Variables))

#Compare Models
compare_performance(Forb_Count_NB_Manage_Models, rank=TRUE)
plot(compare_performance(Forb_Count_NB_Manage_Models))

#Clear Unneeded Items
rm(list=c("Forb_Count_NB_Manage_Models"))
```

##### Combining Variable Groups

```{r Forb NB Count Combined Model Selection, echo=TRUE}
#Run Models
Forb_Count_NB_Combined_Models<-list(
  "Random"=glmer.nb(Forb_Count ~ (1|Year) + (1|Zone/Transect), data=Modeling_Variables),
  "Precip"=glmer.nb(Forb_Count ~ Total_Spring_Precip + (1|Year) + (1|Zone/Transect), data=Modeling_Variables),
  "Burn"=glmer.nb(Forb_Count ~ Years_Since_Burn + (1|Year) + (1|Zone/Transect), data=Modeling_Variables),
  "Precip+Burn"=glmer.nb(Forb_Count ~ Total_Spring_Precip + Years_Since_Burn + (1|Year) + (1|Zone/Transect), data=Modeling_Variables),
  "Precip*Burn"=glmer.nb(Forb_Count ~ Total_Spring_Precip * Years_Since_Burn + (1|Year) + (1|Zone/Transect), data=Modeling_Variables))

#Compare Models
compare_performance(Forb_Count_NB_Combined_Models, rank=TRUE)
plot(compare_performance(Forb_Count_NB_Combined_Models))

#Select Best Model
Best_Forb_Count_NB_Model<-glmer.nb(Forb_Count ~ Total_Spring_Precip + Years_Since_Burn + (1|Year) + (1|Zone/Transect), data=Modeling_Variables)

#Clear Unneeded Items
rm(list=c("Forb_Count_NB_Combined_Models"))
```

### Binomial Proportion

#### Model Structure

Models were run using the functions `glm()` and `glmer()` from the R package [lme4](https://cran.r-project.org/web/packages/lme4/lme4.pdf) with family=Binomial, as the response variable is a proportion.

##### Random Effect Selection

Transect, Zone, and Year are grouping variables that may need to be accounted for as mixed effects when running models. Zone has fewer than five levels so it should not be used as a random effect on its own, however, each Transect is nested within a Zone. To determine the best structure of random effects, possible random effect structures based on the study design were modeled and the model with the best fixed effect structure of the group was selected using the R package [performance](https://cran.r-project.org/web/packages/performance/performance.pdf) function `compare_performance()`.

```{r Forb Binomial Proportion Random Model Selection, echo=TRUE}
#Run Models
Forb_Binom_Prop_Random_Models<-list(
  "Intercept"=glm(cbind(Forb_Count, Total_Count-Forb_Count) ~ 1, data=Modeling_Variables, family=binomial),
  "Year"=glmer(cbind(Forb_Count, Total_Count-Forb_Count) ~ (1|Year), data=Modeling_Variables, family=binomial),
  "Transect"=glmer(cbind(Forb_Count, Total_Count-Forb_Count) ~ (1|Transect), data=Modeling_Variables, family=binomial),
  "Zone/Transect"=glmer(cbind(Forb_Count, Total_Count-Forb_Count) ~ (1|Zone/Transect), data=Modeling_Variables, family=binomial),
  "Year+Transect"=glmer(cbind(Forb_Count, Total_Count-Forb_Count) ~ (1|Year) + (1|Transect), data=Modeling_Variables, family=binomial),
  "Year+Zone/Transect"=glmer(cbind(Forb_Count, Total_Count-Forb_Count) ~ (1|Year) + (1|Zone/Transect), data=Modeling_Variables, family=binomial))

#Compare Models
compare_performance(Forb_Binom_Prop_Random_Models, rank=TRUE)
plot(compare_performance(Forb_Binom_Prop_Random_Models))

#Clear Unneeded Items
rm(list=c("Forb_Binom_Prop_Random_Models"))
```

##### Fixed Effect Selection

Additive model selection was conducted after splitting the predictor variables into two groups: the "Climate" variables "Total Spring Precipitation" and "Date of Last Freeze" and the "Management" predictor variables "Years Since Last Burn" and "Years Since Last Mow".

For all variable groups, all possible fixed effect structures (including models of two-way interactions for the Climate and Management variables) were modeled, and the model with the best fixed effect structure of the group was selected using the R package [performance](https://cran.r-project.org/web/packages/performance/performance.pdf) function `compare_performance()`. To build a final model, all additive combinations of the best fixed effect structures from each group were modeled and the best model was selected.

##### Weather Variables

```{r Forb Binomial Proportion Weather Model Selection, echo=TRUE}
#Run Models
Forb_Binom_Prop_Weather_Models<-list(
  "Random"=glmer(cbind(Forb_Count, Total_Count-Forb_Count) ~ (1|Year) + (1|Zone/Transect), data=Modeling_Variables, family=binomial),
  "Precip"=glmer(cbind(Forb_Count, Total_Count-Forb_Count) ~ Total_Spring_Precip + (1|Year) + (1|Zone/Transect), data=Modeling_Variables, family=binomial),
  "Freeze"=glmer(cbind(Forb_Count, Total_Count-Forb_Count) ~ Last_Freeze + (1|Year) + (1|Zone/Transect), data=Modeling_Variables, family=binomial),
  "Precip+Freeze"=glmer(cbind(Forb_Count, Total_Count-Forb_Count) ~ Total_Spring_Precip + Last_Freeze + (1|Year) + (1|Zone/Transect), data=Modeling_Variables, family=binomial),
  "Precip*Freeze"=glmer(cbind(Forb_Count, Total_Count-Forb_Count) ~ Total_Spring_Precip * Last_Freeze + (1|Year) + (1|Zone/Transect), data=Modeling_Variables, family=binomial))

#Compare Models
compare_performance(Forb_Binom_Prop_Weather_Models, rank=TRUE)
plot(compare_performance(Forb_Binom_Prop_Weather_Models))

#Clear Unneeded Items
rm(list=c("Forb_Binom_Prop_Weather_Models"))
```

##### Management Variables

```{r Forb Binomial Proportion Management Model Selection, echo=TRUE}
#Run Models
Forb_Binom_Prop_Manage_Models<-list(
  "Random"=glmer(cbind(Forb_Count, Total_Count-Forb_Count) ~ (1|Year) + (1|Zone/Transect), data=Modeling_Variables, family=binomial),
  "Burn"=glmer(cbind(Forb_Count, Total_Count-Forb_Count) ~ Years_Since_Burn + (1|Year) + (1|Zone/Transect), data=Modeling_Variables, family=binomial),
  "Mow"=glmer(cbind(Forb_Count, Total_Count-Forb_Count) ~ Years_Since_Mow + (1|Year) + (1|Zone/Transect), data=Modeling_Variables, family=binomial),
  "Burn+Mow"=glmer(cbind(Forb_Count, Total_Count-Forb_Count) ~ Years_Since_Burn + Years_Since_Mow + (1|Year) + (1|Zone/Transect), data=Modeling_Variables, family=binomial),
  "Burn*Mow"=glmer(cbind(Forb_Count, Total_Count-Forb_Count) ~ Years_Since_Burn * Years_Since_Mow + (1|Year) + (1|Zone/Transect), data=Modeling_Variables, family=binomial))

#Compare Models
compare_performance(Forb_Binom_Prop_Manage_Models, rank=TRUE)
plot(compare_performance(Forb_Binom_Prop_Manage_Models))

#Clear Unneeded Items
rm(list=c("Forb_Binom_Prop_Manage_Models"))
```

##### Combining Variable Groups

```{r Forb Binomial Proportion Combined Model Selection, echo=TRUE}
#Run Models
Forb_Binom_Prop_Combined_Models<-list(
  "Random"=glmer(cbind(Forb_Count, Total_Count-Forb_Count) ~ (1|Year) + (1|Zone/Transect), data=Modeling_Variables, family=binomial),
  "Precip"=glmer(cbind(Forb_Count, Total_Count-Forb_Count) ~ Total_Spring_Precip + (1|Year) + (1|Zone/Transect), data=Modeling_Variables, family=binomial),
  "Burn*Mow"=glmer(cbind(Forb_Count, Total_Count-Forb_Count) ~ Years_Since_Burn * Years_Since_Mow + (1|Year) + (1|Zone/Transect), data=Modeling_Variables, family=binomial),
  "Precip+(Burn*Mow)"=glmer(cbind(Forb_Count, Total_Count-Forb_Count) ~ Total_Spring_Precip + (Years_Since_Burn * Years_Since_Mow) + (1|Year) + (1|Zone/Transect), data=Modeling_Variables, family=binomial),
  "Precip*(Burn*Mow)"=glmer(cbind(Forb_Count, Total_Count-Forb_Count) ~ Total_Spring_Precip * (Years_Since_Burn * Years_Since_Mow) + (1|Year) + (1|Zone/Transect), data=Modeling_Variables, family=binomial))

#Compare Models
compare_performance(Forb_Binom_Prop_Combined_Models, rank=TRUE)
plot(compare_performance(Forb_Binom_Prop_Combined_Models))

#Select Best Model
Best_Forb_Binom_Prop_Model<-glmer(cbind(Forb_Count, Total_Count-Forb_Count) ~ Total_Spring_Precip + (Years_Since_Burn * Years_Since_Mow) + (1|Year) + (1|Zone/Transect), data=Modeling_Variables, family=binomial)

#Clear Unneeded Items
rm(list=c("Forb_Binom_Prop_Combined_Models"))
```

### Overall Best Forb Model

#### Model Selection

```{r Best Overall Forb Model, echo=TRUE}
#Run Models
Forb_All_Models<-list(
  "Linear Percentage"=Best_Forb_Percent_Model, 
  "Poisson Count"=Best_Forb_Count_P_Model,
  "Negative Binomial Count"=Best_Forb_Count_NB_Model,
  "Binomial Proportion"=Best_Forb_Binom_Prop_Model)

#Compare Models
compare_performance(Forb_All_Models, rank=TRUE)
plot(compare_performance(Forb_All_Models))
```

#### Model Summary

```{r Overall Best Forb Model}
#Select Best Model
Best_Forb_Model<-Best_Forb_Percent_Model

#Model Summary
summary(Best_Forb_Model)
model_performance(Best_Forb_Model)

#Fancy Model Table
tab_model(Best_Forb_Model, dv.labels="Percent Forbs")

#Best Model Report
report(Best_Forb_Model)

#Clear Unneeded Items
rm(list=c("Forb_All_Models", "Best_Forb_Percent_Model", "Best_Forb_Count_P_Model", "Best_Forb_Count_NB_Model", "Best_Forb_Binom_Prop_Model"))
```

#### Model Diagnostics

```{r Best Forb Model Diagnostics}
#Diagnostic Tests
plot(simulateResiduals(fittedModel=Best_Forb_Model), title="Percent Forbs")

#Save DHARMa Plot
tiff("Output/Forb_DHARMa.tif", width=8, height=4, units="in", res=300)
plot(simulateResiduals(fittedModel=Best_Forb_Model), title="B Percent Forbs")
invisible(dev.off())
```

#### Effect Plots

```{r Best Forb Model Effects Plots}
#Fixed Effects Coefficients Plot
Forb_Effects<-plot(parameters(Best_Forb_Model, effects="fixed")) +
  annotate("text", x=c(-3.88,-0.94), y=c(3.1,2.1), color=c("#E15241", "#E15241"), label=c("***","*"), size=8)
Forb_Effects

#Effects Plot
plot(allEffects(Best_Forb_Model), main="", lines=list(multiline=TRUE), ci.style="bars")

#Print Effects Plot
tiff("Output/Forb_Model_Effects.tif", width=10, height=5, units="in", res=300, bg="transparent")
plot(allEffects(Best_Forb_Model), main="", lines=list(multiline=TRUE), ci.style="bars")
invisible(dev.off())
```

## Graminoids

### Percent

#### Model Structure

Models were run using the functions `lm()` and `lmer()` from the R package [lme4](https://cran.r-project.org/web/packages/lme4/lme4.pdf), as the response variable is a percentage.

##### Random Effect Selection

Transect, Zone, and Year are grouping variables that may need to be accounted for as mixed effects when running models. Zone has fewer than five levels so it should not be used as a random effect on its own, however, each Transect is nested within a Zone. To determine the best structure of random effects, possible random effect structures based on the study design were modeled and the model with the best fixed effect structure of the group was selected using the R package [performance](https://cran.r-project.org/web/packages/performance/performance.pdf) function `compare_performance()`.

```{r Graminoid Random Model Selection, echo=TRUE}
#Run Models
Graminoid_Percent_Random_Models<-list(
  "Intercept"=lm(Percent_Graminoid ~ 1, data=Modeling_Variables),
  "Year"=lmer(Percent_Graminoid ~ (1|Year), data=Modeling_Variables),
  "Transect"=lmer(Percent_Graminoid ~ (1|Transect), data=Modeling_Variables),
  "Zone/Transect"=lmer(Percent_Graminoid ~ (1|Zone/Transect), data=Modeling_Variables),
  "Year+Transect"=lmer(Percent_Graminoid ~ (1|Year) + (1|Transect), data=Modeling_Variables),
  "Year+Zone/Transect"=lmer(Percent_Graminoid ~ (1|Year) + (1|Zone/Transect), data=Modeling_Variables))

#Compare Models
compare_performance(Graminoid_Percent_Random_Models, rank=TRUE)
plot(compare_performance(Graminoid_Percent_Random_Models))

#Clear Unneeded Items
rm(list=c("Graminoid_Percent_Random_Models"))
```

##### Fixed Effect Selection

Additive model selection was conducted after splitting the predictor variables into two groups: the "Climate" variables "Total Spring Precipitation" and "Date of Last Freeze" and the "Management" predictor variables "Years Since Last Burn" and "Years Since Last Mow".

For all variable groups, all possible fixed effect structures (including models of two-way interactions for the Climate and Management variables) were modeled, and the model with the best fixed effect structure of the group was selected using the R package [performance](https://cran.r-project.org/web/packages/performance/performance.pdf) function `compare_performance()`. To build a final model, all additive combinations of the best fixed effect structures from each group were modeled and the best model was selected.

##### Weather Variables

```{r Graminoid Weather Model Selection, echo=TRUE}
#Run Models
Graminoid_Percent_Weather_Models<-list(
  "Random"=lmer(Percent_Graminoid ~ (1|Year) + (1|Transect), data=Modeling_Variables),
  "Precip"=lmer(Percent_Graminoid ~ Total_Spring_Precip + (1|Year) + (1|Transect), data=Modeling_Variables),
  "Freeze"=lmer(Percent_Graminoid ~ Last_Freeze + (1|Year) + (1|Transect), data=Modeling_Variables),
  "Precip+Freeze"=lmer(Percent_Graminoid ~ Total_Spring_Precip + Last_Freeze + (1|Year) + (1|Transect), data=Modeling_Variables),
  "Precip*Freeze"=lmer(Percent_Graminoid ~ Total_Spring_Precip * Last_Freeze + (1|Year) + (1|Transect), data=Modeling_Variables))

#Compare Models
compare_performance(Graminoid_Percent_Weather_Models, rank=TRUE)
plot(compare_performance(Graminoid_Percent_Weather_Models))

#Clear Unneeded Items
rm(list=c("Graminoid_Percent_Weather_Models"))
```

##### Management Variables

```{r Graminoid Management Model Selection, echo=TRUE}
#Run Models
Graminoid_Percent_Manage_Models<-list(
  "Random"=lmer(Percent_Graminoid ~ (1|Year) + (1|Transect), data=Modeling_Variables),
  "Burn"=lmer(Percent_Graminoid ~ Years_Since_Burn + (1|Year) + (1|Transect), data=Modeling_Variables),
  "Mow"=lmer(Percent_Graminoid ~ Years_Since_Mow + (1|Year) + (1|Transect), data=Modeling_Variables),
  "Burn+Mow"=lmer(Percent_Graminoid ~ Years_Since_Burn + Years_Since_Mow + (1|Year) + (1|Transect), data=Modeling_Variables),
  "Burn*Mow"=lmer(Percent_Graminoid ~ Years_Since_Burn * Years_Since_Mow + (1|Year) + (1|Transect), data=Modeling_Variables))

#Compare Models
compare_performance(Graminoid_Percent_Manage_Models, rank=TRUE)
plot(compare_performance(Graminoid_Percent_Manage_Models))

#Clear Unneeded Items
rm(list=c("Graminoid_Percent_Manage_Models"))
```

##### Combining Variable Groups

```{r Graminoid Combined Model Selection, echo=TRUE}
#Run Models
Graminoid_Percent_Combined_Models<-list(
  "Random"=lmer(Percent_Graminoid ~ (1|Year) + (1|Transect), data=Modeling_Variables),
  "Precip+Freeze"=lmer(Percent_Graminoid ~ Total_Spring_Precip + Last_Freeze + (1|Year) + (1|Transect), data=Modeling_Variables),
  "Burn+Mow"=lmer(Percent_Graminoid ~ Years_Since_Burn + Years_Since_Mow + (1|Year) + (1|Transect), data=Modeling_Variables),
  "(Precip+Freeze)+(Burn+Mow)"=lmer(Percent_Graminoid ~ (Total_Spring_Precip + Last_Freeze) + (Years_Since_Burn + Years_Since_Mow) + (1|Year) + (1|Transect), data=Modeling_Variables),
  "(Precip+Freeze)*(Burn+Mow)"=lmer(Percent_Graminoid ~ (Total_Spring_Precip + Last_Freeze) * (Years_Since_Burn + Years_Since_Mow) + (1|Year) + (1|Transect), data=Modeling_Variables))

#Compare Models
compare_performance(Graminoid_Percent_Combined_Models, rank=TRUE)
plot(compare_performance(Graminoid_Percent_Combined_Models))

#Select Best Model
Best_Graminoid_Percent_Model<-lmer(Percent_Graminoid ~ (Total_Spring_Precip + Last_Freeze) + (Years_Since_Burn + Years_Since_Mow) + (1|Year) + (1|Transect), data=Modeling_Variables)

#Clear Unneeded Items
rm(list=c("Graminoid_Percent_Combined_Models"))
```

### Poisson Count

#### Model Structure

Models were run using the functions `glm()` and `glmer()` from the R package [lme4](https://cran.r-project.org/web/packages/lme4/lme4.pdf) with family=Poisson, as the response variable is a count variable.

##### Random Effect Selection

Transect, Zone, and Year are grouping variables that may need to be accounted for as mixed effects when running models. Zone has fewer than five levels so it should not be used as a random effect on its own, however, each Transect is nested within a Zone. To determine the best structure of random effects, possible random effect structures based on the study design were modeled and the model with the best fixed effect structure of the group was selected using the R package [performance](https://cran.r-project.org/web/packages/performance/performance.pdf) function `compare_performance()`.

```{r Graminoid Count Random Model Selection, echo=TRUE}
#Run Models
Graminoid_Count_P_Random_Models<-list(
  "Intercept"=glm(Graminoid_Count ~ 1, data=Modeling_Variables, family=poisson),
  "Year"=glmer(Graminoid_Count ~ (1|Year), data=Modeling_Variables, family=poisson),
  "Transect"=glmer(Graminoid_Count ~ (1|Transect), data=Modeling_Variables, family=poisson),
  "Zone/Transect"=glmer(Graminoid_Count ~ (1|Zone/Transect), data=Modeling_Variables, family=poisson),
  "Year+Transect"=glmer(Graminoid_Count ~ (1|Year) + (1|Transect), data=Modeling_Variables, family=poisson),
  "Year+Zone/Transect"=glmer(Graminoid_Count ~ (1|Year) + (1|Zone/Transect), data=Modeling_Variables, family=poisson))

#Compare Models
compare_performance(Graminoid_Count_P_Random_Models, rank=TRUE)
plot(compare_performance(Graminoid_Count_P_Random_Models))

#Clear Unneeded Items
rm(list=c("Graminoid_Count_P_Random_Models"))
```

##### Fixed Effect Selection

Additive model selection was conducted after splitting the predictor variables into two groups: the "Climate" variables "Total Spring Precipitation" and "Date of Last Freeze" and the "Management" predictor variables "Years Since Last Burn" and "Years Since Last Mow".

For all variable groups, all possible fixed effect structures (including models of two-way interactions for the Climate and Management variables) were modeled, and the model with the best fixed effect structure of the group was selected using the R package [performance](https://cran.r-project.org/web/packages/performance/performance.pdf) function `compare_performance()`. To build a final model, all additive combinations of the best fixed effect structures from each group were modeled and the best model was selected.

##### Weather Variables

```{r Graminoid Count Weather Model Selection, echo=TRUE}
#Run Models
Graminoid_Count_P_Weather_Models<-list(
  "Random"=glmer(Graminoid_Count ~ (1|Year) + (1|Zone/Transect), data=Modeling_Variables, family=poisson),
  "Precip"=glmer(Graminoid_Count ~ Total_Spring_Precip + (1|Year) + (1|Zone/Transect), data=Modeling_Variables, family=poisson),
  "Freeze"=glmer(Graminoid_Count ~ Last_Freeze + (1|Year) + (1|Zone/Transect), data=Modeling_Variables, family=poisson),
  "Precip+Freeze"=glmer(Graminoid_Count ~ Total_Spring_Precip + Last_Freeze + (1|Year) + (1|Zone/Transect), data=Modeling_Variables, family=poisson),
  "Precip*Freeze"=glmer(Graminoid_Count ~ Total_Spring_Precip * Last_Freeze + (1|Year) + (1|Zone/Transect), data=Modeling_Variables, family=poisson))

#Compare Models
compare_performance(Graminoid_Count_P_Weather_Models, rank=TRUE)
plot(compare_performance(Graminoid_Count_P_Weather_Models))

#Clear Unneeded Items
rm(list=c("Graminoid_Count_P_Weather_Models"))
```

##### Management Variables

```{r Graminoid Count Management Model Selection, echo=TRUE}
#Run Models
Graminoid_Count_P_Manage_Models<-list(
  "Random"=glmer(Graminoid_Count ~ (1|Year) + (1|Zone/Transect), data=Modeling_Variables, family=poisson),
  "Burn"=glmer(Graminoid_Count ~ Years_Since_Burn + (1|Year) + (1|Zone/Transect), data=Modeling_Variables, family=poisson),
  "Mow"=glmer(Graminoid_Count ~ Years_Since_Mow + (1|Year) + (1|Zone/Transect), data=Modeling_Variables, family=poisson),
  "Burn+Mow"=glmer(Graminoid_Count ~ Years_Since_Burn + Years_Since_Mow + (1|Year) + (1|Zone/Transect), data=Modeling_Variables, family=poisson),
  "Burn*Mow"=glmer(Graminoid_Count ~ Years_Since_Burn * Years_Since_Mow + (1|Year) + (1|Zone/Transect), data=Modeling_Variables, family=poisson))

#Compare Models
compare_performance(Graminoid_Count_P_Manage_Models, rank=TRUE)
plot(compare_performance(Graminoid_Count_P_Manage_Models))

#Clear Unneeded Items
rm(list=c("Graminoid_Count_P_Manage_Models"))
```

##### Combining Variable Groups

```{r Graminoid Count Combined Model Selection, echo=TRUE}
#Run Models
Graminoid_Count_P_Combined_Models<-list(
  "Random"=glmer(Graminoid_Count ~ (1|Year) + (1|Zone/Transect), data=Modeling_Variables, family=poisson),
  "Precip"=glmer(Graminoid_Count ~ Total_Spring_Precip + (1|Year) + (1|Zone/Transect), data=Modeling_Variables, family=poisson),
  "Mow"=glmer(Graminoid_Count ~ Years_Since_Mow + (1|Year) + (1|Zone/Transect), data=Modeling_Variables, family=poisson),
  "Precip+Mow"=glmer(Graminoid_Count ~ Total_Spring_Precip + Years_Since_Mow + (1|Year) + (1|Zone/Transect), data=Modeling_Variables, family=poisson),
  "Precip*Mow"=glmer(Graminoid_Count ~ Total_Spring_Precip * Years_Since_Mow + (1|Year) + (1|Zone/Transect), data=Modeling_Variables, family=poisson))

#Compare Models
compare_performance(Graminoid_Count_P_Combined_Models, rank=TRUE)
plot(compare_performance(Graminoid_Count_P_Combined_Models))

#Select Best Model
Best_Graminoid_Count_P_Model<-glmer(Graminoid_Count ~ Total_Spring_Precip + Years_Since_Mow + (1|Year) + (1|Zone/Transect), data=Modeling_Variables, family=poisson)

#Clear Unneeded Items
rm(list=c("Graminoid_Count_P_Combined_Models"))
```

### Negative Binomial Count

#### Model Structure

Models were run using the functions `glm.nb()` and `glmer.nb()` from the R package [MASS](https://cran.r-project.org/web/packages/MASS/MASS.pdf), as the response variable is a count variable.

##### Random Effect Selection

Transect, Zone, and Year are grouping variables that may need to be accounted for as mixed effects when running models. Zone has fewer than five levels so it should not be used as a random effect on its own, however, each Transect is nested within a Zone. To determine the best structure of random effects, possible random effect structures based on the study design were modeled and the model with the best fixed effect structure of the group was selected using the R package [performance](https://cran.r-project.org/web/packages/performance/performance.pdf) function `compare_performance()`.

```{r Graminoid NB Count Random Model Selection, echo=TRUE}
#Run Models
Graminoid_Count_NB_Random_Models<-list(
  "Intercept"=glm.nb(Graminoid_Count ~ 1, data=Modeling_Variables),
  "Year"=glmer.nb(Graminoid_Count ~ (1|Year), data=Modeling_Variables),
  "Transect"=glmer.nb(Graminoid_Count ~ (1|Transect), data=Modeling_Variables),
  "Zone/Transect"=glmer.nb(Graminoid_Count ~ (1|Zone/Transect), data=Modeling_Variables),
  "Year+Transect"=glmer.nb(Graminoid_Count ~ (1|Year) + (1|Transect), data=Modeling_Variables),
  "Year+Zone/Transect"=glmer.nb(Graminoid_Count ~ (1|Year) + (1|Zone/Transect), data=Modeling_Variables))

#Compare Models
compare_performance(Graminoid_Count_NB_Random_Models, rank=TRUE)
plot(compare_performance(Graminoid_Count_NB_Random_Models))

#Clear Unneeded Items
rm(list=c("Graminoid_Count_NB_Random_Models"))
```

##### Fixed Effect Selection

Additive model selection was conducted after splitting the predictor variables into two groups: the "Climate" variables "Total Spring Precipitation" and "Date of Last Freeze" and the "Management" predictor variables "Years Since Last Burn" and "Years Since Last Mow".

For all variable groups, all possible fixed effect structures (including models of two-way interactions for the Climate and Management variables) were modeled, and the model with the best fixed effect structure of the group was selected using the R package [performance](https://cran.r-project.org/web/packages/performance/performance.pdf) function `compare_performance()`. To build a final model, all additive combinations of the best fixed effect structures from each group were modeled and the best model was selected.

##### Weather Variables

```{r Graminoid NB Count Weather Model Selection, echo=TRUE}
#Run Models
Graminoid_Count_NB_Weather_Models<-list(
  "Random"=glmer.nb(Graminoid_Count ~ (1|Year) + (1|Zone/Transect), data=Modeling_Variables),
  "Precip"=glmer.nb(Graminoid_Count ~ Total_Spring_Precip + (1|Year) + (1|Zone/Transect), data=Modeling_Variables),
  "Freeze"=glmer.nb(Graminoid_Count ~ Last_Freeze + (1|Year) + (1|Zone/Transect), data=Modeling_Variables),
  "Precip+Freeze"=glmer.nb(Graminoid_Count ~ Total_Spring_Precip + Last_Freeze + (1|Year) + (1|Zone/Transect), data=Modeling_Variables),
  "Precip*Freeze"=glmer.nb(Graminoid_Count ~ Total_Spring_Precip * Last_Freeze + (1|Year) + (1|Zone/Transect), data=Modeling_Variables))

#Compare Models
compare_performance(Graminoid_Count_NB_Weather_Models, rank=TRUE)
plot(compare_performance(Graminoid_Count_NB_Weather_Models))

#Clear Unneeded Items
rm(list=c("Graminoid_Count_NB_Weather_Models"))
```

##### Management Variables

```{r Graminoid NB Count Management Model Selection, echo=TRUE}
#Run Models
Graminoid_Count_NB_Manage_Models<-list(
  "Random"=glmer.nb(Graminoid_Count ~ (1|Year) + (1|Zone/Transect), data=Modeling_Variables),
  "Burn"=glmer.nb(Graminoid_Count ~ Years_Since_Burn + (1|Year) + (1|Zone/Transect), data=Modeling_Variables),
  "Mow"=glmer.nb(Graminoid_Count ~ Years_Since_Mow + (1|Year) + (1|Zone/Transect), data=Modeling_Variables),
  "Burn+Mow"=glmer.nb(Graminoid_Count ~ Years_Since_Burn + Years_Since_Mow + (1|Year) + (1|Zone/Transect), data=Modeling_Variables),
  "Burn*Mow"=glmer.nb(Graminoid_Count ~ Years_Since_Burn * Years_Since_Mow + (1|Year) + (1|Zone/Transect), data=Modeling_Variables))

#Compare Models
compare_performance(Graminoid_Count_NB_Manage_Models, rank=TRUE)
plot(compare_performance(Graminoid_Count_NB_Manage_Models))

#Clear Unneeded Items
rm(list=c("Graminoid_Count_NB_Manage_Models"))
```

##### Combining Variable Groups

```{r Graminoid NB Count Combined Model Selection, echo=TRUE}
#Run Models
Graminoid_Count_NB_Combined_Models<-list(
  "Random"=glmer.nb(Graminoid_Count ~ (1|Year) + (1|Zone/Transect), data=Modeling_Variables),
  "Precip"=glmer.nb(Graminoid_Count ~ Total_Spring_Precip + (1|Year) + (1|Zone/Transect), data=Modeling_Variables),
  "Mow"=glmer.nb(Graminoid_Count ~ Years_Since_Mow + (1|Year) + (1|Zone/Transect), data=Modeling_Variables),
  "Precip+Mow"=glmer.nb(Graminoid_Count ~ Total_Spring_Precip + Years_Since_Mow + (1|Year) + (1|Zone/Transect), data=Modeling_Variables),
  "Precip*Mow"=glmer.nb(Graminoid_Count ~ Total_Spring_Precip * Years_Since_Mow + (1|Year) + (1|Zone/Transect), data=Modeling_Variables))

#Compare Models
compare_performance(Graminoid_Count_NB_Combined_Models, rank=TRUE)
plot(compare_performance(Graminoid_Count_NB_Combined_Models))

#Select Best Model
Best_Graminoid_Count_NB_Model<-glmer.nb(Graminoid_Count ~ Total_Spring_Precip + Years_Since_Mow + (1|Year) + (1|Zone/Transect), data=Modeling_Variables)

#Clear Unneeded Items
rm(list=c("Graminoid_Count_NB_Combined_Models"))
```

### Binomial Proportion

#### Model Structure

Models were run using the functions `glm()` and `glmer()` from the R package [lme4](https://cran.r-project.org/web/packages/lme4/lme4.pdf) with family=Binomial, as the response variable is a proportion

##### Random Effect Selection

Transect, Zone, and Year are grouping variables that may need to be accounted for as mixed effects when running models. Zone has fewer than five levels so it should not be used as a random effect on its own, however, each Transect is nested within a Zone. To determine the best structure of random effects, possible random effect structures based on the study design were modeled and the model with the best fixed effect structure of the group was selected using the R package [performance](https://cran.r-project.org/web/packages/performance/performance.pdf) function `compare_performance()`.

```{r Graminoid Binomial Proportion Random Model Selection, echo=TRUE}
#Run Models
Graminoid_Binom_Prop_Random_Models<-list(
  "Intercept"=glm(cbind(Graminoid_Count, Total_Count-Graminoid_Count) ~ 1, data=Modeling_Variables, family=binomial),
  "Year"=glmer(cbind(Graminoid_Count, Total_Count-Graminoid_Count) ~ (1|Year), data=Modeling_Variables, family=binomial),
  "Transect"=glmer(cbind(Graminoid_Count, Total_Count-Graminoid_Count) ~ (1|Transect), data=Modeling_Variables, family=binomial),
  "Zone/Transect"=glmer(cbind(Graminoid_Count, Total_Count-Graminoid_Count) ~ (1|Zone/Transect), data=Modeling_Variables, family=binomial),
  "Year+Transect"=glmer(cbind(Graminoid_Count, Total_Count-Graminoid_Count) ~ (1|Year) + (1|Transect), data=Modeling_Variables, family=binomial),
  "Year+Zone/Transect"=glmer(cbind(Graminoid_Count, Total_Count-Graminoid_Count) ~ (1|Year) + (1|Zone/Transect), data=Modeling_Variables, family=binomial))

#Compare Models
compare_performance(Graminoid_Binom_Prop_Random_Models, rank=TRUE)
plot(compare_performance(Graminoid_Binom_Prop_Random_Models))

#Clear Unneeded Items
rm(list=c("Graminoid_Binom_Prop_Random_Models"))
```

##### Fixed Effect Selection

Additive model selection was conducted after splitting the predictor variables into two groups: the "Climate" variables "Total Spring Precipitation" and "Date of Last Freeze" and the "Management" predictor variables "Years Since Last Burn" and "Years Since Last Mow".

For all variable groups, all possible fixed effect structures (including models of two-way interactions for the Climate and Management variables) were modeled, and the model with the best fixed effect structure of the group was selected using the R package [performance](https://cran.r-project.org/web/packages/performance/performance.pdf) function `compare_performance()`. To build a final model, all additive combinations of the best fixed effect structures from each group were modeled and the best model was selected.

##### Weather Variables

```{r Graminoid Binomial Proportion Weather Model Selection, echo=TRUE}
#Run Models
Graminoid_Binom_Prop_Weather_Models<-list(
  "Random"=glmer(cbind(Graminoid_Count, Total_Count-Graminoid_Count) ~ (1|Year) + (1|Transect), data=Modeling_Variables, family=binomial),
  "Precip"=glmer(cbind(Graminoid_Count, Total_Count-Graminoid_Count) ~ Total_Spring_Precip + (1|Year) + (1|Transect), data=Modeling_Variables, family=binomial),
  "Freeze"=glmer(cbind(Graminoid_Count, Total_Count-Graminoid_Count) ~ Last_Freeze + (1|Year) + (1|Transect), data=Modeling_Variables, family=binomial),
  "Precip+Freeze"=glmer(cbind(Graminoid_Count, Total_Count-Graminoid_Count) ~ Total_Spring_Precip + Last_Freeze + (1|Year) + (1|Transect), data=Modeling_Variables, family=binomial),
  "Precip*Freeze"=glmer(cbind(Graminoid_Count, Total_Count-Graminoid_Count) ~ Total_Spring_Precip * Last_Freeze + (1|Year) + (1|Transect), data=Modeling_Variables, family=binomial))

#Compare Models
compare_performance(Graminoid_Binom_Prop_Weather_Models, rank=TRUE)
plot(compare_performance(Graminoid_Binom_Prop_Weather_Models))

#Clear Unneeded Items
rm(list=c("Graminoid_Binom_Prop_Weather_Models"))
```

##### Management Variables

```{r Graminoid Binomial Proportion Management Model Selection, echo=TRUE}
#Run Models
Graminoid_Binom_Prop_Manage_Models<-list(
  "Random"=glmer(cbind(Graminoid_Count, Total_Count-Graminoid_Count) ~ (1|Year) + (1|Transect), data=Modeling_Variables, family=binomial),
  "Burn"=glmer(cbind(Graminoid_Count, Total_Count-Graminoid_Count) ~ Years_Since_Burn + (1|Year) + (1|Transect), data=Modeling_Variables, family=binomial),
  "Mow"=glmer(cbind(Graminoid_Count, Total_Count-Graminoid_Count) ~ Years_Since_Mow + (1|Year) + (1|Transect), data=Modeling_Variables, family=binomial),
  "Burn+Mow"=glmer(cbind(Graminoid_Count, Total_Count-Graminoid_Count) ~ Years_Since_Burn + Years_Since_Mow + (1|Year) + (1|Transect), data=Modeling_Variables, family=binomial),
  "Burn*Mow"=glmer(cbind(Graminoid_Count, Total_Count-Graminoid_Count) ~ Years_Since_Burn * Years_Since_Mow + (1|Year) + (1|Transect), data=Modeling_Variables, family=binomial))

#Compare Models
compare_performance(Graminoid_Binom_Prop_Manage_Models, rank=TRUE)
plot(compare_performance(Graminoid_Binom_Prop_Manage_Models))

#Clear Unneeded Items
rm(list=c("Graminoid_Binom_Prop_Manage_Models"))
```

##### Combining Variable Groups

```{r Graminoid Binomial Proportion Combined Model Selection, echo=TRUE}
#Run Models
Graminoid_Binom_Prop_Combined_Models<-list(
  "Random"=glmer(cbind(Graminoid_Count, Total_Count-Graminoid_Count) ~ (1|Year) + (1|Transect), data=Modeling_Variables, family=binomial),
  "Precip+Freeze"=glmer(cbind(Graminoid_Count, Total_Count-Graminoid_Count) ~ Total_Spring_Precip + Last_Freeze + (1|Year) + (1|Transect), data=Modeling_Variables, family=binomial),
  "Burn"=glmer(cbind(Graminoid_Count, Total_Count-Graminoid_Count) ~ Years_Since_Burn + (1|Year) + (1|Transect), data=Modeling_Variables, family=binomial),
  "(Precip+Freeze)+Burn"=glmer(cbind(Graminoid_Count, Total_Count-Graminoid_Count) ~ (Total_Spring_Precip + Last_Freeze) + Years_Since_Burn + (1|Year) + (1|Transect), data=Modeling_Variables, family=binomial),
  "(Precip+Freeze)*Burn"=glmer(cbind(Graminoid_Count, Total_Count-Graminoid_Count) ~ (Total_Spring_Precip + Last_Freeze) * Years_Since_Burn + (1|Year) + (1|Transect), data=Modeling_Variables, family=binomial))

#Compare Models
compare_performance(Graminoid_Binom_Prop_Combined_Models, rank=TRUE)
plot(compare_performance(Graminoid_Binom_Prop_Combined_Models))

#Select Best Model
Best_Graminoid_Binom_Prop_Model<-glmer(cbind(Graminoid_Count, Total_Count-Graminoid_Count) ~ (Total_Spring_Precip + Last_Freeze) + Years_Since_Burn + (1|Year) + (1|Transect), data=Modeling_Variables, family=binomial)

#Clear Unneeded Items
rm(list=c("Graminoid_Binom_Prop_Combined_Models"))
```

### Overall Best Graminoid Model

#### Model Selection

```{r Best Overall Graminoid Model, echo=TRUE}
#Run Models
Graminoid_All_Models<-list(
  "Linear Percentage"=Best_Graminoid_Percent_Model,
  "Poisson Count"=Best_Graminoid_Count_P_Model,
  "Negative Binomial Count"=Best_Graminoid_Count_NB_Model,
  "Binomial Proportion"=Best_Graminoid_Binom_Prop_Model)

#Compare Models
compare_performance(Graminoid_All_Models, rank=TRUE)
plot(compare_performance(Graminoid_All_Models))
```

#### Model Summary

```{r Overall Best Graminoid Model}
#Select Best Model
Best_Graminoid_Model<-Best_Graminoid_Percent_Model

#Model Summary
summary(Best_Graminoid_Model)
model_performance(Best_Graminoid_Model)

#Fancy Model Table
tab_model(Best_Graminoid_Model, dv.labels="Percent Graminoids")

#Best Model Report
report(Best_Graminoid_Model)

#Clear Unneeded Items
rm(list=c("Graminoid_All_Models", "Best_Graminoid_Percent_Model", "Best_Graminoid_Count_P_Model", "Best_Graminoid_Count_NB_Model", "Best_Graminoid_Binom_Prop_Model"))
```

#### Model Diagnostics

```{r Best Graminoid Model Diagnostics}
#Diagnostic Tests
plot(simulateResiduals(fittedModel=Best_Graminoid_Model), title="Percent Graminoids")

#Save DHARMa Plot
tiff("Output/Graminoid_DHARMa.tif", width=8, height=4, units="in", res=300)
plot(simulateResiduals(fittedModel=Best_Graminoid_Model), title="C Percent Graminoids")
invisible(dev.off())
```

#### Effect Plots

```{r Best Graminoid Model Effects Plots}
#Fixed Effects Coefficients Plot
Graminoid_Effects<-plot(parameters(Best_Graminoid_Model, effects="fixed")) +
  annotate("text", x=c(2.40), y=c(3.1), color=c("#458DE1"), label="*", size=8)
Graminoid_Effects

#Effects Plot
plot(allEffects(Best_Graminoid_Model), main="")

#Print Effects Plot
tiff("Output/Graminoid_Model_Effects.tif", width=10, height=10, units="in", res=300, bg="transparent")
plot(allEffects(Best_Graminoid_Model), main="")
invisible(dev.off())
```

## Rare Plants

### Percent

#### Model Structure

Models were run using the functions `lm()` and `lmer()` from the R package [lme4](https://cran.r-project.org/web/packages/lme4/lme4.pdf), as the response variable is a percentage.

##### Random Effect Selection

Transect, Zone, and Year are grouping variables that may need to be accounted for as mixed effects when running models. Zone has fewer than five levels so it should not be used as a random effect on its own, however, each Transect is nested within a Zone. To determine the best structure of random effects, possible random effect structures based on the study design were modeled and the model with the best fixed effect structure of the group was selected using the R package [performance](https://cran.r-project.org/web/packages/performance/performance.pdf) function `compare_performance()`.

```{r Rare Random Model Selection, echo=TRUE}
#Run Models
Rare_Percent_Random_Models<-list(
  "Intercept"=lm(Percent_Rare ~ 1, data=Modeling_Variables),
  "Year"=lmer(Percent_Rare ~ (1|Year), data=Modeling_Variables),
  "Transect"=lmer(Percent_Rare ~ (1|Transect), data=Modeling_Variables),
  "Zone/Transect"=lmer(Percent_Rare ~ (1|Zone/Transect), data=Modeling_Variables),
  "Year+Transect"=lmer(Percent_Rare ~ (1|Year) + (1|Transect), data=Modeling_Variables),
  "Year+Zone/Transect"=lmer(Percent_Rare ~ (1|Year) + (1|Zone/Transect), data=Modeling_Variables))

#Compare Models
compare_performance(Rare_Percent_Random_Models, rank=TRUE)
plot(compare_performance(Rare_Percent_Random_Models))

#Clear Unneeded Items
rm(list=c("Rare_Percent_Random_Models"))
```

##### Fixed Effect Selection

Additive model selection was conducted after splitting the predictor variables into two groups: the "Climate" variables "Total Spring Precipitation" and "Date of Last Freeze" and the "Management" predictor variables "Years Since Last Burn" and "Years Since Last Mow".

For all variable groups, all possible fixed effect structures (including models of two-way interactions for the Climate and Management variables) were modeled, and the model with the best fixed effect structure of the group was selected using the R package [performance](https://cran.r-project.org/web/packages/performance/performance.pdf) function `compare_performance()`. To build a final model, all additive combinations of the best fixed effect structures from each group were modeled and the best model was selected.

##### Weather Variables

```{r Rare Weather Model Selection, echo=TRUE}
#Run Models
Rare_Percent_Weather_Models<-list(
  "Random"=lmer(Percent_Rare ~ (1|Transect), data=Modeling_Variables),
  "Precip"=lmer(Percent_Rare ~ Total_Spring_Precip + (1|Transect), data=Modeling_Variables),
  "Freeze"=lmer(Percent_Rare ~ Last_Freeze + (1|Transect), data=Modeling_Variables),
  "Precip+Freeze"=lmer(Percent_Rare ~ Total_Spring_Precip + Last_Freeze + (1|Transect), data=Modeling_Variables),
  "Precip*Freeze"=lmer(Percent_Rare ~ Total_Spring_Precip * Last_Freeze + (1|Transect), data=Modeling_Variables))

#Compare Models
compare_performance(Rare_Percent_Weather_Models, rank=TRUE)
plot(compare_performance(Rare_Percent_Weather_Models))

#Clear Unneeded Items
rm(list=c("Rare_Percent_Weather_Models"))
```

##### Management Variables

```{r Rare Management Model Selection, echo=TRUE}
#Run Models
Rare_Percent_Manage_Models<-list(
  "Random"=lmer(Percent_Rare ~ (1|Transect), data=Modeling_Variables),
  "Burn"=lmer(Percent_Rare ~ Years_Since_Burn + (1|Transect), data=Modeling_Variables),
  "Mow"=lmer(Percent_Rare ~ Years_Since_Mow + (1|Transect), data=Modeling_Variables),
  "Burn+Mow"=lmer(Percent_Rare ~ Years_Since_Burn + Years_Since_Mow + (1|Transect), data=Modeling_Variables),
  "Burn*Mow"=lmer(Percent_Rare ~ Years_Since_Burn * Years_Since_Mow + (1|Transect), data=Modeling_Variables))

#Compare Models
compare_performance(Rare_Percent_Manage_Models, rank=TRUE)
plot(compare_performance(Rare_Percent_Manage_Models))

#Clear Unneeded Items
rm(list=c("Rare_Percent_Manage_Models"))
```

##### Combining Variable Groups

```{r Rare Combined Model Selection, echo=TRUE}
#Run Models
Rare_Percent_Combined_Models<-list(
  "Random"=lmer(Percent_Rare ~ (1|Transect), data=Modeling_Variables),
  "Precip"=lmer(Percent_Rare ~ Total_Spring_Precip + (1|Transect), data=Modeling_Variables),
  "Burn"=lmer(Percent_Rare ~ Years_Since_Burn + (1|Transect), data=Modeling_Variables),
  "Precip+Burn"=lmer(Percent_Rare ~ Total_Spring_Precip + Years_Since_Burn + (1|Transect), data=Modeling_Variables),
  "Precip*Burn"=lmer(Percent_Rare ~ Total_Spring_Precip * Years_Since_Burn + (1|Transect), data=Modeling_Variables))

#Compare Models
compare_performance(Rare_Percent_Combined_Models, rank=TRUE)
plot(compare_performance(Rare_Percent_Combined_Models))

#Select Best Model
Best_Rare_Percent_Model<-lmer(Percent_Rare ~ Total_Spring_Precip + (1|Transect), data=Modeling_Variables)

#Clear Unneeded Items
rm(list=c("Rare_Percent_Combined_Models"))
```

### Poisson Count

#### Model Structure

Models were run using the functions `glm()` and `glmer()` from the R package [lme4](https://cran.r-project.org/web/packages/lme4/lme4.pdf) with family=Poisson, as the response variable is a count variable.

##### Random Effect Selection

Transect, Zone, and Year are grouping variables that may need to be accounted for as mixed effects when running models. Zone has fewer than five levels so it should not be used as a random effect on its own, however, each Transect is nested within a Zone. To determine the best structure of random effects, possible random effect structures based on the study design were modeled and the model with the best fixed effect structure of the group was selected using the R package [performance](https://cran.r-project.org/web/packages/performance/performance.pdf) function `compare_performance()`.

```{r Rare Count Random Model Selection, echo=TRUE}
#Run Models
Rare_Count_P_Random_Models<-list(
  "Intercept"=glm(Rare_Count ~ 1, data=Modeling_Variables, family=poisson),
  "Year"=glmer(Rare_Count ~ (1|Year), data=Modeling_Variables, family=poisson),
  "Transect"=glmer(Rare_Count ~ (1|Transect), data=Modeling_Variables, family=poisson),
  "Zone/Transect"=glmer(Rare_Count ~ (1|Zone/Transect), data=Modeling_Variables, family=poisson),
  "Year+Transect"=glmer(Rare_Count ~ (1|Year) + (1|Transect), data=Modeling_Variables, family=poisson),
  "Year+Zone/Transect"=glmer(Rare_Count ~ (1|Year) + (1|Zone/Transect), data=Modeling_Variables, family=poisson))

#Compare Models
compare_performance(Rare_Count_P_Random_Models, rank=TRUE)
plot(compare_performance(Rare_Count_P_Random_Models))

#Clear Unneeded Items
rm(list=c("Rare_Count_P_Random_Models"))
```

##### Fixed Effect Selection

Additive model selection was conducted after splitting the predictor variables into two groups: the "Climate" variables "Total Spring Precipitation" and "Date of Last Freeze" and the "Management" predictor variables "Years Since Last Burn" and "Years Since Last Mow".

For all variable groups, all possible fixed effect structures (including models of two-way interactions for the Climate and Management variables) were modeled, and the model with the best fixed effect structure of the group was selected using the R package [performance](https://cran.r-project.org/web/packages/performance/performance.pdf) function `compare_performance()`. To build a final model, all additive combinations of the best fixed effect structures from each group were modeled and the best model was selected.

##### Weather Variables

```{r Rare Count Weather Model Selection, echo=TRUE}
#Run Models
Rare_Count_P_Weather_Models<-list(
  "Random"=glmer(Rare_Count ~ (1|Year) + (1|Transect), data=Modeling_Variables, family=poisson),
  "Precip"=glmer(Rare_Count ~ Total_Spring_Precip + (1|Year) + (1|Transect), data=Modeling_Variables, family=poisson),
  "Freeze"=glmer(Rare_Count ~ Last_Freeze + (1|Year) + (1|Transect), data=Modeling_Variables, family=poisson),
  "Precip+Freeze"=glmer(Rare_Count ~ Total_Spring_Precip + Last_Freeze + (1|Year) + (1|Transect), data=Modeling_Variables, family=poisson),
  "Precip*Freeze"=glmer(Rare_Count ~ Total_Spring_Precip * Last_Freeze + (1|Year) + (1|Transect), data=Modeling_Variables, family=poisson))

#Compare Models
compare_performance(Rare_Count_P_Weather_Models, rank=TRUE)
plot(compare_performance(Rare_Count_P_Weather_Models))

#Clear Unneeded Items
rm(list=c("Rare_Count_P_Weather_Models"))
```

##### Management Variables

```{r Rare Count Management Model Selection, echo=TRUE}
#Run Models
Rare_Count_P_Manage_Models<-list(
  "Random"=glmer(Rare_Count ~ (1|Year) + (1|Transect), data=Modeling_Variables, family=poisson),
  "Burn"=glmer(Rare_Count ~ Years_Since_Burn + (1|Year) + (1|Transect), data=Modeling_Variables, family=poisson),
  "Mow"=glmer(Rare_Count ~ Years_Since_Mow + (1|Year) + (1|Transect), data=Modeling_Variables, family=poisson),
  "Burn+Mow"=glmer(Rare_Count ~ Years_Since_Burn + Years_Since_Mow + (1|Year) + (1|Transect), data=Modeling_Variables, family=poisson),
  "Burn*Mow"=glmer(Rare_Count ~ Years_Since_Burn * Years_Since_Mow + (1|Year) + (1|Transect), data=Modeling_Variables, family=poisson))

#Compare Models
compare_performance(Rare_Count_P_Manage_Models, rank=TRUE)
plot(compare_performance(Rare_Count_P_Manage_Models))

#Clear Unneeded Items
rm(list=c("Rare_Count_P_Manage_Models"))
```

##### Combining Variable Groups

```{r Rare Count Combined Model Selection, echo=TRUE}
#Run Models
Rare_Count_P_Combined_Models<-list(
  "Random"=glmer(Rare_Count ~ (1|Year) + (1|Transect), data=Modeling_Variables, family=poisson),
  "Precip"=glmer(Rare_Count ~ Total_Spring_Precip + (1|Year) + (1|Transect), data=Modeling_Variables, family=poisson),
  "Burn"=glmer(Rare_Count ~ Years_Since_Burn + (1|Year) + (1|Transect), data=Modeling_Variables, family=poisson),
  "Precip+Burn"=glmer(Rare_Count ~ Total_Spring_Precip + Years_Since_Burn + (1|Year) + (1|Transect), data=Modeling_Variables, family=poisson),
  "Precip*Burn"=glmer(Rare_Count ~ Total_Spring_Precip * Years_Since_Burn + (1|Year) + (1|Transect), data=Modeling_Variables, family=poisson))

#Compare Models
compare_performance(Rare_Count_P_Combined_Models, rank=TRUE)
plot(compare_performance(Rare_Count_P_Combined_Models))

#Select Best Model
Best_Rare_Count_P_Model<-glmer(Rare_Count ~ Total_Spring_Precip + (1|Year) + (1|Transect), data=Modeling_Variables, family=poisson)

#Clear Unneeded Items
rm(list=c("Rare_Count_P_Combined_Models"))
```

### Negative Binomial Count

#### Model Structure

Models were run using the functions `glm.nb()` and `glmer.nb()` from the R package [MASS](https://cran.r-project.org/web/packages/MASS/MASS.pdf), as the response variable is a count variable.

##### Random Effect Selection

Transect, Zone, and Year are grouping variables that may need to be accounted for as mixed effects when running models. Zone has fewer than five levels so it should not be used as a random effect on its own, however, each Transect is nested within a Zone. To determine the best structure of random effects, possible random effect structures based on the study design were modeled and the model with the best fixed effect structure of the group was selected using the R package [performance](https://cran.r-project.org/web/packages/performance/performance.pdf) function `compare_performance()`.

```{r Rare NB Count Random Model Selection, echo=TRUE}
#Run Models
Rare_Count_NB_Random_Models<-list(
  "Intercept"=glm.nb(Rare_Count ~ 1, data=Modeling_Variables),
  "Year"=glmer.nb(Rare_Count ~ (1|Year), data=Modeling_Variables),
  "Transect"=glmer.nb(Rare_Count ~ (1|Transect), data=Modeling_Variables),
  "Zone/Transect"=glmer.nb(Rare_Count ~ (1|Zone/Transect), data=Modeling_Variables),
  "Year+Transect"=glmer.nb(Rare_Count ~ (1|Year) + (1|Transect), data=Modeling_Variables),
  "Year+Zone/Transect"=glmer.nb(Rare_Count ~ (1|Year) + (1|Zone/Transect), data=Modeling_Variables))

#Compare Models
compare_performance(Rare_Count_NB_Random_Models, rank=TRUE)
plot(compare_performance(Rare_Count_NB_Random_Models))

#Clear Unneeded Items
rm(list=c("Rare_Count_NB_Random_Models"))
```

##### Fixed Effect Selection

Additive model selection was conducted after splitting the predictor variables into two groups: the "Climate" variables "Total Spring Precipitation" and "Date of Last Freeze" and the "Management" predictor variables "Years Since Last Burn" and "Years Since Last Mow".

For all variable groups, all possible fixed effect structures (including models of two-way interactions for the Climate and Management variables) were modeled, and the model with the best fixed effect structure of the group was selected using the R package [performance](https://cran.r-project.org/web/packages/performance/performance.pdf) function `compare_performance()`. To build a final model, all additive combinations of the best fixed effect structures from each group were modeled and the best model was selected.

##### Weather Variables

```{r Rare NB Count Weather Model Selection, echo=TRUE}
#Run Models
Rare_Count_NB_Weather_Models<-list(
  "Random"=glmer.nb(Rare_Count ~ (1|Transect), data=Modeling_Variables),
  "Precip"=glmer.nb(Rare_Count ~ Total_Spring_Precip + (1|Transect), data=Modeling_Variables),
  "Freeze"=glmer.nb(Rare_Count ~ Last_Freeze + (1|Transect), data=Modeling_Variables),
  "Precip+Freeze"=glmer.nb(Rare_Count ~ Total_Spring_Precip + Last_Freeze + (1|Transect), data=Modeling_Variables),
  "Precip*Freeze"=glmer.nb(Rare_Count ~ Total_Spring_Precip * Last_Freeze + (1|Transect), data=Modeling_Variables))

#Compare Models
compare_performance(Rare_Count_NB_Weather_Models, rank=TRUE)
plot(compare_performance(Rare_Count_NB_Weather_Models))

#Clear Unneeded Items
rm(list=c("Rare_Count_NB_Weather_Models"))
```

##### Management Variables

```{r Rare NB Count Management Model Selection, echo=TRUE}
#Run Models
Rare_Count_NB_Manage_Models<-list(
  "Random"=glmer.nb(Rare_Count ~ (1|Transect), data=Modeling_Variables),
  "Burn"=glmer.nb(Rare_Count ~ Years_Since_Burn + (1|Transect), data=Modeling_Variables),
  "Mow"=glmer.nb(Rare_Count ~ Years_Since_Mow + (1|Transect), data=Modeling_Variables),
  "Burn+Mow"=glmer.nb(Rare_Count ~ Years_Since_Burn + Years_Since_Mow + (1|Transect), data=Modeling_Variables),
  "Burn*Mow"=glmer.nb(Rare_Count ~ Years_Since_Burn * Years_Since_Mow + (1|Transect), data=Modeling_Variables))

#Compare Models
compare_performance(Rare_Count_NB_Manage_Models, rank=TRUE)
plot(compare_performance(Rare_Count_NB_Manage_Models))

#Clear Unneeded Items
rm(list=c("Rare_Count_NB_Manage_Models"))
```

##### Combining Variable Groups

```{r Rare NB Count Combined Model Selection, echo=TRUE}
#Run Models
Rare_Count_NB_Combined_Models<-list(
  "Random"=glmer.nb(Rare_Count ~ (1|Transect), data=Modeling_Variables),
  "Precip"=glmer.nb(Rare_Count ~ Total_Spring_Precip + (1|Transect), data=Modeling_Variables),
  "Burn*Mow"=glmer.nb(Rare_Count ~ Years_Since_Burn * Years_Since_Mow + (1|Transect), data=Modeling_Variables),
  "Precip+(Burn*Mow)"=glmer.nb(Rare_Count ~ Total_Spring_Precip + (Years_Since_Burn * Years_Since_Mow) + (1|Transect), data=Modeling_Variables))
 #"Precip*(Burn*Mow)"=glmer.nb(Rare_Count ~ Total_Spring_Precip * (Years_Since_Burn * Years_Since_Mow) + (1|Transect), data=Modeling_Variables)) #Model does not converge

#Compare Models
compare_performance(Rare_Count_NB_Combined_Models, rank=TRUE)
plot(compare_performance(Rare_Count_NB_Combined_Models))

#Select Best Model
Best_Rare_Count_NB_Model<-glmer.nb(Rare_Count ~ Total_Spring_Precip + (Years_Since_Burn * Years_Since_Mow) + (1|Transect), data=Modeling_Variables)

#Clear Unneeded Items
rm(list=c("Rare_Count_NB_Combined_Models"))
```

### Binomial Proportion

#### Model Structure

Models were run using the functions `glm()` and `glmer()` from the R package [lme4](https://cran.r-project.org/web/packages/lme4/lme4.pdf) with family=Binomial, as the response variable is a proportion

##### Random Effect Selection

Transect, Zone, and Year are grouping variables that may need to be accounted for as mixed effects when running models. Zone has fewer than five levels so it should not be used as a random effect on its own, however, each Transect is nested within a Zone. To determine the best structure of random effects, possible random effect structures based on the study design were modeled and the model with the best fixed effect structure of the group was selected using the R package [performance](https://cran.r-project.org/web/packages/performance/performance.pdf) function `compare_performance()`.

```{r Rare Binomial Proportion Random Model Selection, echo=TRUE}
#Run Models
Rare_Binom_Prop_Random_Models<-list(
  "Intercept"=glm(cbind(Rare_Count, Total_Count-Rare_Count) ~ 1, data=Modeling_Variables, family=binomial),
  "Year"=glmer(cbind(Rare_Count, Total_Count-Rare_Count) ~ (1|Year), data=Modeling_Variables, family=binomial),
  "Transect"=glmer(cbind(Rare_Count, Total_Count-Rare_Count) ~ (1|Transect), data=Modeling_Variables, family=binomial),
  "Zone/Transect"=glmer(cbind(Rare_Count, Total_Count-Rare_Count) ~ (1|Zone/Transect), data=Modeling_Variables, family=binomial),
  "Year+Transect"=glmer(cbind(Rare_Count, Total_Count-Rare_Count) ~ (1|Year) + (1|Transect), data=Modeling_Variables, family=binomial),
  "Year+Zone/Transect"=glmer(cbind(Rare_Count, Total_Count-Rare_Count) ~ (1|Year) + (1|Zone/Transect), data=Modeling_Variables, family=binomial))

#Compare Models
compare_performance(Rare_Binom_Prop_Random_Models, rank=TRUE)
plot(compare_performance(Rare_Binom_Prop_Random_Models))

#Clear Unneeded Items
rm(list=c("Rare_Binom_Prop_Random_Models"))
```

##### Fixed Effect Selection

Additive model selection was conducted after splitting the predictor variables into two groups: the "Climate" variables "Total Spring Precipitation" and "Date of Last Freeze" and the "Management" predictor variables "Years Since Last Burn" and "Years Since Last Mow".

For all variable groups, all possible fixed effect structures (including models of two-way interactions for the Climate and Management variables) were modeled, and the model with the best fixed effect structure of the group was selected using the R package [performance](https://cran.r-project.org/web/packages/performance/performance.pdf) function `compare_performance()`. To build a final model, all additive combinations of the best fixed effect structures from each group were modeled and the best model was selected.

##### Weather Variables

```{r Rare Binomial Proportion Weather Model Selection, echo=TRUE}
#Run Models
Rare_Binom_Prop_Weather_Models<-list(
  "Random"=glmer(cbind(Rare_Count, Total_Count-Rare_Count) ~ (1|Transect), data=Modeling_Variables, family=binomial),
  "Precip"=glmer(cbind(Rare_Count, Total_Count-Rare_Count) ~ Total_Spring_Precip + (1|Transect), data=Modeling_Variables, family=binomial),
  "Freeze"=glmer(cbind(Rare_Count, Total_Count-Rare_Count) ~ Last_Freeze + (1|Transect), data=Modeling_Variables, family=binomial),
  "Precip+Freeze"=glmer(cbind(Rare_Count, Total_Count-Rare_Count) ~ Total_Spring_Precip + Last_Freeze + (1|Transect), data=Modeling_Variables, family=binomial),
  "Precip*Freeze"=glmer(cbind(Rare_Count, Total_Count-Rare_Count) ~ Total_Spring_Precip * Last_Freeze + (1|Transect), data=Modeling_Variables, family=binomial))

#Compare Models
compare_performance(Rare_Binom_Prop_Weather_Models, rank=TRUE)
plot(compare_performance(Rare_Binom_Prop_Weather_Models))

#Clear Unneeded Items
rm(list=c("Rare_Binom_Prop_Weather_Models"))
```

##### Management Variables

```{r Rare Binomial Proportion Management Model Selection, echo=TRUE}
#Run Models
Rare_Binom_Prop_Manage_Models<-list(
  "Random"=glmer(cbind(Rare_Count, Total_Count-Rare_Count) ~ (1|Transect), data=Modeling_Variables, family=binomial),
  "Burn"=glmer(cbind(Rare_Count, Total_Count-Rare_Count) ~ Years_Since_Burn + (1|Transect), data=Modeling_Variables, family=binomial),
  "Mow"=glmer(cbind(Rare_Count, Total_Count-Rare_Count) ~ Years_Since_Mow + (1|Transect), data=Modeling_Variables, family=binomial),
  "Burn+Mow"=glmer(cbind(Rare_Count, Total_Count-Rare_Count) ~ Years_Since_Burn + Years_Since_Mow + (1|Transect), data=Modeling_Variables, family=binomial),
  "Burn*Mow"=glmer(cbind(Rare_Count, Total_Count-Rare_Count) ~ Years_Since_Burn * Years_Since_Mow + (1|Transect), data=Modeling_Variables, family=binomial))

#Compare Models
compare_performance(Rare_Binom_Prop_Manage_Models, rank=TRUE)
plot(compare_performance(Rare_Binom_Prop_Manage_Models))

#Clear Unneeded Items
rm(list=c("Rare_Binom_Prop_Manage_Models"))
```

##### Combining Variable Groups

```{r Rare Binomial Proportion Combined Model Selection, echo=TRUE}
#Run Models
Rare_Binom_Prop_Combined_Models<-list(
  "Random"=glmer(cbind(Rare_Count, Total_Count-Rare_Count) ~ (1|Transect), data=Modeling_Variables, family=binomial),
  "Precip"=glmer(cbind(Rare_Count, Total_Count-Rare_Count) ~ Total_Spring_Precip + (1|Transect), data=Modeling_Variables, family=binomial),
  "Burn"=glmer(cbind(Rare_Count, Total_Count-Rare_Count) ~ Years_Since_Burn + (1|Transect), data=Modeling_Variables, family=binomial),
  "Precip+Burn"=glmer(cbind(Rare_Count, Total_Count-Rare_Count) ~ Total_Spring_Precip + Years_Since_Burn + (1|Transect), data=Modeling_Variables, family=binomial),
  "Precip*Burn"=glmer(cbind(Rare_Count, Total_Count-Rare_Count) ~ Total_Spring_Precip * Years_Since_Burn + (1|Transect), data=Modeling_Variables, family=binomial))

#Compare Models
compare_performance(Rare_Binom_Prop_Combined_Models, rank=TRUE)
plot(compare_performance(Rare_Binom_Prop_Combined_Models))

#Select Best Model
Best_Rare_Binom_Prop_Model<-glmer(cbind(Rare_Count, Total_Count-Rare_Count) ~ Total_Spring_Precip + Years_Since_Burn + (1|Transect), data=Modeling_Variables, family=binomial)

#Clear Unneeded Items
rm(list=c("Rare_Binom_Prop_Combined_Models"))
```

### Overall Best Rare Model

#### Model Selection

```{r Best Overall Rare Model, echo=TRUE}
#Run Models
Rare_All_Models<-list(
  "Linear Percentage"=Best_Rare_Percent_Model,
  "Poisson Count"=Best_Rare_Count_P_Model,
  "Negative Binomial Count"=Best_Rare_Count_NB_Model,
  "Binomial Proportion"=Best_Rare_Binom_Prop_Model)

#Compare Models
compare_performance(Rare_All_Models, rank=TRUE)
plot(compare_performance(Rare_All_Models))
```

#### Model Summary

```{r Overall Best Rare Model}
#Select Best Model
Best_Rare_Model<-Best_Rare_Percent_Model

#Model Summary
summary(Best_Rare_Model)
model_performance(Best_Rare_Model)

#Fancy Model Table
tab_model(Best_Rare_Model, dv.labels="Percent Rare Plants")

#Best Model Report
report(Best_Rare_Model)

#Clear Unneeded Items
rm(list=c("Rare_All_Models", "Best_Rare_Percent_Model", "Best_Rare_Count_P_Model", "Best_Rare_Count_NB_Model", "Best_Rare_Binom_Prop_Model"))
```

#### Model Diagnostics

```{r Best Rare Model Diagnostics}
#Diagnostic Tests
plot(simulateResiduals(fittedModel=Best_Rare_Model), title="Percent Rare Plants")

#Save DHARMa Plot
tiff("Output/Rare_DHARMa.tif", width=8, height=4, units="in", res=300)
plot(simulateResiduals(fittedModel=Best_Rare_Model), title="D Percent Rare Plants")
invisible(dev.off())
```

#### Effect Plots

```{r Best Rare Model Effects Plots}
#Fixed Effects Coefficients Plot
Rare_Effects<-plot(parameters(Best_Rare_Model, effects="fixed"))
Rare_Effects

#Effects Plot
plot(allEffects(Best_Rare_Model), main="")

#Print Effects Plot
tiff("Output/Rare_Model_Effects.tif", width=5, height=5, units="in", res=300, bg="transparent")
plot(allEffects(Best_Rare_Model), main="")
invisible(dev.off())
```

## Exotic Plants

### Percent

#### Model Structure

Models were run using the functions `lm()` and `lmer()` from the R package [lme4](https://cran.r-project.org/web/packages/lme4/lme4.pdf), as the response variable is a percentage.

##### Random Effect Selection

Transect, Zone, and Year are grouping variables that may need to be accounted for as mixed effects when running models. Zone has fewer than five levels so it should not be used as a random effect on its own, however, each Transect is nested within a Zone. To determine the best structure of random effects, possible random effect structures based on the study design were modeled and the model with the best fixed effect structure of the group was selected using the R package [performance](https://cran.r-project.org/web/packages/performance/performance.pdf) function `compare_performance()`.

```{r Exotic Random Model Selection, echo=TRUE}
#Run Models
Exotic_Percent_Random_Models<-list(
  "Intercept"=lm(Percent_Exotic ~ 1, data=Modeling_Variables),
  "Year"=lmer(Percent_Exotic ~ (1|Year), data=Modeling_Variables),
  "Transect"=lmer(Percent_Exotic ~ (1|Transect), data=Modeling_Variables),
  "Zone/Transect"=lmer(Percent_Exotic ~ (1|Zone/Transect), data=Modeling_Variables),
  "Year+Transect"=lmer(Percent_Exotic ~ (1|Year) + (1|Transect), data=Modeling_Variables),
  "Year+Zone/Transect"=lmer(Percent_Exotic ~ (1|Year) + (1|Zone/Transect), data=Modeling_Variables))

#Compare Models
compare_performance(Exotic_Percent_Random_Models, rank=TRUE)
plot(compare_performance(Exotic_Percent_Random_Models))

#Clear Unneeded Items
rm(list=c("Exotic_Percent_Random_Models"))
```

##### Fixed Effect Selection

Additive model selection was conducted after splitting the predictor variables into two groups: the "Climate" variables "Total Spring Precipitation" and "Date of Last Freeze" and the "Management" predictor variables "Years Since Last Burn" and "Years Since Last Mow".

For all variable groups, all possible fixed effect structures (including models of two-way interactions for the Climate and Management variables) were modeled, and the model with the best fixed effect structure of the group was selected using the R package [performance](https://cran.r-project.org/web/packages/performance/performance.pdf) function `compare_performance()`. To build a final model, all additive combinations of the best fixed effect structures from each group were modeled and the best model was selected.

##### Weather Variables

```{r Exotic Weather Model Selection, echo=TRUE}
#Run Models
Exotic_Percent_Weather_Models<-list(
  "Random"=lmer(Percent_Exotic ~ (1|Year) + (1|Zone/Transect), data=Modeling_Variables),
  "Precip"=lmer(Percent_Exotic ~ Total_Spring_Precip + (1|Year) + (1|Zone/Transect), data=Modeling_Variables),
  "Freeze"=lmer(Percent_Exotic ~ Last_Freeze + (1|Year) + (1|Zone/Transect), data=Modeling_Variables),
  "Precip+Freeze"=lmer(Percent_Exotic ~ Total_Spring_Precip + Last_Freeze + (1|Year) + (1|Zone/Transect), data=Modeling_Variables),
  "Precip*Freeze"=lmer(Percent_Exotic ~ Total_Spring_Precip * Last_Freeze + (1|Year) + (1|Zone/Transect), data=Modeling_Variables))

#Compare Models
compare_performance(Exotic_Percent_Weather_Models, rank=TRUE)
plot(compare_performance(Exotic_Percent_Weather_Models))

#Clear Unneeded Items
rm(list=c("Exotic_Percent_Weather_Models"))
```

##### Management Variables

```{r Exotic Management Model Selection, echo=TRUE}
#Run Models
Exotic_Percent_Manage_Models<-list(
  "Random"=lmer(Percent_Exotic ~ (1|Year) + (1|Zone/Transect), data=Modeling_Variables),
  "Burn"=lmer(Percent_Exotic ~ Years_Since_Burn + (1|Year) + (1|Zone/Transect), data=Modeling_Variables),
  "Mow"=lmer(Percent_Exotic ~ Years_Since_Mow + (1|Year) + (1|Zone/Transect), data=Modeling_Variables),
  "Burn+Mow"=lmer(Percent_Exotic ~ Years_Since_Burn + Years_Since_Mow + (1|Year) + (1|Zone/Transect), data=Modeling_Variables),
  "Burn*Mow"=lmer(Percent_Exotic ~ Years_Since_Burn * Years_Since_Mow + (1|Year) + (1|Zone/Transect), data=Modeling_Variables))

#Compare Models
compare_performance(Exotic_Percent_Manage_Models, rank=TRUE)
plot(compare_performance(Exotic_Percent_Manage_Models))

#Clear Unneeded Items
rm(list=c("Exotic_Percent_Manage_Models"))
```

##### Combining Variable Groups

```{r Exotic Combined Model Selection, echo=TRUE}
#Run Models
Exotic_Percent_Combined_Models<-list(
  "Random"=lmer(Percent_Exotic ~ (1|Year) + (1|Zone/Transect), data=Modeling_Variables),
  "Freeze"=lmer(Percent_Exotic ~ Last_Freeze + (1|Year) + (1|Zone/Transect), data=Modeling_Variables),
  "Burn"=lmer(Percent_Exotic ~ Years_Since_Burn + (1|Year) + (1|Zone/Transect), data=Modeling_Variables),
  "Freeze+Burn"=lmer(Percent_Exotic ~ Last_Freeze + Years_Since_Burn + (1|Year) + (1|Zone/Transect), data=Modeling_Variables),
  "Freeze*Burn"=lmer(Percent_Exotic ~ Last_Freeze * Years_Since_Burn + (1|Year) + (1|Zone/Transect), data=Modeling_Variables))

#Compare Models
compare_performance(Exotic_Percent_Combined_Models, rank=TRUE)
plot(compare_performance(Exotic_Percent_Combined_Models))

#Select Best Model
Best_Exotic_Percent_Model<-lmer(Percent_Exotic ~ Last_Freeze * Years_Since_Burn + (1|Year) + (1|Zone/Transect), data=Modeling_Variables)

#Clear Unneeded Items
rm(list=c("Exotic_Percent_Combined_Models"))
```

### Poisson Count

#### Model Structure

Models were run using the functions `glm()` and `glmer()` from the R package [lme4](https://cran.r-project.org/web/packages/lme4/lme4.pdf) with family=Poisson, as the response variable is a count variable.

##### Random Effect Selection

Transect, Zone, and Year are grouping variables that may need to be accounted for as mixed effects when running models. Zone has fewer than five levels so it should not be used as a random effect on its own, however, each Transect is nested within a Zone. To determine the best structure of random effects, possible random effect structures based on the study design were modeled and the model with the best fixed effect structure of the group was selected using the R package [performance](https://cran.r-project.org/web/packages/performance/performance.pdf) function `compare_performance()`.

```{r Exotic Count Random Model Selection, echo=TRUE}
#Run Models
Exotic_Count_P_Random_Models<-list(
  "Intercept"=glm(Exotic_Count ~ 1, data=Modeling_Variables, family=poisson),
  "Year"=glmer(Exotic_Count ~ (1|Year), data=Modeling_Variables, family=poisson),
  "Transect"=glmer(Exotic_Count ~ (1|Transect), data=Modeling_Variables, family=poisson),
  "Zone/Transect"=glmer(Exotic_Count ~ (1|Zone/Transect), data=Modeling_Variables, family=poisson),
  "Year+Transect"=glmer(Exotic_Count ~ (1|Year) + (1|Transect), data=Modeling_Variables, family=poisson),
  "Year+Zone/Transect"=glmer(Exotic_Count ~ (1|Year) + (1|Zone/Transect), data=Modeling_Variables, family=poisson))

#Compare Models
compare_performance(Exotic_Count_P_Random_Models, rank=TRUE)
plot(compare_performance(Exotic_Count_P_Random_Models))

#Clear Unneeded Items
rm(list=c("Exotic_Count_P_Random_Models"))
```

##### Fixed Effect Selection

Additive model selection was conducted after splitting the predictor variables into two groups: the "Climate" variables "Total Spring Precipitation" and "Date of Last Freeze" and the "Management" predictor variables "Years Since Last Burn" and "Years Since Last Mow".

For all variable groups, all possible fixed effect structures (including models of two-way interactions for the Climate and Management variables) were modeled, and the model with the best fixed effect structure of the group was selected using the R package [performance](https://cran.r-project.org/web/packages/performance/performance.pdf) function `compare_performance()`. To build a final model, all additive combinations of the best fixed effect structures from each group were modeled and the best model was selected.

##### Weather Variables

```{r Exotic Count Weather Model Selection, echo=TRUE}
#Run Models
Exotic_Count_P_Weather_Models<-list(
  "Random"=glmer(Exotic_Count ~ (1|Year) + (1|Zone/Transect), data=Modeling_Variables, family=poisson),
  "Precip"=glmer(Exotic_Count ~ Total_Spring_Precip + (1|Year) + (1|Zone/Transect), data=Modeling_Variables, family=poisson),
  "Freeze"=glmer(Exotic_Count ~ Last_Freeze + (1|Year) + (1|Zone/Transect), data=Modeling_Variables, family=poisson),
  "Precip+Freeze"=glmer(Exotic_Count ~ Total_Spring_Precip + Last_Freeze + (1|Year) + (1|Zone/Transect), data=Modeling_Variables, family=poisson),
  "Precip*Freeze"=glmer(Exotic_Count ~ Total_Spring_Precip * Last_Freeze + (1|Year) + (1|Zone/Transect), data=Modeling_Variables, family=poisson))

#Compare Models
compare_performance(Exotic_Count_P_Weather_Models, rank=TRUE)
plot(compare_performance(Exotic_Count_P_Weather_Models))

#Clear Unneeded Items
rm(list=c("Exotic_Count_P_Weather_Models"))
```

##### Management Variables

```{r Exotic Count Management Model Selection, echo=TRUE}
#Run Models
Exotic_Count_P_Manage_Models<-list(
  "Random"=glmer(Exotic_Count ~ (1|Year) + (1|Zone/Transect), data=Modeling_Variables, family=poisson),
  "Burn"=glmer(Exotic_Count ~ Years_Since_Burn + (1|Year) + (1|Zone/Transect), data=Modeling_Variables, family=poisson),
  "Mow"=glmer(Exotic_Count ~ Years_Since_Mow + (1|Year) + (1|Zone/Transect), data=Modeling_Variables, family=poisson),
  "Burn+Mow"=glmer(Exotic_Count ~ Years_Since_Burn + Years_Since_Mow + (1|Year) + (1|Zone/Transect), data=Modeling_Variables, family=poisson),
  "Burn*Mow"=glmer(Exotic_Count ~ Years_Since_Burn * Years_Since_Mow + (1|Year) + (1|Zone/Transect), data=Modeling_Variables, family=poisson))

#Compare Models
compare_performance(Exotic_Count_P_Manage_Models, rank=TRUE)
plot(compare_performance(Exotic_Count_P_Manage_Models))

#Clear Unneeded Items
rm(list=c("Exotic_Count_P_Manage_Models"))
```

##### Combining Variable Groups

```{r Exotic Count Combined Model Selection, echo=TRUE}
#Run Models
Exotic_Count_P_Combined_Models<-list(
  "Random"=glmer(Exotic_Count ~ (1|Year) + (1|Zone/Transect), data=Modeling_Variables, family=poisson),
  "Precip"=glmer(Exotic_Count ~ Total_Spring_Precip + (1|Year) + (1|Zone/Transect), data=Modeling_Variables, family=poisson),
  "Burn*Mow"=glmer(Exotic_Count ~ (Years_Since_Burn * Years_Since_Mow) + (1|Year) + (1|Zone/Transect), data=Modeling_Variables, family=poisson),
  "Precip+(Burn*Mow)"=glmer(Exotic_Count ~ Total_Spring_Precip + (Years_Since_Burn * Years_Since_Mow) + (1|Year) + (1|Zone/Transect), data=Modeling_Variables, family=poisson),
  "Precip*(Burn*Mow)"=glmer(Exotic_Count ~ Total_Spring_Precip * (Years_Since_Burn * Years_Since_Mow) + (1|Year) + (1|Zone/Transect), data=Modeling_Variables, family=poisson))

#Compare Models
compare_performance(Exotic_Count_P_Combined_Models, rank=TRUE)
plot(compare_performance(Exotic_Count_P_Combined_Models))

#Select Best Model
Best_Exotic_Count_P_Model<-glmer(Exotic_Count ~ Total_Spring_Precip * (Years_Since_Burn * Years_Since_Mow) + (1|Year) + (1|Zone/Transect), data=Modeling_Variables, family=poisson)

#Clear Unneeded Items
rm(list=c("Exotic_Count_P_Combined_Models"))
```

### Negative Binomial Count

#### Model Structure

Models were run using the functions `glm.nb()` and `glmer.nb()` from the R package [MASS](https://cran.r-project.org/web/packages/MASS/MASS.pdf), as the response variable is a count variable.

##### Random Effect Selection

Transect, Zone, and Year are grouping variables that may need to be accounted for as mixed effects when running models. Zone has fewer than five levels so it should not be used as a random effect on its own, however, each Transect is nested within a Zone. To determine the best structure of random effects, possible random effect structures based on the study design were modeled and the model with the best fixed effect structure of the group was selected using the R package [performance](https://cran.r-project.org/web/packages/performance/performance.pdf) function `compare_performance()`.

```{r Exotic NB Count Random Model Selection, echo=TRUE}
#Run Models
Exotic_Count_NB_Random_Models<-list(
  "Intercept"=glm.nb(Exotic_Count ~ 1, data=Modeling_Variables),
  "Year"=glmer.nb(Exotic_Count ~ (1|Year), data=Modeling_Variables),
  "Transect"=glmer.nb(Exotic_Count ~ (1|Transect), data=Modeling_Variables),
  "Zone/Transect"=glmer.nb(Exotic_Count ~ (1|Zone/Transect), data=Modeling_Variables),
  "Year+Transect"=glmer.nb(Exotic_Count ~ (1|Year) + (1|Transect), data=Modeling_Variables),
  "Year+Zone/Transect"=glmer.nb(Exotic_Count ~ (1|Year) + (1|Zone/Transect), data=Modeling_Variables))

#Compare Models
compare_performance(Exotic_Count_NB_Random_Models, rank=TRUE)
plot(compare_performance(Exotic_Count_NB_Random_Models))

#Clear Unneeded Items
rm(list=c("Exotic_Count_NB_Random_Models"))
```

##### Fixed Effect Selection

Additive model selection was conducted after splitting the predictor variables into two groups: the "Climate" variables "Total Spring Precipitation" and "Date of Last Freeze" and the "Management" predictor variables "Years Since Last Burn" and "Years Since Last Mow".

For all variable groups, all possible fixed effect structures (including models of two-way interactions for the Climate and Management variables) were modeled, and the model with the best fixed effect structure of the group was selected using the R package [performance](https://cran.r-project.org/web/packages/performance/performance.pdf) function `compare_performance()`. To build a final model, all additive combinations of the best fixed effect structures from each group were modeled and the best model was selected.

##### Weather Variables

```{r Exotic NB Count Weather Model Selection, echo=TRUE}
#Run Models
Exotic_Count_NB_Weather_Models<-list(
  "Random"=glmer.nb(Exotic_Count ~ (1|Year) + (1|Zone/Transect), data=Modeling_Variables),
  "Precip"=glmer.nb(Exotic_Count ~ Total_Spring_Precip + (1|Year) + (1|Zone/Transect), data=Modeling_Variables),
  "Freeze"=glmer.nb(Exotic_Count ~ Last_Freeze + (1|Year) + (1|Zone/Transect), data=Modeling_Variables),
  "Precip+Freeze"=glmer.nb(Exotic_Count ~ Total_Spring_Precip + Last_Freeze + (1|Year) + (1|Zone/Transect), data=Modeling_Variables),
  "Precip*Freeze"=glmer.nb(Exotic_Count ~ Total_Spring_Precip * Last_Freeze + (1|Year) + (1|Zone/Transect), data=Modeling_Variables))

#Compare Models
compare_performance(Exotic_Count_NB_Weather_Models, rank=TRUE)
plot(compare_performance(Exotic_Count_NB_Weather_Models))

#Clear Unneeded Items
rm(list=c("Exotic_Count_NB_Weather_Models"))
```

##### Management Variables

```{r Exotic NB Count Management Model Selection, echo=TRUE}
#Run Models
Exotic_Count_NB_Manage_Models<-list(
  "Random"=glmer.nb(Exotic_Count ~ (1|Year) + (1|Zone/Transect), data=Modeling_Variables),
  "Burn"=glmer.nb(Exotic_Count ~ Years_Since_Burn + (1|Year) + (1|Zone/Transect), data=Modeling_Variables),
  "Mow"=glmer.nb(Exotic_Count ~ Years_Since_Mow + (1|Year) + (1|Zone/Transect), data=Modeling_Variables),
  "Burn+Mow"=glmer.nb(Exotic_Count ~ Years_Since_Burn + Years_Since_Mow + (1|Year) + (1|Zone/Transect), data=Modeling_Variables),
  "Burn*Mow"=glmer.nb(Exotic_Count ~ Years_Since_Burn * Years_Since_Mow + (1|Year) + (1|Zone/Transect), data=Modeling_Variables))

#Compare Models
compare_performance(Exotic_Count_NB_Manage_Models, rank=TRUE)
plot(compare_performance(Exotic_Count_NB_Manage_Models))

#Clear Unneeded Items
rm(list=c("Exotic_Count_NB_Manage_Models"))
```

##### Combining Variable Groups

```{r Exotic NB Count Combined Model Selection, echo=TRUE}
#Run Models
Exotic_Count_NB_Combined_Models<-list(
  "Random"=glmer.nb(Exotic_Count ~ (1|Year) + (1|Zone/Transect), data=Modeling_Variables),
  "Precip"=glmer.nb(Exotic_Count ~ Total_Spring_Precip + (1|Year) + (1|Zone/Transect), data=Modeling_Variables),
  "Mow"=glmer.nb(Exotic_Count ~ Years_Since_Mow + (1|Year) + (1|Zone/Transect), data=Modeling_Variables),
  "Precip+Mow"=glmer.nb(Exotic_Count ~ Total_Spring_Precip + Years_Since_Mow + (1|Year) + (1|Zone/Transect), data=Modeling_Variables),
  "Precip*Mow"=glmer.nb(Exotic_Count ~ Total_Spring_Precip * Years_Since_Mow + (1|Year) + (1|Zone/Transect), data=Modeling_Variables))

#Compare Models
compare_performance(Exotic_Count_NB_Combined_Models, rank=TRUE)
plot(compare_performance(Exotic_Count_NB_Combined_Models))

#Select Best Model
Best_Exotic_Count_NB_Model<-glmer.nb(Exotic_Count ~ Total_Spring_Precip + (1|Year) + (1|Zone/Transect), data=Modeling_Variables)

#Clear Unneeded Items
rm(list=c("Exotic_Count_NB_Combined_Models"))
```

### Binomial Proportion

#### Model Structure

Models were run using the functions `glm()` and `glmer()` from the R package [lme4](https://cran.r-project.org/web/packages/lme4/lme4.pdf) with family=Binomial, as the response variable is a proportion

##### Random Effect Selection

Transect, Zone, and Year are grouping variables that may need to be accounted for as mixed effects when running models. Zone has fewer than five levels so it should not be used as a random effect on its own, however, each Transect is nested within a Zone. To determine the best structure of random effects, possible random effect structures based on the study design were modeled and the model with the best fixed effect structure of the group was selected using the R package [performance](https://cran.r-project.org/web/packages/performance/performance.pdf) function `compare_performance()`.

```{r Exotic Binomial Proportion Random Model Selection, echo=TRUE}
#Run Models
Exotic_Binom_Prop_Random_Models<-list(
  "Intercept"=glm(cbind(Exotic_Count, Total_Count-Exotic_Count) ~ 1, data=Modeling_Variables, family=binomial),
  "Year"=glmer(cbind(Exotic_Count, Total_Count-Exotic_Count) ~ (1|Year), data=Modeling_Variables, family=binomial),
  "Transect"=glmer(cbind(Exotic_Count, Total_Count-Exotic_Count) ~ (1|Transect), data=Modeling_Variables, family=binomial),
  "Zone/Transect"=glmer(cbind(Exotic_Count, Total_Count-Exotic_Count) ~ (1|Zone/Transect), data=Modeling_Variables, family=binomial),
  "Year+Transect"=glmer(cbind(Exotic_Count, Total_Count-Exotic_Count) ~ (1|Year) + (1|Transect), data=Modeling_Variables, family=binomial),
  "Year+Zone/Transect"=glmer(cbind(Exotic_Count, Total_Count-Exotic_Count) ~ (1|Year) + (1|Zone/Transect), data=Modeling_Variables, family=binomial))

#Compare Models
compare_performance(Exotic_Binom_Prop_Random_Models, rank=TRUE)
plot(compare_performance(Exotic_Binom_Prop_Random_Models))

#Clear Unneeded Items
rm(list=c("Exotic_Binom_Prop_Random_Models"))
```

##### Fixed Effect Selection

Additive model selection was conducted after splitting the predictor variables into two groups: the "Climate" variables "Total Spring Precipitation" and "Date of Last Freeze" and the "Management" predictor variables "Years Since Last Burn" and "Years Since Last Mow".

For all variable groups, all possible fixed effect structures (including models of two-way interactions for the Climate and Management variables) were modeled, and the model with the best fixed effect structure of the group was selected using the R package [performance](https://cran.r-project.org/web/packages/performance/performance.pdf) function `compare_performance()`. To build a final model, all additive combinations of the best fixed effect structures from each group were modeled and the best model was selected.

##### Weather Variables

```{r Exotic Binomial Proportion Weather Model Selection, echo=TRUE}
#Run Models
Exotic_Binom_Prop_Weather_Models<-list(
  "Random"=glmer(cbind(Exotic_Count, Total_Count-Exotic_Count) ~ (1|Year) + (1|Zone/Transect), data=Modeling_Variables, family=binomial),
  "Precip"=glmer(cbind(Exotic_Count, Total_Count-Exotic_Count) ~ Total_Spring_Precip + (1|Year) + (1|Zone/Transect), data=Modeling_Variables, family=binomial),
  "Freeze"=glmer(cbind(Exotic_Count, Total_Count-Exotic_Count) ~ Last_Freeze + (1|Year) + (1|Zone/Transect), data=Modeling_Variables, family=binomial),
  "Precip+Freeze"=glmer(cbind(Exotic_Count, Total_Count-Exotic_Count) ~ Total_Spring_Precip + Last_Freeze + (1|Year) + (1|Zone/Transect), data=Modeling_Variables, family=binomial),
  "Precip*Freeze"=glmer(cbind(Exotic_Count, Total_Count-Exotic_Count) ~ Total_Spring_Precip * Last_Freeze + (1|Year) + (1|Zone/Transect), data=Modeling_Variables, family=binomial))

#Compare Models
compare_performance(Exotic_Binom_Prop_Weather_Models, rank=TRUE)
plot(compare_performance(Exotic_Binom_Prop_Weather_Models))

#Clear Unneeded Items
rm(list=c("Exotic_Binom_Prop_Weather_Models"))
```

##### Management Variables

```{r Exotic Binomial Proportion Management Model Selection, echo=TRUE}
#Run Models
Exotic_Binom_Prop_Manage_Models<-list(
  "Random"=glmer(cbind(Exotic_Count, Total_Count-Exotic_Count) ~ (1|Year) + (1|Zone/Transect), data=Modeling_Variables, family=binomial),
  "Burn"=glmer(cbind(Exotic_Count, Total_Count-Exotic_Count) ~ Years_Since_Burn + (1|Year) + (1|Zone/Transect), data=Modeling_Variables, family=binomial),
  "Mow"=glmer(cbind(Exotic_Count, Total_Count-Exotic_Count) ~ Years_Since_Mow + (1|Year) + (1|Zone/Transect), data=Modeling_Variables, family=binomial),
  "Burn+Mow"=glmer(cbind(Exotic_Count, Total_Count-Exotic_Count) ~ Years_Since_Burn + Years_Since_Mow + (1|Year) + (1|Zone/Transect), data=Modeling_Variables, family=binomial),
  "Burn*Mow"=glmer(cbind(Exotic_Count, Total_Count-Exotic_Count) ~ Years_Since_Burn * Years_Since_Mow + (1|Year) + (1|Zone/Transect), data=Modeling_Variables, family=binomial))

#Compare Models
compare_performance(Exotic_Binom_Prop_Manage_Models, rank=TRUE)
plot(compare_performance(Exotic_Binom_Prop_Manage_Models))

#Clear Unneeded Items
rm(list=c("Exotic_Binom_Prop_Manage_Models"))
```

##### Combining Variable Groups

```{r Exotic Binomial Proportion Combined Model Selection, echo=TRUE}
#Run Models
Exotic_Binom_Prop_Combined_Models<-list(
  "Random"=glmer(cbind(Exotic_Count, Total_Count-Exotic_Count) ~ (1|Year) + (1|Zone/Transect), data=Modeling_Variables, family=binomial),
  "Precip"=glmer(cbind(Exotic_Count, Total_Count-Exotic_Count) ~ Total_Spring_Precip + (1|Year) + (1|Zone/Transect), data=Modeling_Variables, family=binomial),
  "Burn"=glmer(cbind(Exotic_Count, Total_Count-Exotic_Count) ~ Years_Since_Burn + (1|Year) + (1|Zone/Transect), data=Modeling_Variables, family=binomial),
  "Precip+Burn"=glmer(cbind(Exotic_Count, Total_Count-Exotic_Count) ~ Total_Spring_Precip + Years_Since_Burn + (1|Year) + (1|Zone/Transect), data=Modeling_Variables, family=binomial),
  "Precip*Burn"=glmer(cbind(Exotic_Count, Total_Count-Exotic_Count) ~ Total_Spring_Precip * Years_Since_Burn + (1|Year) + (1|Zone/Transect), data=Modeling_Variables, family=binomial))

#Compare Models
compare_performance(Exotic_Binom_Prop_Combined_Models, rank=TRUE)
plot(compare_performance(Exotic_Binom_Prop_Combined_Models))

#Select Best Model
Best_Exotic_Binom_Prop_Model<-glmer(cbind(Exotic_Count, Total_Count-Exotic_Count) ~ Total_Spring_Precip + (1|Year) + (1|Zone/Transect), data=Modeling_Variables, family=binomial)

#Clear Unneeded Items
rm(list=c("Exotic_Binom_Prop_Combined_Models"))
```

### Overall Best Exotic Model

#### Model Selection

```{r Best Overall Exotic Model, echo=TRUE}
#Run Models
Exotic_All_Models<-list(
  "Linear Percentage"=Best_Exotic_Percent_Model,
  "Poisson Count"=Best_Exotic_Count_P_Model,
  "Negative Binomial Count"=Best_Exotic_Count_NB_Model,
  "Binomial Proportion"=Best_Exotic_Binom_Prop_Model)

#Compare Models
compare_performance(Exotic_All_Models, rank=TRUE)
plot(compare_performance(Exotic_All_Models))
```

#### Model Summary

```{r Overall Best Exotic Model}
#Select Best Model
Best_Exotic_Model<-Best_Exotic_Count_NB_Model

#Model Summary
summary(Best_Exotic_Model)
model_performance(Best_Exotic_Model)

#Fancy Model Table
tab_model(Best_Exotic_Model, dv.labels="Number of Exotic Plants")

#Best Model Report
report(Best_Exotic_Model)

#Clear Unneeded Items
rm(list=c("Exotic_All_Models", "Best_Exotic_Percent_Model", "Best_Exotic_Count_P_Model", "Best_Exotic_Count_NB_Model", "Best_Exotic_Binom_Prop_Model"))
```

#### Model Diagnostics

```{r Best Exotic Model Diagnostics}
#Diagnostic Tests
plot(simulateResiduals(fittedModel=Best_Exotic_Model), title="Number of Exotic Plants")

#Save DHARMa Plot
tiff("Output/Exotic_DHARMa.tif", width=8, height=4, units="in", res=300)
plot(simulateResiduals(fittedModel=Best_Exotic_Model), title="E Number of Exotic Plants")
invisible(dev.off())
```

#### Effect Plots

```{r Best Exotic Model Effects Plots}
#Fixed Effects Coefficients Plot
Exotic_Effects<-plot(parameters(Best_Exotic_Model, effects="fixed"))
Exotic_Effects

#Effects Plot
plot(allEffects(Best_Exotic_Model), main="", multiline=TRUE)

#Print Effects Plot
tiff("Output/Exotic_Model_Effects.tif", width=10, height=5, units="in", res=300, bg="transparent")
plot(allEffects(Best_Exotic_Model), main="", multiline=TRUE)
invisible(dev.off())
```

## Robinia

### Percent

#### Model Structure

Models were run using the functions `lm()` and `lmer()` from the R package [lme4](https://cran.r-project.org/web/packages/lme4/lme4.pdf), as the response variable is a percentage.

##### Random Effect Selection

Transect, Zone, and Year are grouping variables that may need to be accounted for as mixed effects when running models. Zone has fewer than five levels so it should not be used as a random effect on its own, however, each Transect is nested within a Zone. To determine the best structure of random effects, possible random effect structures based on the study design were modeled and the model with the best fixed effect structure of the group was selected using the R package [performance](https://cran.r-project.org/web/packages/performance/performance.pdf) function `compare_performance()`.

```{r Robinia Random Model Selection, echo=TRUE}
#Run Models
Robinia_Percent_Random_Models<-list(
  "Intercept"=lm(Percent_Robinia ~ 1, data=Modeling_Variables),
  "Year"=lmer(Percent_Robinia ~ (1|Year), data=Modeling_Variables),
  "Transect"=lmer(Percent_Robinia ~ (1|Transect), data=Modeling_Variables),
  "Zone/Transect"=lmer(Percent_Robinia ~ (1|Zone/Transect), data=Modeling_Variables),
  "Year+Transect"=lmer(Percent_Robinia ~ (1|Year) + (1|Transect), data=Modeling_Variables),
  "Year+Zone/Transect"=lmer(Percent_Robinia ~ (1|Year) + (1|Zone/Transect), data=Modeling_Variables))

#Compare Models
compare_performance(Robinia_Percent_Random_Models, rank=TRUE)
plot(compare_performance(Robinia_Percent_Random_Models))

#Clear Unneeded Items
rm(list=c("Robinia_Percent_Random_Models"))
```

##### Fixed Effect Selection

Additive model selection was conducted after splitting the predictor variables into two groups: the "Climate" variables "Total Spring Precipitation" and "Date of Last Freeze" and the "Management" predictor variables "Years Since Last Burn", "Years Since Last Mow", and "Years Since Cut".

For all variable groups, all possible fixed effect structures (including models of two-way interactions for the Climate and Management variables) were modeled, and the model with the best fixed effect structure of the group was selected using the R package [performance](https://cran.r-project.org/web/packages/performance/performance.pdf) function `compare_performance()`. To build a final model, all additive combinations of the best fixed effect structures from each group were modeled and the best model was selected.

##### Weather Variables

```{r Robinia Weather Model Selection, echo=TRUE}
#Run Models
Robinia_Percent_Weather_Models<-list(
  "Random"=lmer(Percent_Robinia ~ (1|Year) + (1|Transect), data=Modeling_Variables),
  "Precip"=lmer(Percent_Robinia ~ Total_Spring_Precip + (1|Year) + (1|Transect), data=Modeling_Variables),
  "Freeze"=lmer(Percent_Robinia ~ Last_Freeze + (1|Year) + (1|Transect), data=Modeling_Variables),
  "Precip+Freeze"=lmer(Percent_Robinia ~ Total_Spring_Precip + Last_Freeze + (1|Year) + (1|Transect), data=Modeling_Variables),
  "Precip*Freeze"=lmer(Percent_Robinia ~ Total_Spring_Precip * Last_Freeze + (1|Year) + (1|Transect), data=Modeling_Variables))

#Compare Models
compare_performance(Robinia_Percent_Weather_Models, rank=TRUE)
plot(compare_performance(Robinia_Percent_Weather_Models))

#Clear Unneeded Items
rm(list=c("Robinia_Percent_Weather_Models"))
```

##### Management Variables

```{r Robinia Management Model Selection, echo=TRUE}
#Run Models
Robinia_Percent_Manage_Models<-list(
  "Random"=lmer(Percent_Robinia ~ (1|Year) + (1|Transect), data=Modeling_Variables),
  "Burn"=lmer(Percent_Robinia ~ Years_Since_Burn + (1|Year) + (1|Transect), data=Modeling_Variables),
  "Mow"=lmer(Percent_Robinia ~ Years_Since_Mow + (1|Year) + (1|Transect), data=Modeling_Variables),
  "Cut"=lmer(Percent_Robinia ~ Years_Since_Cut + (1|Year) + (1|Transect), data=Modeling_Variables),
  "Burn+Mow"=lmer(Percent_Robinia ~ Years_Since_Burn + Years_Since_Mow + (1|Year) + (1|Transect), data=Modeling_Variables),
  "Burn+Cut"=lmer(Percent_Robinia ~ Years_Since_Burn + Years_Since_Cut + (1|Year) + (1|Transect), data=Modeling_Variables),
  "Mow+Cut"=lmer(Percent_Robinia ~ Years_Since_Mow + Years_Since_Cut + (1|Year) + (1|Transect), data=Modeling_Variables),
  "Burn*Mow"=lmer(Percent_Robinia ~ Years_Since_Burn * Years_Since_Mow + (1|Year) + (1|Transect), data=Modeling_Variables),
  "Burn*Cut"=lmer(Percent_Robinia ~ Years_Since_Burn * Years_Since_Cut + (1|Year) + (1|Transect), data=Modeling_Variables),
  "Mow*Cut"=lmer(Percent_Robinia ~ Years_Since_Mow * Years_Since_Cut + (1|Year) + (1|Transect), data=Modeling_Variables),
  "Burn+Mow+Cut"=lmer(Percent_Robinia ~ Years_Since_Burn + Years_Since_Mow + Years_Since_Cut + (1|Year) + (1|Transect), data=Modeling_Variables),
  "Burn*Mow*Cut"=lmer(Percent_Robinia ~ Years_Since_Burn * Years_Since_Mow * Years_Since_Cut + (1|Year) + (1|Transect), data=Modeling_Variables))

#Compare Models
compare_performance(Robinia_Percent_Manage_Models, rank=TRUE)
plot(compare_performance(Robinia_Percent_Manage_Models))

#Clear Unneeded Items
rm(list=c("Robinia_Percent_Manage_Models"))
```

##### Combining Variable Groups

```{r Robinia Combined Model Selection, echo=TRUE}
#Run Models
Robinia_Percent_Combined_Models<-list(
  "Random"=lmer(Percent_Robinia ~ (1|Year) + (1|Transect), data=Modeling_Variables),
  "Freeze"=lmer(Percent_Robinia ~  Last_Freeze + (1|Year) + (1|Transect), data=Modeling_Variables),
  "Burn*Cut"=lmer(Percent_Robinia ~ Years_Since_Burn * Years_Since_Cut + (1|Year) + (1|Transect), data=Modeling_Variables),
  "Freeze+(Burn*Cut)"=lmer(Percent_Robinia ~  Last_Freeze + (Years_Since_Burn * Years_Since_Cut)+ (1|Year) + (1|Transect), data=Modeling_Variables),
  "Freeze*(Burn*Cut)"=lmer(Percent_Robinia ~  Last_Freeze * (Years_Since_Burn * Years_Since_Cut)+ (1|Year) + (1|Transect), data=Modeling_Variables))

#Compare Models
compare_performance(Robinia_Percent_Combined_Models, rank=TRUE)
plot(compare_performance(Robinia_Percent_Combined_Models))

#Select Best Model
Best_Robinia_Percent_Model<-lmer(Percent_Robinia ~ Years_Since_Burn * Years_Since_Cut + (1|Year) + (1|Transect), data=Modeling_Variables)

#Clear Unneeded Items
rm(list=c("Robinia_Percent_Combined_Models"))
```

### Poisson Count

#### Model Structure

Models were run using the functions `glm()` and `glmer()` from the R package [lme4](https://cran.r-project.org/web/packages/lme4/lme4.pdf) with family=Poisson, as the response variable is a count variable.

##### Random Effect Selection

Transect, Zone, and Year are grouping variables that may need to be accounted for as mixed effects when running models. Zone has fewer than five levels so it should not be used as a random effect on its own, however, each Transect is nested within a Zone. To determine the best structure of random effects, possible random effect structures based on the study design were modeled and the model with the best fixed effect structure of the group was selected using the R package [performance](https://cran.r-project.org/web/packages/performance/performance.pdf) function `compare_performance()`.

```{r Robinia Count Random Model Selection, echo=TRUE}
#Run Models
Robinia_Count_P_Random_Models<-list(
  "Intercept"=glm(Robinia_Count ~ 1, data=Modeling_Variables, family=poisson),
  "Year"=glmer(Robinia_Count ~ (1|Year), data=Modeling_Variables, family=poisson),
  "Transect"=glmer(Robinia_Count ~ (1|Transect), data=Modeling_Variables, family=poisson),
  "Zone/Transect"=glmer(Robinia_Count ~ (1|Zone/Transect), data=Modeling_Variables, family=poisson),
  "Year+Transect"=glmer(Robinia_Count ~ (1|Year) + (1|Transect), data=Modeling_Variables, family=poisson),
  "Year+Zone/Transect"=glmer(Robinia_Count ~ (1|Year) + (1|Zone/Transect), data=Modeling_Variables, family=poisson))

#Compare Models
compare_performance(Robinia_Count_P_Random_Models, rank=TRUE)
plot(compare_performance(Robinia_Count_P_Random_Models))

#Clear Unneeded Items
rm(list=c("Robinia_Count_P_Random_Models"))
```

##### Fixed Effect Selection

Additive model selection was conducted after splitting the predictor variables into two groups: the "Climate" variables "Total Spring Precipitation" and "Date of Last Freeze" and the "Management" predictor variables "Years Since Last Burn", "Years Since Last Mow", and "Years Since Cut".

For all variable groups, all possible fixed effect structures (including models of two-way interactions for the Climate and Management variables) were modeled, and the model with the best fixed effect structure of the group was selected using the R package [performance](https://cran.r-project.org/web/packages/performance/performance.pdf) function `compare_performance()`. To build a final model, all additive combinations of the best fixed effect structures from each group were modeled and the best model was selected.

##### Weather Variables

```{r Robinia Count Weather Model Selection, echo=TRUE}
#Run Models
Robinia_Count_P_Weather_Models<-list(
  "Random"=glmer(Robinia_Count ~ (1|Year) + (1|Transect), data=Modeling_Variables, family=poisson),
  "Precip"=glmer(Robinia_Count ~ Total_Spring_Precip + (1|Year) + (1|Transect), data=Modeling_Variables, family=poisson),
  "Freeze"=glmer(Robinia_Count ~ Last_Freeze + (1|Year) + (1|Transect), data=Modeling_Variables, family=poisson),
  "Precip+Freeze"=glmer(Robinia_Count ~ Total_Spring_Precip + Last_Freeze + (1|Year) + (1|Transect), data=Modeling_Variables, family=poisson),
  "Precip*Freeze"=glmer(Robinia_Count ~ Total_Spring_Precip * Last_Freeze + (1|Year) + (1|Transect), data=Modeling_Variables, family=poisson))

#Compare Models
compare_performance(Robinia_Count_P_Weather_Models, rank=TRUE)
plot(compare_performance(Robinia_Count_P_Weather_Models))

#Clear Unneeded Items
rm(list=c("Robinia_Count_P_Weather_Models"))
```

##### Management Variables

```{r Robinia Count Management Model Selection, echo=TRUE}
#Run Models
Robinia_Count_P_Manage_Models<-list(
  "Random"=glmer(Robinia_Count ~ (1|Year) + (1|Transect), data=Modeling_Variables, family=poisson),
  "Burn"=glmer(Robinia_Count ~ Years_Since_Burn + (1|Year) + (1|Transect), data=Modeling_Variables, family=poisson),
  "Mow"=glmer(Robinia_Count ~ Years_Since_Mow + (1|Year) + (1|Transect), data=Modeling_Variables, family=poisson),
  "Cut"=glmer(Robinia_Count ~ Years_Since_Cut + (1|Year) + (1|Transect), data=Modeling_Variables, family=poisson),
  "Burn+Mow"=glmer(Robinia_Count ~ Years_Since_Burn + Years_Since_Mow + (1|Year) + (1|Transect), data=Modeling_Variables, family=poisson),
  "Burn+Cut"=glmer(Robinia_Count ~ Years_Since_Burn + Years_Since_Cut + (1|Year) + (1|Transect), data=Modeling_Variables, family=poisson),
  "Mow+Cut"=glmer(Robinia_Count ~ Years_Since_Mow + Years_Since_Cut + (1|Year) + (1|Transect), data=Modeling_Variables, family=poisson),
  "Burn*Mow"=glmer(Robinia_Count ~ Years_Since_Burn * Years_Since_Mow + (1|Year) + (1|Transect), data=Modeling_Variables, family=poisson),
  "Burn*Cut"=glmer(Robinia_Count ~ Years_Since_Burn * Years_Since_Cut + (1|Year) + (1|Transect), data=Modeling_Variables, family=poisson),
  "Mow*Cut"=glmer(Robinia_Count ~ Years_Since_Mow * Years_Since_Cut + (1|Year) + (1|Transect), data=Modeling_Variables, family=poisson),
  "Burn+Mow+Cut"=glmer(Robinia_Count ~ Years_Since_Burn + Years_Since_Mow + Years_Since_Cut + (1|Year) + (1|Transect), data=Modeling_Variables, family=poisson),
  "Burn*Mow*Cut"=glmer(Robinia_Count ~ Years_Since_Burn * Years_Since_Mow * Years_Since_Cut + (1|Year) + (1|Transect), data=Modeling_Variables, family=poisson))

#Compare Models
compare_performance(Robinia_Count_P_Manage_Models, rank=TRUE)
plot(compare_performance(Robinia_Count_P_Manage_Models))

#Clear Unneeded Items
rm(list=c("Robinia_Count_P_Manage_Models"))
```

##### Combining Variable Groups

```{r Robinia Count Combined Model Selection, echo=TRUE}
#Run Models
Robinia_Count_P_Combined_Models<-list(
  "Random"=glmer(Robinia_Count ~ (1|Year) + (1|Transect), data=Modeling_Variables, family=poisson),
  "Precip"=glmer(Robinia_Count ~ Total_Spring_Precip + (1|Year) + (1|Transect), data=Modeling_Variables, family=poisson),
  "Mow*Cut"=glmer(Robinia_Count ~ Years_Since_Mow * Years_Since_Cut + (1|Year) + (1|Transect), data=Modeling_Variables, family=poisson),
  "Precip+(Mow*Cut)"=glmer(Robinia_Count ~ Total_Spring_Precip + (Years_Since_Mow * Years_Since_Cut) + (1|Year) + (1|Transect), data=Modeling_Variables, family=poisson),
  "Precip*(Mow*Cut)"=glmer(Robinia_Count ~ Total_Spring_Precip * (Years_Since_Mow * Years_Since_Cut) + (1|Year) + (1|Transect), data=Modeling_Variables, family=poisson))

#Compare Models
compare_performance(Robinia_Count_P_Combined_Models, rank=TRUE)
plot(compare_performance(Robinia_Count_P_Combined_Models))

#Select Best Model
Best_Robinia_Count_P_Model<-glmer(Robinia_Count ~ Total_Spring_Precip + (Years_Since_Mow * Years_Since_Cut) + (1|Year) + (1|Transect), data=Modeling_Variables, family=poisson)

#Clear Unneeded Items
rm(list=c("Robinia_Count_P_Combined_Models"))
```

### Negative Binomial Count

#### Model Structure

Models were run using the functions `glm.nb()` and `glmer.nb()` from the R package [MASS](https://cran.r-project.org/web/packages/MASS/MASS.pdf), as the response variable is a count variable.

##### Random Effect Selection

Transect, Zone, and Year are grouping variables that may need to be accounted for as mixed effects when running models. Zone has fewer than five levels so it should not be used as a random effect on its own, however, each Transect is nested within a Zone. To determine the best structure of random effects, possible random effect structures based on the study design were modeled and the model with the best fixed effect structure of the group was selected using the R package [performance](https://cran.r-project.org/web/packages/performance/performance.pdf) function `compare_performance()`.

```{r Robinia NB Count Random Model Selection, echo=TRUE}
#Run Models
Robinia_Count_NB_Random_Models<-list(
  "Intercept"=glm.nb(Robinia_Count ~ 1, data=Modeling_Variables),
  "Year"=glmer.nb(Robinia_Count ~ (1|Year), data=Modeling_Variables),
  "Transect"=glmer.nb(Robinia_Count ~ (1|Transect), data=Modeling_Variables),
  "Zone/Transect"=glmer.nb(Robinia_Count ~ (1|Zone/Transect), data=Modeling_Variables),
  "Year+Transect"=glmer.nb(Robinia_Count ~ (1|Year) + (1|Transect), data=Modeling_Variables),
  "Year+Zone/Transect"=glmer.nb(Robinia_Count ~ (1|Year) + (1|Zone/Transect), data=Modeling_Variables))

#Compare Models
compare_performance(Robinia_Count_NB_Random_Models, rank=TRUE)
plot(compare_performance(Robinia_Count_NB_Random_Models))

#Clear Unneeded Items
rm(list=c("Robinia_Count_NB_Random_Models"))
```

##### Fixed Effect Selection

Additive model selection was conducted after splitting the predictor variables into two groups: the "Climate" variables "Total Spring Precipitation" and "Date of Last Freeze" and the "Management" predictor variables "Years Since Last Burn", "Years Since Last Mow", and "Years Since Cut".

For all variable groups, all possible fixed effect structures (including models of two-way interactions for the Climate and Management variables) were modeled, and the model with the best fixed effect structure of the group was selected using the R package [performance](https://cran.r-project.org/web/packages/performance/performance.pdf) function `compare_performance()`. To build a final model, all additive combinations of the best fixed effect structures from each group were modeled and the best model was selected.

##### Weather Variables

```{r Robinia NB Count Weather Model Selection, echo=TRUE}
#Run Models
Robinia_Count_NB_Weather_Models<-list(
  "Random"=glmer.nb(Robinia_Count ~ (1|Year) + (1|Transect), data=Modeling_Variables),
  "Precip"=glmer.nb(Robinia_Count ~ Total_Spring_Precip + (1|Year) + (1|Transect), data=Modeling_Variables),
  "Freeze"=glmer.nb(Robinia_Count ~ Last_Freeze + (1|Year) + (1|Transect), data=Modeling_Variables),
  "Precip+Freeze"=glmer.nb(Robinia_Count ~ Total_Spring_Precip + Last_Freeze + (1|Year) + (1|Transect), data=Modeling_Variables),
  "Precip*Freeze"=glmer.nb(Robinia_Count ~ Total_Spring_Precip * Last_Freeze + (1|Year) + (1|Transect), data=Modeling_Variables))

#Compare Models
compare_performance(Robinia_Count_NB_Weather_Models, rank=TRUE)
plot(compare_performance(Robinia_Count_NB_Weather_Models))

#Clear Unneeded Items
rm(list=c("Robinia_Count_NB_Weather_Models"))
```

##### Management Variables

```{r Robinia NB Count Management Model Selection, echo=TRUE}
#Run Models
Robinia_Count_NB_Manage_Models<-list(
  "Random"=glmer.nb(Robinia_Count ~ (1|Year) + (1|Transect), data=Modeling_Variables),
  "Burn"=glmer.nb(Robinia_Count ~ Years_Since_Burn + (1|Year) + (1|Transect), data=Modeling_Variables),
  "Mow"=glmer.nb(Robinia_Count ~ Years_Since_Mow + (1|Year) + (1|Transect), data=Modeling_Variables),
  "Cut"=glmer.nb(Robinia_Count ~ Years_Since_Cut + (1|Year) + (1|Transect), data=Modeling_Variables),
  "Burn+Mow"=glmer.nb(Robinia_Count ~ Years_Since_Burn + Years_Since_Mow + (1|Year) + (1|Transect), data=Modeling_Variables),
  "Burn+Cut"=glmer.nb(Robinia_Count ~ Years_Since_Burn + Years_Since_Cut + (1|Year) + (1|Transect), data=Modeling_Variables),
  "Mow+Cut"=glmer.nb(Robinia_Count ~ Years_Since_Mow + Years_Since_Cut + (1|Year) + (1|Transect), data=Modeling_Variables),
  "Burn*Mow"=glmer.nb(Robinia_Count ~ Years_Since_Burn * Years_Since_Mow + (1|Year) + (1|Transect), data=Modeling_Variables),
  "Burn*Cut"=glmer.nb(Robinia_Count ~ Years_Since_Burn * Years_Since_Cut + (1|Year) + (1|Transect), data=Modeling_Variables),
  "Mow*Cut"=glmer.nb(Robinia_Count ~ Years_Since_Mow * Years_Since_Cut + (1|Year) + (1|Transect), data=Modeling_Variables),
  "Burn+Mow+Cut"=glmer.nb(Robinia_Count ~ Years_Since_Burn + Years_Since_Mow + Years_Since_Cut + (1|Year) + (1|Transect), data=Modeling_Variables),
  "Burn*Mow*Cut"=glmer.nb(Robinia_Count ~ Years_Since_Burn * Years_Since_Mow * Years_Since_Cut + (1|Year) + (1|Transect), data=Modeling_Variables))

#Compare Models
compare_performance(Robinia_Count_NB_Manage_Models, rank=TRUE)
plot(compare_performance(Robinia_Count_NB_Manage_Models))

#Clear Unneeded Items
rm(list=c("Robinia_Count_NB_Manage_Models"))
```

##### Combining Variable Groups

```{r Robinia NB Count Combined Model Selection, echo=TRUE}
#Run Models
Robinia_Count_NB_Combined_Models<-list(
  "Random"=glmer.nb(Robinia_Count ~ (1|Year) + (1|Transect), data=Modeling_Variables),
  "Precip"=glmer.nb(Robinia_Count ~ Total_Spring_Precip + (1|Year) + (1|Transect), data=Modeling_Variables),
  "Mow*Cut"=glmer.nb(Robinia_Count ~ Years_Since_Mow * Years_Since_Cut + (1|Year) + (1|Transect), data=Modeling_Variables),
  "Precip+(Mow*Cut)"=glmer.nb(Robinia_Count ~ Total_Spring_Precip + (Years_Since_Mow * Years_Since_Cut) + (1|Year) + (1|Transect), data=Modeling_Variables),
  "Precip*(Mow*Cut)"=glmer.nb(Robinia_Count ~ Total_Spring_Precip + (Years_Since_Mow * Years_Since_Cut) + (1|Year) + (1|Transect), data=Modeling_Variables))

#Compare Models
compare_performance(Robinia_Count_NB_Combined_Models, rank=TRUE)
plot(compare_performance(Robinia_Count_NB_Combined_Models))

#Select Best Model
Best_Robinia_Count_NB_Model<-glmer.nb(Robinia_Count ~ Total_Spring_Precip + (Years_Since_Mow * Years_Since_Cut) + (1|Year) + (1|Transect), data=Modeling_Variables)

#Clear Unneeded Items
rm(list=c("Robinia_Count_NB_Combined_Models"))
```

### Binomial Proportion

#### Model Structure

Models were run using the functions `glm()` and `glmer()` from the R package [lme4](https://cran.r-project.org/web/packages/lme4/lme4.pdf) with family=Binomial, as the response variable is a proportion

##### Random Effect Selection

Transect, Zone, and Year are grouping variables that may need to be accounted for as mixed effects when running models. Zone has fewer than five levels so it should not be used as a random effect on its own, however, each Transect is nested within a Zone. To determine the best structure of random effects, possible random effect structures based on the study design were modeled and the model with the best fixed effect structure of the group was selected using the R package [performance](https://cran.r-project.org/web/packages/performance/performance.pdf) function `compare_performance()`.

```{r Robinia Binomial Proportion Random Model Selection, echo=TRUE}
#Run Models
Robinia_Binom_Prop_Random_Models<-list(
  "Intercept"=glm(cbind(Robinia_Count, Total_Count-Robinia_Count) ~ 1, data=Modeling_Variables, family=binomial),
  "Year"=glmer(cbind(Robinia_Count, Total_Count-Robinia_Count) ~ (1|Year), data=Modeling_Variables, family=binomial),
  "Transect"=glmer(cbind(Robinia_Count, Total_Count-Robinia_Count) ~ (1|Transect), data=Modeling_Variables, family=binomial),
  "Zone/Transect"=glmer(cbind(Robinia_Count, Total_Count-Robinia_Count) ~ (1|Zone/Transect), data=Modeling_Variables, family=binomial),
  "Year+Transect"=glmer(cbind(Robinia_Count, Total_Count-Robinia_Count) ~ (1|Year) + (1|Transect), data=Modeling_Variables, family=binomial),
  "Year+Zone/Transect"=glmer(cbind(Robinia_Count, Total_Count-Robinia_Count) ~ (1|Year) + (1|Zone/Transect), data=Modeling_Variables, family=binomial))

#Compare Models
compare_performance(Robinia_Binom_Prop_Random_Models, rank=TRUE)
plot(compare_performance(Robinia_Binom_Prop_Random_Models))

#Clear Unneeded Items
rm(list=c("Robinia_Binom_Prop_Random_Models"))
```

##### Fixed Effect Selection

Additive model selection was conducted after splitting the predictor variables into two groups: the "Climate" variables "Total Spring Precipitation" and "Date of Last Freeze" and the "Management" predictor variables "Years Since Last Burn", "Years Since Last Mow", and "Years Since Cut".

For all variable groups, all possible fixed effect structures (including models of two-way interactions for the Climate and Management variables) were modeled, and the model with the best fixed effect structure of the group was selected using the R package [performance](https://cran.r-project.org/web/packages/performance/performance.pdf) function `compare_performance()`. To build a final model, all additive combinations of the best fixed effect structures from each group were modeled and the best model was selected.

##### Weather Variables

```{r Robinia Binomial Proportion Weather Model Selection, echo=TRUE}
#Run Models
Robinia_Binom_Prop_Weather_Models<-list(
  "Random"=glmer(cbind(Robinia_Count, Total_Count-Robinia_Count) ~ (1|Year) + (1|Transect), data=Modeling_Variables, family=binomial),
  "Precip"=glmer(cbind(Robinia_Count, Total_Count-Robinia_Count) ~ Total_Spring_Precip + (1|Year) + (1|Transect), data=Modeling_Variables, family=binomial),
  "Freeze"=glmer(cbind(Robinia_Count, Total_Count-Robinia_Count) ~ Last_Freeze + (1|Year) + (1|Transect), data=Modeling_Variables, family=binomial),
  "Precip+Freeze"=glmer(cbind(Robinia_Count, Total_Count-Robinia_Count) ~ Total_Spring_Precip + Last_Freeze + (1|Year) + (1|Transect), data=Modeling_Variables, family=binomial),
  "Precip*Freeze"=glmer(cbind(Robinia_Count, Total_Count-Robinia_Count) ~ Total_Spring_Precip * Last_Freeze + (1|Year) + (1|Transect), data=Modeling_Variables, family=binomial))

#Compare Models
compare_performance(Robinia_Binom_Prop_Weather_Models, rank=TRUE)
plot(compare_performance(Robinia_Binom_Prop_Weather_Models))

#Clear Unneeded Items
rm(list=c("Robinia_Binom_Prop_Weather_Models"))
```

##### Management Variables

```{r Robinia Binomial Proportion Management Model Selection, echo=TRUE}
#Run Models
Robinia_Binom_Prop_Manage_Models<-list(
  "Random"=glmer(cbind(Robinia_Count, Total_Count-Robinia_Count) ~ (1|Year) + (1|Transect), data=Modeling_Variables, family=binomial),
  "Burn"=glmer(cbind(Robinia_Count, Total_Count-Robinia_Count) ~ Years_Since_Burn + (1|Year) + (1|Transect), data=Modeling_Variables, family=binomial),
  "Mow"=glmer(cbind(Robinia_Count, Total_Count-Robinia_Count) ~ Years_Since_Mow + (1|Year) + (1|Transect), data=Modeling_Variables, family=binomial),
  "Cut"=glmer(cbind(Robinia_Count, Total_Count-Robinia_Count) ~ Years_Since_Cut + (1|Year) + (1|Transect), data=Modeling_Variables, family=binomial),
  "Burn+Mow"=glmer(cbind(Robinia_Count, Total_Count-Robinia_Count) ~ Years_Since_Burn + Years_Since_Mow + (1|Year) + (1|Transect), data=Modeling_Variables, family=binomial),
  "Burn+Cut"=glmer(cbind(Robinia_Count, Total_Count-Robinia_Count) ~ Years_Since_Burn + Years_Since_Cut + (1|Year) + (1|Transect), data=Modeling_Variables, family=binomial),
  "Mow+Cut"=glmer(cbind(Robinia_Count, Total_Count-Robinia_Count) ~ Years_Since_Mow + Years_Since_Cut + (1|Year) + (1|Transect), data=Modeling_Variables, family=binomial),
  "Burn*Mow"=glmer(cbind(Robinia_Count, Total_Count-Robinia_Count) ~ Years_Since_Burn * Years_Since_Mow + (1|Year) + (1|Transect), data=Modeling_Variables, family=binomial),
  "Burn*Cut"=glmer(cbind(Robinia_Count, Total_Count-Robinia_Count) ~ Years_Since_Burn * Years_Since_Cut + (1|Year) + (1|Transect), data=Modeling_Variables, family=binomial),
  "Mow*Cut"=glmer(cbind(Robinia_Count, Total_Count-Robinia_Count) ~ Years_Since_Mow * Years_Since_Cut + (1|Year) + (1|Transect), data=Modeling_Variables, family=binomial),
  "Burn+Mow+Cut"=glmer(cbind(Robinia_Count, Total_Count-Robinia_Count) ~ Years_Since_Burn + Years_Since_Mow + Years_Since_Cut + (1|Year) + (1|Transect), data=Modeling_Variables, family=binomial),
  "Burn*Mow*Cut"=glmer(cbind(Robinia_Count, Total_Count-Robinia_Count) ~ Years_Since_Burn * Years_Since_Mow * Years_Since_Cut + (1|Year) + (1|Transect), data=Modeling_Variables, family=binomial))

#Compare Models
compare_performance(Robinia_Binom_Prop_Manage_Models, rank=TRUE)
plot(compare_performance(Robinia_Binom_Prop_Manage_Models))

#Clear Unneeded Items
rm(list=c("Robinia_Binom_Prop_Manage_Models"))
```

##### Combining Variable Groups

```{r Robinia Binomial Proportion Combined Model Selection, echo=TRUE}
#Run Models
Robinia_Binom_Prop_Combined_Models<-list(
  "Random"=glmer(cbind(Robinia_Count, Total_Count-Robinia_Count) ~ (1|Year) + (1|Transect), data=Modeling_Variables, family=binomial),
  "Precip"=glmer(cbind(Robinia_Count, Total_Count-Robinia_Count) ~ Total_Spring_Precip + (1|Year) + (1|Transect), data=Modeling_Variables, family=binomial),
  "Burn*Mow*Cut"=glmer(cbind(Robinia_Count, Total_Count-Robinia_Count) ~ Years_Since_Burn * Years_Since_Mow * Years_Since_Cut + (1|Year) + (1|Transect), data=Modeling_Variables, family=binomial),
  "Precip+(Burn*Mow*Cut)"=glmer(cbind(Robinia_Count, Total_Count-Robinia_Count) ~ Total_Spring_Precip + (Years_Since_Burn * Years_Since_Mow * Years_Since_Cut) + (1|Year) + (1|Transect), data=Modeling_Variables, family=binomial),
  "Precip*(Burn*Mow*Cut)"=glmer(cbind(Robinia_Count, Total_Count-Robinia_Count) ~ Total_Spring_Precip * (Years_Since_Burn * Years_Since_Mow * Years_Since_Cut) + (1|Year) + (1|Transect), data=Modeling_Variables, family=binomial))

#Compare Models
compare_performance(Robinia_Binom_Prop_Combined_Models, rank=TRUE)
plot(compare_performance(Robinia_Binom_Prop_Combined_Models))

#Select Best Model
Best_Robinia_Binom_Prop_Model<-glmer(cbind(Robinia_Count, Total_Count-Robinia_Count) ~ Total_Spring_Precip + (Years_Since_Burn * Years_Since_Mow * Years_Since_Cut) + (1|Year) + (1|Transect), data=Modeling_Variables, family=binomial)


#Clear Unneeded Items
rm(list=c("Robinia_Binom_Prop_Combined_Models"))
```

### Overall Best Robinia Model

#### Model Selection

```{r Best Overall Robinia Model, echo=TRUE}
#Run Models
Robinia_All_Models<-list(
  "Linear Percentage"=Best_Robinia_Percent_Model,
  "Poisson Count"=Best_Robinia_Count_P_Model,
  "Negative Binomial Count"=Best_Robinia_Count_NB_Model,
  "Binomial Proportion"=Best_Robinia_Binom_Prop_Model)

#Compare Models
compare_performance(Robinia_All_Models, rank=TRUE)
plot(compare_performance(Robinia_All_Models))
```

#### Model Summary

```{r Overall Best Robinia Model}
#Select Best Model
Best_Robinia_Model<-Best_Robinia_Binom_Prop_Model

#Model Summary
summary(Best_Robinia_Model)
model_performance(Best_Robinia_Model)

#Fancy Model Table
tab_model(Best_Robinia_Model, dv.labels="Proportion Robinia")

#Best Model Report
report(Best_Robinia_Model)

#Clear Unneeded Items
rm(list=c("Robinia_All_Models", "Best_Robinia_Percent_Model", "Best_Robinia_Count_P_Model", "Best_Robinia_Count_NB_Model", "Best_Robinia_Binom_Prop_Model"))
```

#### Model Diagnostics

```{r Best Robinia Model Diagnostics}
#Diagnostic Tests
plot(simulateResiduals(fittedModel=Best_Robinia_Model), title="Proportion of Robinia")

#Save DHARMa Plot
tiff("Output/Robinia_DHARMa.tif", width=8, height=4, units="in", res=300)
plot(simulateResiduals(fittedModel=Best_Robinia_Model), title="F Proportion of Robinia")
invisible(dev.off())
```

#### Effect Plots

Note: the best Robinia model was rank-deficient, so interaction effect plots can not be made.

```{r Best Robinia Model Effects Plots}
#Fixed Effects Coefficients Plot
Robinia_Effects<-plot(parameters(Best_Robinia_Model, effects="fixed")) +
  annotate("text", x=c(0.20,1.33), y=c(4.1,2.1), color=c("#458DE1","#458DE1"), label=c("*","*"), size=8)
Robinia_Effects
```

## Rubus

### Percent

#### Model Structure

Models were run using the functions `lm()` and `lmer()` from the R package [lme4](https://cran.r-project.org/web/packages/lme4/lme4.pdf), as the response variable is a percentage.

##### Random Effect Selection

Transect, Zone, and Year are grouping variables that may need to be accounted for as mixed effects when running models. Zone has fewer than five levels so it should not be used as a random effect on its own, however, each Transect is nested within a Zone. To determine the best structure of random effects, possible random effect structures based on the study design were modeled and the model with the best fixed effect structure of the group was selected using the R package [performance](https://cran.r-project.org/web/packages/performance/performance.pdf) function `compare_performance()`.

```{r Rubus Random Model Selection, echo=TRUE}
#Run Models
Rubus_Percent_Random_Models<-list(
  "Intercept"=lm(Percent_Rubus ~ 1, data=Modeling_Variables),
  "Year"=lmer(Percent_Rubus ~ (1|Year), data=Modeling_Variables),
  "Transect"=lmer(Percent_Rubus ~ (1|Transect), data=Modeling_Variables),
  "Zone/Transect"=lmer(Percent_Rubus ~ (1|Zone/Transect), data=Modeling_Variables),
  "Year+Transect"=lmer(Percent_Rubus ~ (1|Year) + (1|Transect), data=Modeling_Variables),
  "Year+Zone/Transect"=lmer(Percent_Rubus ~ (1|Year) + (1|Zone/Transect), data=Modeling_Variables))

#Compare Models
compare_performance(Rubus_Percent_Random_Models, rank=TRUE)
plot(compare_performance(Rubus_Percent_Random_Models))

#Clear Unneeded Items
rm(list=c("Rubus_Percent_Random_Models"))
```

##### Fixed Effect Selection

Additive model selection was conducted after splitting the predictor variables into two groups: the "Climate" variables "Total Spring Precipitation" and "Date of Last Freeze" and the "Management" predictor variables "Years Since Last Burn" and "Years Since Last Mow".

For all variable groups, all possible fixed effect structures (including models of two-way interactions for the Climate and Management variables) were modeled, and the model with the best fixed effect structure of the group was selected using the R package [performance](https://cran.r-project.org/web/packages/performance/performance.pdf) function `compare_performance()`. To build a final model, all additive combinations of the best fixed effect structures from each group were modeled and the best model was selected.

##### Weather Variables

```{r Rubus Weather Model Selection, echo=TRUE}
#Run Models
Rubus_Percent_Weather_Models<-list(
  "Random"=lmer(Percent_Rubus ~ (1|Year) + (1|Zone/Transect), data=Modeling_Variables),
  "Precip"=lmer(Percent_Rubus ~ Total_Spring_Precip + (1|Year) + (1|Zone/Transect), data=Modeling_Variables),
  "Freeze"=lmer(Percent_Rubus ~ Last_Freeze + (1|Year) + (1|Zone/Transect), data=Modeling_Variables),
  "Precip+Freeze"=lmer(Percent_Rubus ~ Total_Spring_Precip + Last_Freeze + (1|Year) + (1|Zone/Transect), data=Modeling_Variables),
  "Precip*Freeze"=lmer(Percent_Rubus ~ Total_Spring_Precip * Last_Freeze + (1|Year) + (1|Zone/Transect), data=Modeling_Variables))

#Compare Models
compare_performance(Rubus_Percent_Weather_Models, rank=TRUE)
plot(compare_performance(Rubus_Percent_Weather_Models))

#Clear Unneeded Items
rm(list=c("Rubus_Percent_Weather_Models"))
```

##### Management Variables

```{r Rubus Management Model Selection, echo=TRUE}
#Run Models
Rubus_Percent_Manage_Models<-list(
  "Random"=lmer(Percent_Rubus ~ (1|Year) + (1|Zone/Transect), data=Modeling_Variables),
  "Burn"=lmer(Percent_Rubus ~ Years_Since_Burn + (1|Year) + (1|Zone/Transect), data=Modeling_Variables),
  "Mow"=lmer(Percent_Rubus ~ Years_Since_Mow + (1|Year) + (1|Zone/Transect), data=Modeling_Variables),
  "Burn+Mow"=lmer(Percent_Rubus ~ Years_Since_Burn + Years_Since_Mow + (1|Year) + (1|Zone/Transect), data=Modeling_Variables),
  "Burn*Mow"=lmer(Percent_Rubus ~ Years_Since_Burn * Years_Since_Mow + (1|Year) + (1|Zone/Transect), data=Modeling_Variables))

#Compare Models
compare_performance(Rubus_Percent_Manage_Models, rank=TRUE)
plot(compare_performance(Rubus_Percent_Manage_Models))

#Clear Unneeded Items
rm(list=c("Rubus_Percent_Manage_Models"))
```

##### Combining Variable Groups

```{r Rubus Combined Model Selection, echo=TRUE}
#Run Models
Rubus_Percent_Combined_Models<-list(
  "Random"=lmer(Percent_Rubus ~ (1|Year) + (1|Zone/Transect), data=Modeling_Variables),
  "Precip"=lmer(Percent_Rubus ~ Total_Spring_Precip + (1|Year) + (1|Zone/Transect), data=Modeling_Variables),
  "Burn+Mow"=lmer(Percent_Rubus ~ Years_Since_Burn + Years_Since_Mow + (1|Year) + (1|Zone/Transect), data=Modeling_Variables),
  "Precip+(Burn+Mow)"=lmer(Percent_Rubus ~ Total_Spring_Precip + (Years_Since_Burn + Years_Since_Mow) + (1|Year) + (1|Zone/Transect), data=Modeling_Variables),
  "Precip*(Burn+Mow)"=lmer(Percent_Rubus ~ Total_Spring_Precip * (Years_Since_Burn + Years_Since_Mow) + (1|Year) + (1|Zone/Transect), data=Modeling_Variables))

#Compare Models
compare_performance(Rubus_Percent_Combined_Models, rank=TRUE)
plot(compare_performance(Rubus_Percent_Combined_Models))

#Select Best Model
Best_Rubus_Percent_Model<-lmer(Percent_Rubus ~ Total_Spring_Precip + (1|Year) + (1|Zone/Transect), data=Modeling_Variables)

#Clear Unneeded Items
rm(list=c("Rubus_Percent_Combined_Models"))
```

### Poisson Count

#### Model Structure

Models were run using the functions `glm()` and `glmer()` from the R package [lme4](https://cran.r-project.org/web/packages/lme4/lme4.pdf) with family=Poisson, as the response variable is a count variable.

##### Random Effect Selection

Transect, Zone, and Year are grouping variables that may need to be accounted for as mixed effects when running models. Zone has fewer than five levels so it should not be used as a random effect on its own, however, each Transect is nested within a Zone. To determine the best structure of random effects, possible random effect structures based on the study design were modeled and the model with the best fixed effect structure of the group was selected using the R package [performance](https://cran.r-project.org/web/packages/performance/performance.pdf) function `compare_performance()`.

```{r Rubus Count Random Model Selection, echo=TRUE}
#Run Models
Rubus_Count_P_Random_Models<-list(
  "Intercept"=glm(Rubus_Count ~ 1, data=Modeling_Variables, family=poisson),
  "Year"=glmer(Rubus_Count ~ (1|Year), data=Modeling_Variables, family=poisson),
  "Transect"=glmer(Rubus_Count ~ (1|Transect), data=Modeling_Variables, family=poisson),
  "Zone/Transect"=glmer(Rubus_Count ~ (1|Zone/Transect), data=Modeling_Variables, family=poisson),
  "Year+Transect"=glmer(Rubus_Count ~ (1|Year) + (1|Transect), data=Modeling_Variables, family=poisson),
  "Year+Zone/Transect"=glmer(Rubus_Count ~ (1|Year) + (1|Zone/Transect), data=Modeling_Variables, family=poisson))

#Compare Models
compare_performance(Rubus_Count_P_Random_Models, rank=TRUE)
plot(compare_performance(Rubus_Count_P_Random_Models))

#Clear Unneeded Items
rm(list=c("Rubus_Count_P_Random_Models"))
```

##### Fixed Effect Selection

Additive model selection was conducted after splitting the predictor variables into two groups: the "Climate" variables "Total Spring Precipitation" and "Date of Last Freeze" and the "Management" predictor variables "Years Since Last Burn" and "Years Since Last Mow".

For all variable groups, all possible fixed effect structures (including models of two-way interactions for the Climate and Management variables) were modeled, and the model with the best fixed effect structure of the group was selected using the R package [performance](https://cran.r-project.org/web/packages/performance/performance.pdf) function `compare_performance()`. To build a final model, all additive combinations of the best fixed effect structures from each group were modeled and the best model was selected.

##### Weather Variables

```{r Rubus Count Weather Model Selection, echo=TRUE}
#Run Models
Rubus_Count_P_Weather_Models<-list(
  "Random"=glmer(Rubus_Count ~ (1|Year) + (1|Transect), data=Modeling_Variables, family=poisson),
  "Precip"=glmer(Rubus_Count ~ Total_Spring_Precip + (1|Year) + (1|Transect), data=Modeling_Variables, family=poisson),
  "Freeze"=glmer(Rubus_Count ~ Last_Freeze + (1|Year) + (1|Transect), data=Modeling_Variables, family=poisson),
  "Precip+Freeze"=glmer(Rubus_Count ~ Total_Spring_Precip + Last_Freeze + (1|Year) + (1|Transect), data=Modeling_Variables, family=poisson),
  "Precip*Freeze"=glmer(Rubus_Count ~ Total_Spring_Precip * Last_Freeze + (1|Year) + (1|Transect), data=Modeling_Variables, family=poisson))

#Compare Models
compare_performance(Rubus_Count_P_Weather_Models, rank=TRUE)
plot(compare_performance(Rubus_Count_P_Weather_Models))

#Clear Unneeded Items
rm(list=c("Rubus_Count_P_Weather_Models"))
```

##### Management Variables

```{r Rubus Count Management Model Selection, echo=TRUE}
#Run Models
Rubus_Count_P_Manage_Models<-list(
  "Random"=glmer(Rubus_Count ~ (1|Year) + (1|Transect), data=Modeling_Variables, family=poisson),
  "Burn"=glmer(Rubus_Count ~ Years_Since_Burn + (1|Year) + (1|Transect), data=Modeling_Variables, family=poisson),
  "Mow"=glmer(Rubus_Count ~ Years_Since_Mow + (1|Year) + (1|Transect), data=Modeling_Variables, family=poisson),
  "Burn+Mow"=glmer(Rubus_Count ~ Years_Since_Burn + Years_Since_Mow + (1|Year) + (1|Transect), data=Modeling_Variables, family=poisson),
  "Burn*Mow"=glmer(Rubus_Count ~ Years_Since_Burn * Years_Since_Mow + (1|Year) + (1|Transect), data=Modeling_Variables, family=poisson))

#Compare Models
compare_performance(Rubus_Count_P_Manage_Models, rank=TRUE)
plot(compare_performance(Rubus_Count_P_Manage_Models))

#Clear Unneeded Items
rm(list=c("Rubus_Count_P_Manage_Models"))
```

##### Combining Variable Groups

```{r Rubus Count Combined Model Selection, echo=TRUE}
#Run Models
Rubus_Count_P_Combined_Models<-list(
  "Random"=glmer(Rubus_Count ~ (1|Year) + (1|Transect), data=Modeling_Variables, family=poisson),
  "Precip"=glmer(Rubus_Count ~ Total_Spring_Precip + (1|Year) + (1|Transect), data=Modeling_Variables, family=poisson),
  "Burn"=glmer(Rubus_Count ~ Years_Since_Burn + (1|Year) + (1|Transect), data=Modeling_Variables, family=poisson),
  "Precip+Burn"=glmer(Rubus_Count ~ Total_Spring_Precip + Years_Since_Burn + (1|Year) + (1|Transect), data=Modeling_Variables, family=poisson),
  "Precip*Burn"=glmer(Rubus_Count ~ Total_Spring_Precip * Years_Since_Burn + (1|Year) + (1|Transect), data=Modeling_Variables, family=poisson))

#Compare Models
compare_performance(Rubus_Count_P_Combined_Models, rank=TRUE)
plot(compare_performance(Rubus_Count_P_Combined_Models))

#Select Best Model
Best_Rubus_Count_P_Model<-glmer(Rubus_Count ~ Total_Spring_Precip + (1|Year) + (1|Transect), data=Modeling_Variables, family=poisson)

#Clear Unneeded Items
rm(list=c("Rubus_Count_P_Combined_Models"))
```

### Negative Binomial Count

#### Model Structure

Models were run using the functions `glm.nb()` and `glmer.nb()` from the R package [MASS](https://cran.r-project.org/web/packages/MASS/MASS.pdf), as the response variable is a count variable.

##### Random Effect Selection

Transect, Zone, and Year are grouping variables that may need to be accounted for as mixed effects when running models. Zone has fewer than five levels so it should not be used as a random effect on its own, however, each Transect is nested within a Zone. To determine the best structure of random effects, possible random effect structures based on the study design were modeled and the model with the best fixed effect structure of the group was selected using the R package [performance](https://cran.r-project.org/web/packages/performance/performance.pdf) function `compare_performance()`.

```{r Rubus NB Count Random Model Selection, echo=TRUE}
#Run Models
Rubus_Count_NB_Random_Models<-list(
  "Intercept"=glm.nb(Rubus_Count ~ 1, data=Modeling_Variables),
  "Year"=glmer.nb(Rubus_Count ~ (1|Year), data=Modeling_Variables),
  "Transect"=glmer.nb(Rubus_Count ~ (1|Transect), data=Modeling_Variables),
  "Zone/Transect"=glmer.nb(Rubus_Count ~ (1|Zone/Transect), data=Modeling_Variables),
  "Year+Transect"=glmer.nb(Rubus_Count ~ (1|Year) + (1|Transect), data=Modeling_Variables),
  "Year+Zone/Transect"=glmer.nb(Rubus_Count ~ (1|Year) + (1|Zone/Transect), data=Modeling_Variables))

#Compare Models
compare_performance(Rubus_Count_NB_Random_Models, rank=TRUE)
plot(compare_performance(Rubus_Count_NB_Random_Models))

#Clear Unneeded Items
rm(list=c("Rubus_Count_NB_Random_Models"))
```

##### Fixed Effect Selection

Additive model selection was conducted after splitting the predictor variables into two groups: the "Climate" variables "Total Spring Precipitation" and "Date of Last Freeze" and the "Management" predictor variables "Years Since Last Burn" and "Years Since Last Mow".

For all variable groups, all possible fixed effect structures (including models of two-way interactions for the Climate and Management variables) were modeled, and the model with the best fixed effect structure of the group was selected using the R package [performance](https://cran.r-project.org/web/packages/performance/performance.pdf) function `compare_performance()`. To build a final model, all additive combinations of the best fixed effect structures from each group were modeled and the best model was selected.

##### Weather Variables

```{r Rubus NB Count Weather Model Selection, echo=TRUE}
#Run Models
Rubus_Count_NB_Weather_Models<-list(
  "Random"=glmer.nb(Rubus_Count ~ (1|Year) + (1|Transect), data=Modeling_Variables),
  "Precip"=glmer.nb(Rubus_Count ~ Total_Spring_Precip + (1|Year) + (1|Transect), data=Modeling_Variables),
  "Freeze"=glmer.nb(Rubus_Count ~ Last_Freeze + (1|Year) + (1|Transect), data=Modeling_Variables),
  "Precip+Freeze"=glmer.nb(Rubus_Count ~ Total_Spring_Precip + Last_Freeze + (1|Year) + (1|Transect), data=Modeling_Variables),
  "Precip*Freeze"=glmer.nb(Rubus_Count ~ Total_Spring_Precip * Last_Freeze + (1|Year) + (1|Transect), data=Modeling_Variables))

#Compare Models
compare_performance(Rubus_Count_NB_Weather_Models, rank=TRUE)
plot(compare_performance(Rubus_Count_NB_Weather_Models))

#Clear Unneeded Items
rm(list=c("Rubus_Count_NB_Weather_Models"))
```

##### Management Variables

```{r Rubus NB Count Management Model Selection, echo=TRUE}
#Run Models
Rubus_Count_NB_Manage_Models<-list(
  "Random"=glmer.nb(Rubus_Count ~ (1|Year) + (1|Transect), data=Modeling_Variables),
  "Burn"=glmer.nb(Rubus_Count ~ Years_Since_Burn + (1|Year) + (1|Transect), data=Modeling_Variables),
  "Mow"=glmer.nb(Rubus_Count ~ Years_Since_Mow + (1|Year) + (1|Transect), data=Modeling_Variables),
  "Burn+Mow"=glmer.nb(Rubus_Count ~ Years_Since_Burn + Years_Since_Mow + (1|Year) + (1|Transect), data=Modeling_Variables),
  "Burn*Mow"=glmer.nb(Rubus_Count ~ Years_Since_Burn * Years_Since_Mow + (1|Year) + (1|Transect), data=Modeling_Variables))

#Compare Models
compare_performance(Rubus_Count_NB_Manage_Models, rank=TRUE)
plot(compare_performance(Rubus_Count_NB_Manage_Models))

#Clear Unneeded Items
rm(list=c("Rubus_Count_NB_Manage_Models"))
```

##### Combining Variable Groups

```{r Rubus NB Count Combined Model Selection, echo=TRUE}
#Run Models
Rubus_Count_NB_Combined_Models<-list(
  "Random"=glmer.nb(Rubus_Count ~ (1|Year) + (1|Transect), data=Modeling_Variables),
  "Precip"=glmer.nb(Rubus_Count ~ Total_Spring_Precip + (1|Year) + (1|Transect), data=Modeling_Variables),
  "Burn+Mow"=glmer.nb(Rubus_Count ~ Years_Since_Burn + Years_Since_Mow + (1|Year) + (1|Transect), data=Modeling_Variables),
  "Precip+(Burn+Mow)"=glmer.nb(Rubus_Count ~ Total_Spring_Precip + (Years_Since_Burn + Years_Since_Mow) + (1|Year) + (1|Transect), data=Modeling_Variables),
  "Precip+(Burn*Mow)"=glmer.nb(Rubus_Count ~ Total_Spring_Precip * (Years_Since_Burn + Years_Since_Mow) + (1|Year) + (1|Transect), data=Modeling_Variables))

#Compare Models
compare_performance(Rubus_Count_NB_Combined_Models, rank=TRUE)
plot(compare_performance(Rubus_Count_NB_Combined_Models))

#Select Best Model
Best_Rubus_Count_NB_Model<-glmer.nb(Rubus_Count ~ Total_Spring_Precip + (1|Year) + (1|Transect), data=Modeling_Variables)

#Clear Unneeded Items
rm(list=c("Rubus_Count_NB_Combined_Models"))
```

### Binomial Proportion

#### Model Structure

Models were run using the functions `glm()` and `glmer()` from the R package [lme4](https://cran.r-project.org/web/packages/lme4/lme4.pdf) with family=Binomial, as the response variable is a proportion.

##### Random Effect Selection

Transect, Zone, and Year are grouping variables that may need to be accounted for as mixed effects when running models. Zone has fewer than five levels so it should not be used as a random effect on its own, however, each Transect is nested within a Zone. To determine the best structure of random effects, possible random effect structures based on the study design were modeled and the model with the best fixed effect structure of the group was selected using the R package [performance](https://cran.r-project.org/web/packages/performance/performance.pdf) function `compare_performance()`.

```{r Rubus Binomial Proportion Random Model Selection, echo=TRUE}
#Run Models
Rubus_Binom_Prop_Random_Models<-list(
  "Intercept"=glm(cbind(Rubus_Count, Total_Count-Rubus_Count) ~ 1, data=Modeling_Variables, family=binomial),
  "Year"=glmer(cbind(Rubus_Count, Total_Count-Rubus_Count) ~ (1|Year), data=Modeling_Variables, family=binomial),
  "Transect"=glmer(cbind(Rubus_Count, Total_Count-Rubus_Count) ~ (1|Transect), data=Modeling_Variables, family=binomial),
  "Zone/Transect"=glmer(cbind(Rubus_Count, Total_Count-Rubus_Count) ~ (1|Zone/Transect), data=Modeling_Variables, family=binomial),
  "Year+Transect"=glmer(cbind(Rubus_Count, Total_Count-Rubus_Count) ~ (1|Year) + (1|Transect), data=Modeling_Variables, family=binomial),
  "Year+Zone/Transect"=glmer(cbind(Rubus_Count, Total_Count-Rubus_Count) ~ (1|Year) + (1|Zone/Transect), data=Modeling_Variables, family=binomial))

#Compare Models
compare_performance(Rubus_Binom_Prop_Random_Models, rank=TRUE)
plot(compare_performance(Rubus_Binom_Prop_Random_Models))

#Clear Unneeded Items
rm(list=c("Rubus_Binom_Prop_Random_Models"))
```

##### Fixed Effect Selection

Additive model selection was conducted after splitting the predictor variables into two groups: the "Climate" variables "Total Spring Precipitation" and "Date of Last Freeze" and the "Management" predictor variables "Years Since Last Burn" and "Years Since Last Mow".

For all variable groups, all possible fixed effect structures (including models of two-way interactions for the Climate and Management variables) were modeled, and the model with the best fixed effect structure of the group was selected using the R package [performance](https://cran.r-project.org/web/packages/performance/performance.pdf) function `compare_performance()`. To build a final model, all additive combinations of the best fixed effect structures from each group were modeled and the best model was selected.

##### Weather Variables

```{r Rubus Binomial Proportion Weather Model Selection, echo=TRUE}
#Run Models
Rubus_Binom_Prop_Weather_Models<-list(
  "Random"=glmer(cbind(Rubus_Count, Total_Count-Rubus_Count) ~ (1|Year) + (1|Transect), data=Modeling_Variables, family=binomial),
  "Precip"=glmer(cbind(Rubus_Count, Total_Count-Rubus_Count) ~ Total_Spring_Precip + (1|Year) + (1|Transect), data=Modeling_Variables, family=binomial),
  "Freeze"=glmer(cbind(Rubus_Count, Total_Count-Rubus_Count) ~ Last_Freeze + (1|Year) + (1|Transect), data=Modeling_Variables, family=binomial),
  "Precip+Freeze"=glmer(cbind(Rubus_Count, Total_Count-Rubus_Count) ~ Total_Spring_Precip + Last_Freeze + (1|Year) + (1|Transect), data=Modeling_Variables, family=binomial),
  "Precip*Freeze"=glmer(cbind(Rubus_Count, Total_Count-Rubus_Count) ~ Total_Spring_Precip * Last_Freeze + (1|Year) + (1|Transect), data=Modeling_Variables, family=binomial))

#Compare Models
compare_performance(Rubus_Binom_Prop_Weather_Models, rank=TRUE)
plot(compare_performance(Rubus_Binom_Prop_Weather_Models))

#Clear Unneeded Items
rm(list=c("Rubus_Binom_Prop_Weather_Models"))
```

##### Management Variables

```{r Rubus Binomial Proportion Management Model Selection, echo=TRUE}
#Run Models
Rubus_Binom_Prop_Manage_Models<-list(
  "Random"=glmer(cbind(Rubus_Count, Total_Count-Rubus_Count) ~ (1|Year) + (1|Transect), data=Modeling_Variables, family=binomial),
  "Burn"=glmer(cbind(Rubus_Count, Total_Count-Rubus_Count) ~ Years_Since_Burn + (1|Year) + (1|Transect), data=Modeling_Variables, family=binomial),
  "Mow"=glmer(cbind(Rubus_Count, Total_Count-Rubus_Count) ~ Years_Since_Mow + (1|Year) + (1|Transect), data=Modeling_Variables, family=binomial),
  "Burn+Mow"=glmer(cbind(Rubus_Count, Total_Count-Rubus_Count) ~ Years_Since_Burn + Years_Since_Mow + (1|Year) + (1|Transect), data=Modeling_Variables, family=binomial),
  "Burn*Mow"=glmer(cbind(Rubus_Count, Total_Count-Rubus_Count) ~ Years_Since_Burn * Years_Since_Mow + (1|Year) + (1|Transect), data=Modeling_Variables, family=binomial))

#Compare Models
compare_performance(Rubus_Binom_Prop_Manage_Models, rank=TRUE)
plot(compare_performance(Rubus_Binom_Prop_Manage_Models))

#Clear Unneeded Items
rm(list=c("Rubus_Binom_Prop_Manage_Models"))
```

##### Combining Variable Groups

```{r Rubus Binomial Proportion Combined Model Selection, echo=TRUE}
#Run Models
Rubus_Binom_Prop_Combined_Models<-list(
  "Random"=glmer(cbind(Rubus_Count, Total_Count-Rubus_Count) ~ (1|Year) + (1|Transect), data=Modeling_Variables, family=binomial),
  "Precip"=glmer(cbind(Rubus_Count, Total_Count-Rubus_Count) ~ Total_Spring_Precip + (1|Year) + (1|Transect), data=Modeling_Variables, family=binomial),
  "Burn"=glmer(cbind(Rubus_Count, Total_Count-Rubus_Count) ~ Years_Since_Burn + (1|Year) + (1|Transect), data=Modeling_Variables, family=binomial),
  "Precip+Burn"=glmer(cbind(Rubus_Count, Total_Count-Rubus_Count) ~ Total_Spring_Precip + Years_Since_Burn + (1|Year) + (1|Transect), data=Modeling_Variables, family=binomial),
  "Precip*Burn"=glmer(cbind(Rubus_Count, Total_Count-Rubus_Count) ~ Total_Spring_Precip * Years_Since_Burn + (1|Year) + (1|Transect), data=Modeling_Variables, family=binomial))

#Compare Models
compare_performance(Rubus_Binom_Prop_Combined_Models, rank=TRUE)
plot(compare_performance(Rubus_Binom_Prop_Combined_Models))

#Select Best Model
Best_Rubus_Binom_Prop_Model<-glmer(cbind(Rubus_Count, Total_Count-Rubus_Count) ~ Total_Spring_Precip + (1|Year) + (1|Transect), data=Modeling_Variables, family=binomial)

#Clear Unneeded Items
rm(list=c("Rubus_Binom_Prop_Combined_Models"))
```

### Overall Best Rubus Model

#### Model Selection

```{r Best Overall Rubus Model, echo=TRUE}
#Run Models
Rubus_All_Models<-list(
  "Linear Percentage"=Best_Rubus_Percent_Model,
  "Poisson Count"=Best_Rubus_Count_P_Model,
  "Negative Binomial Count"=Best_Rubus_Count_NB_Model,
  "Binomial Proportion"=Best_Rubus_Binom_Prop_Model)

#Compare Models
compare_performance(Rubus_All_Models, rank=TRUE)
plot(compare_performance(Rubus_All_Models))
```

#### Model Summary

```{r Overall Best Rubus Model}
#Select Best Model
Best_Rubus_Model<-Best_Rubus_Count_NB_Model

#Model Summary
summary(Best_Rubus_Model)
model_performance(Best_Rubus_Model)

#Fancy Model Table
tab_model(Best_Rubus_Model, dv.labels="Number of Rubus")

#Best Model Report
report(Best_Rubus_Model)

#Clear Unneeded Items
rm(list=c("Rubus_All_Models", "Best_Rubus_Percent_Model", "Best_Rubus_Count_P_Model", "Best_Rubus_Count_NB_Model", "Best_Rubus_Binom_Prop_Model"))
```

#### Model Diagnostics

```{r Best Rubus Model Diagnostics}
#Diagnostic Tests
plot(simulateResiduals(fittedModel=Best_Rubus_Model), title="Number of Rubus")

#Save DHARMa Plot
tiff("Output/Rubus_DHARMa.tif", width=8, height=4, units="in", res=300)
plot(simulateResiduals(fittedModel=Best_Rubus_Model), title="G Number of Rubus")
invisible(dev.off())
```

#### Effect Plots

```{r Best Rubus Model Effects Plots}
#Fixed Effects Coefficients Plot
Rubus_Effects<-plot(parameters(Best_Rubus_Model, effects="fixed"))
Rubus_Effects

#Effects Plot
plot(allEffects(Best_Rubus_Model), main="")

#Print Effects Plot
tiff("Output/Rubus_Model_Effects.tif", width=10, height=5, units="in", res=300, bg="transparent")
plot(allEffects(Best_Rubus_Model), main="")
invisible(dev.off())
```

## Celastrus

### Percent

#### Model Structure

Models were run using the functions `lm()` and `lmer()` from the R package [lme4](https://cran.r-project.org/web/packages/lme4/lme4.pdf), as the response variable is a percentage.

##### Random Effect Selection

Transect, Zone, and Year are grouping variables that may need to be accounted for as mixed effects when running models. Zone has fewer than five levels so it should not be used as a random effect on its own, however, each Transect is nested within a Zone. To determine the best structure of random effects, possible random effect structures based on the study design were modeled and the model with the best fixed effect structure of the group was selected using the R package [performance](https://cran.r-project.org/web/packages/performance/performance.pdf) function `compare_performance()`.

```{r Celastrus Random Model Selection, echo=TRUE}
#Run Models
Celastrus_Percent_Random_Models<-list(
  "Intercept"=lm(Percent_Celastrus ~ 1, data=Modeling_Variables),
  "Year"=lmer(Percent_Celastrus ~ (1|Year), data=Modeling_Variables),
  "Transect"=lmer(Percent_Celastrus ~ (1|Transect), data=Modeling_Variables),
  "Zone/Transect"=lmer(Percent_Celastrus ~ (1|Zone/Transect), data=Modeling_Variables),
  "Year+Transect"=lmer(Percent_Celastrus ~ (1|Year) + (1|Transect), data=Modeling_Variables),
  "Year+Zone/Transect"=lmer(Percent_Celastrus ~ (1|Year) + (1|Zone/Transect), data=Modeling_Variables))

#Compare Models
compare_performance(Celastrus_Percent_Random_Models, rank=TRUE)
plot(compare_performance(Celastrus_Percent_Random_Models))

#Clear Unneeded Items
rm(list=c("Celastrus_Percent_Random_Models"))
```

##### Fixed Effect Selection

Additive model selection was conducted after splitting the predictor variables into two groups: the "Climate" variables "Total Spring Precipitation" and "Date of Last Freeze" and the "Management" predictor variables "Years Since Last Burn" and "Years Since Last Mow".

For all variable groups, all possible fixed effect structures (including models of two-way interactions for the Climate and Management variables) were modeled, and the model with the best fixed effect structure of the group was selected using the R package [performance](https://cran.r-project.org/web/packages/performance/performance.pdf) function `compare_performance()`. To build a final model, all additive combinations of the best fixed effect structures from each group were modeled and the best model was selected.

##### Weather Variables

```{r Celastrus Weather Model Selection, echo=TRUE}
#Run Models
Celastrus_Percent_Weather_Models<-list(
  "Random"=lmer(Percent_Celastrus ~ (1|Year) + (1|Transect), data=Modeling_Variables),
  "Precip"=lmer(Percent_Celastrus ~ Total_Spring_Precip + (1|Year) + (1|Transect), data=Modeling_Variables),
  "Freeze"=lmer(Percent_Celastrus ~ Last_Freeze + (1|Year) + (1|Transect), data=Modeling_Variables),
  "Precip+Freeze"=lmer(Percent_Celastrus ~ Total_Spring_Precip + Last_Freeze + (1|Year) + (1|Transect), data=Modeling_Variables),
  "Precip*Freeze"=lmer(Percent_Celastrus ~ Total_Spring_Precip * Last_Freeze + (1|Year) + (1|Transect), data=Modeling_Variables))

#Compare Models
compare_performance(Celastrus_Percent_Weather_Models, rank=TRUE)
plot(compare_performance(Celastrus_Percent_Weather_Models))

#Clear Unneeded Items
rm(list=c("Celastrus_Percent_Weather_Models"))
```

##### Management Variables

```{r Celastrus Management Model Selection, echo=TRUE}
#Run Models
Celastrus_Percent_Manage_Models<-list(
  "Random"=lmer(Percent_Celastrus ~ (1|Year) + (1|Transect), data=Modeling_Variables),
  "Burn"=lmer(Percent_Celastrus ~ Years_Since_Burn + (1|Year) + (1|Transect), data=Modeling_Variables),
  "Mow"=lmer(Percent_Celastrus ~ Years_Since_Mow + (1|Year) + (1|Transect), data=Modeling_Variables),
  "Burn+Mow"=lmer(Percent_Celastrus ~ Years_Since_Burn + Years_Since_Mow + (1|Year) + (1|Transect), data=Modeling_Variables),
  "Burn*Mow"=lmer(Percent_Celastrus ~ Years_Since_Burn * Years_Since_Mow + (1|Year) + (1|Transect), data=Modeling_Variables))

#Compare Models
compare_performance(Celastrus_Percent_Manage_Models, rank=TRUE)
plot(compare_performance(Celastrus_Percent_Manage_Models))

#Clear Unneeded Items
rm(list=c("Celastrus_Percent_Manage_Models"))
```

##### Combining Variable Groups

```{r Celastrus Combined Model Selection, echo=TRUE}
#Run Models
Celastrus_Percent_Combined_Models<-list(
  "Random"=lmer(Percent_Celastrus ~ (1|Year) + (1|Transect), data=Modeling_Variables),
  "Precip"=lmer(Percent_Celastrus ~ Total_Spring_Precip + (1|Year) + (1|Transect), data=Modeling_Variables),
  "Burn*Mow"=lmer(Percent_Celastrus ~ Years_Since_Burn * Years_Since_Mow + (1|Year) + (1|Transect), data=Modeling_Variables),
  "Precip+(Burn*Mow)"=lmer(Percent_Celastrus ~ Total_Spring_Precip + (Years_Since_Burn * Years_Since_Mow) + (1|Year) + (1|Transect), data=Modeling_Variables),
  "Precip*(Burn*Mow)"=lmer(Percent_Celastrus ~ Total_Spring_Precip * (Years_Since_Burn * Years_Since_Mow) + (1|Year) + (1|Transect), data=Modeling_Variables))

#Compare Models
compare_performance(Celastrus_Percent_Combined_Models, rank=TRUE)
plot(compare_performance(Celastrus_Percent_Combined_Models))

#Select Best Model
Best_Celastrus_Percent_Model<-lmer(Percent_Celastrus ~ Total_Spring_Precip + (Years_Since_Burn * Years_Since_Mow) + (1|Year) + (1|Transect), data=Modeling_Variables)

#Clear Unneeded Items
rm(list=c("Celastrus_Percent_Combined_Models"))
```

### Poisson Count

#### Model Structure

Models were run using the functions `glm()` and `glmer()` from the R package [lme4](https://cran.r-project.org/web/packages/lme4/lme4.pdf) with family=Poisson, as the response variable is a count variable.

##### Random Effect Selection

Transect, Zone, and Year are grouping variables that may need to be accounted for as mixed effects when running models. Zone has fewer than five levels so it should not be used as a random effect on its own, however, each Transect is nested within a Zone. To determine the best structure of random effects, possible random effect structures based on the study design were modeled and the model with the best fixed effect structure of the group was selected using the R package [performance](https://cran.r-project.org/web/packages/performance/performance.pdf) function `compare_performance()`.

```{r Celastrus Count Random Model Selection, echo=TRUE}
#Run Models
Celastrus_Count_P_Random_Models<-list(
  "Intercept"=glm(Celastrus_Count ~ 1, data=Modeling_Variables, family=poisson),
  "Year"=glmer(Celastrus_Count ~ (1|Year), data=Modeling_Variables, family=poisson),
  "Transect"=glmer(Celastrus_Count ~ (1|Transect), data=Modeling_Variables, family=poisson),
  "Zone/Transect"=glmer(Celastrus_Count ~ (1|Zone/Transect), data=Modeling_Variables, family=poisson),
  "Year+Transect"=glmer(Celastrus_Count ~ (1|Year) + (1|Transect), data=Modeling_Variables, family=poisson),
  "Year+Zone/Transect"=glmer(Celastrus_Count ~ (1|Year) + (1|Zone/Transect), data=Modeling_Variables, family=poisson))

#Compare Models
compare_performance(Celastrus_Count_P_Random_Models, rank=TRUE)
plot(compare_performance(Celastrus_Count_P_Random_Models))

#Clear Unneeded Items
rm(list=c("Celastrus_Count_P_Random_Models"))
```

##### Fixed Effect Selection

Additive model selection was conducted after splitting the predictor variables into two groups: the "Climate" variables "Total Spring Precipitation" and "Date of Last Freeze" and the "Management" predictor variables "Years Since Last Burn" and "Years Since Last Mow".

For all variable groups, all possible fixed effect structures (including models of two-way interactions for the Climate and Management variables) were modeled, and the model with the best fixed effect structure of the group was selected using the R package [performance](https://cran.r-project.org/web/packages/performance/performance.pdf) function `compare_performance()`. To build a final model, all additive combinations of the best fixed effect structures from each group were modeled and the best model was selected.

##### Weather Variables

```{r Celastrus Count Weather Model Selection, echo=TRUE}
#Run Models
Celastrus_Count_P_Weather_Models<-list(
  "Random"=glmer(Celastrus_Count ~ (1|Year) + (1|Transect), data=Modeling_Variables, family=poisson),
  "Precip"=glmer(Celastrus_Count ~ Total_Spring_Precip + (1|Year) + (1|Transect), data=Modeling_Variables, family=poisson),
  "Freeze"=glmer(Celastrus_Count ~ Last_Freeze + (1|Year) + (1|Transect), data=Modeling_Variables, family=poisson),
  "Precip+Freeze"=glmer(Celastrus_Count ~ Total_Spring_Precip + Last_Freeze + (1|Year) + (1|Transect), data=Modeling_Variables, family=poisson),
  "Precip*Freeze"=glmer(Celastrus_Count ~ Total_Spring_Precip * Last_Freeze + (1|Year) + (1|Transect), data=Modeling_Variables, family=poisson))

#Compare Models
compare_performance(Celastrus_Count_P_Weather_Models, rank=TRUE)
plot(compare_performance(Celastrus_Count_P_Weather_Models))

#Clear Unneeded Items
rm(list=c("Celastrus_Count_P_Weather_Models"))
```

##### Management Variables

```{r Celastrus Count Management Model Selection, echo=TRUE}
#Run Models
Celastrus_Count_P_Manage_Models<-list(
  "Random"=glmer(Celastrus_Count ~ (1|Year) + (1|Transect), data=Modeling_Variables, family=poisson),
  "Burn"=glmer(Celastrus_Count ~ Years_Since_Burn + (1|Year) + (1|Transect), data=Modeling_Variables, family=poisson),
  "Mow"=glmer(Celastrus_Count ~ Years_Since_Mow + (1|Year) + (1|Transect), data=Modeling_Variables, family=poisson),
  "Burn+Mow"=glmer(Celastrus_Count ~ Years_Since_Burn + Years_Since_Mow + (1|Year) + (1|Transect), data=Modeling_Variables, family=poisson),
  "Burn*Mow"=glmer(Celastrus_Count ~ Years_Since_Burn * Years_Since_Mow + (1|Year) + (1|Transect), data=Modeling_Variables, family=poisson))

#Compare Models
compare_performance(Celastrus_Count_P_Manage_Models, rank=TRUE)
plot(compare_performance(Celastrus_Count_P_Manage_Models))

#Clear Unneeded Items
rm(list=c("Celastrus_Count_P_Manage_Models"))
```

##### Combining Variable Groups

```{r Celastrus Count Combined Model Selection, echo=TRUE}
#Run Models
Celastrus_Count_P_Combined_Models<-list(
  "Random"=glmer(Celastrus_Count ~ (1|Year) + (1|Transect), data=Modeling_Variables, family=poisson),
  "Precip+Freeze"=glmer(Celastrus_Count ~ Total_Spring_Precip + Last_Freeze + (1|Year) + (1|Transect), data=Modeling_Variables, family=poisson),
  "Burn"=glmer(Celastrus_Count ~ Years_Since_Burn + (1|Year) + (1|Transect), data=Modeling_Variables, family=poisson),
  "(Precip+Freeze)+Burn"=glmer(Celastrus_Count ~ (Total_Spring_Precip + Last_Freeze) + Years_Since_Burn + (1|Year) + (1|Transect), data=Modeling_Variables, family=poisson),
  "(Precip+Freeze)*Burn"=glmer(Celastrus_Count ~ (Total_Spring_Precip + Last_Freeze) * Years_Since_Burn + (1|Year) + (1|Transect), data=Modeling_Variables, family=poisson))

#Compare Models
compare_performance(Celastrus_Count_P_Combined_Models, rank=TRUE)
plot(compare_performance(Celastrus_Count_P_Combined_Models))

#Select Best Model
Best_Celastrus_Count_P_Model<-glmer(Celastrus_Count ~ (Total_Spring_Precip + Last_Freeze) * Years_Since_Burn + (1|Year) + (1|Transect), data=Modeling_Variables, family=poisson)

#Clear Unneeded Items
rm(list=c("Celastrus_Count_P_Combined_Models"))
```

### Negative Binomial Count

#### Model Structure

Models were run using the functions `glm.nb()` and `glmer.nb()` from the R package [MASS](https://cran.r-project.org/web/packages/MASS/MASS.pdf), as the response variable is a count variable.

##### Random Effect Selection

Transect, Zone, and Year are grouping variables that may need to be accounted for as mixed effects when running models. Zone has fewer than five levels so it should not be used as a random effect on its own, however, each Transect is nested within a Zone. To determine the best structure of random effects, possible random effect structures based on the study design were modeled and the model with the best fixed effect structure of the group was selected using the R package [performance](https://cran.r-project.org/web/packages/performance/performance.pdf) function `compare_performance()`.

```{r Celastrus NB Count Random Model Selection, echo=TRUE}
#Run Models
Celastrus_Count_NB_Random_Models<-list(
  "Intercept"=glm.nb(Celastrus_Count ~ 1, data=Modeling_Variables),
  "Year"=glmer.nb(Celastrus_Count ~ (1|Year), data=Modeling_Variables),
  "Transect"=glmer.nb(Celastrus_Count ~ (1|Transect), data=Modeling_Variables),
  "Zone/Transect"=glmer.nb(Celastrus_Count ~ (1|Zone/Transect), data=Modeling_Variables),
  "Year+Transect"=glmer.nb(Celastrus_Count ~ (1|Year) + (1|Transect), data=Modeling_Variables),
  "Year+Zone/Transect"=glmer.nb(Celastrus_Count ~ (1|Year) + (1|Zone/Transect), data=Modeling_Variables))

#Compare Models
compare_performance(Celastrus_Count_NB_Random_Models, rank=TRUE)
plot(compare_performance(Celastrus_Count_NB_Random_Models))

#Clear Unneeded Items
rm(list=c("Celastrus_Count_NB_Random_Models"))
```

##### Fixed Effect Selection

Additive model selection was conducted after splitting the predictor variables into two groups: the "Climate" variables "Total Spring Precipitation" and "Date of Last Freeze" and the "Management" predictor variables "Years Since Last Burn" and "Years Since Last Mow".

For all variable groups, all possible fixed effect structures (including models of two-way interactions for the Climate and Management variables) were modeled, and the model with the best fixed effect structure of the group was selected using the R package [performance](https://cran.r-project.org/web/packages/performance/performance.pdf) function `compare_performance()`. To build a final model, all additive combinations of the best fixed effect structures from each group were modeled and the best model was selected.

##### Weather Variables

```{r Celastrus NB Count Weather Model Selection, echo=TRUE}
#Run Models
Celastrus_Count_NB_Weather_Models<-list(
  "Random"=glmer.nb(Celastrus_Count ~ (1|Year) + (1|Transect), data=Modeling_Variables),
  "Precip"=glmer.nb(Celastrus_Count ~ Total_Spring_Precip + (1|Year) + (1|Transect), data=Modeling_Variables),
  "Freeze"=glmer.nb(Celastrus_Count ~ Last_Freeze + (1|Year) + (1|Transect), data=Modeling_Variables),
  "Precip+Freeze"=glmer.nb(Celastrus_Count ~ Total_Spring_Precip + Last_Freeze + (1|Year) + (1|Transect), data=Modeling_Variables),
  "Precip*Freeze"=glmer.nb(Celastrus_Count ~ Total_Spring_Precip * Last_Freeze + (1|Year) + (1|Transect), data=Modeling_Variables))

#Compare Models
compare_performance(Celastrus_Count_NB_Weather_Models, rank=TRUE)
plot(compare_performance(Celastrus_Count_NB_Weather_Models))

#Clear Unneeded Items
rm(list=c("Celastrus_Count_NB_Weather_Models"))
```

##### Management Variables

```{r Celastrus NB Count Management Model Selection, echo=TRUE}
#Run Models
Celastrus_Count_NB_Manage_Models<-list(
  "Random"=glmer.nb(Celastrus_Count ~ (1|Year) + (1|Transect), data=Modeling_Variables),
  "Burn"=glmer.nb(Celastrus_Count ~ Years_Since_Burn + (1|Year) + (1|Transect), data=Modeling_Variables),
  "Mow"=glmer.nb(Celastrus_Count ~ Years_Since_Mow + (1|Year) + (1|Transect), data=Modeling_Variables),
  "Burn+Mow"=glmer.nb(Celastrus_Count ~ Years_Since_Burn + Years_Since_Mow + (1|Year) + (1|Transect), data=Modeling_Variables),
  "Burn*Mow"=glmer.nb(Celastrus_Count ~ Years_Since_Burn * Years_Since_Mow + (1|Year) + (1|Transect), data=Modeling_Variables))

#Compare Models
compare_performance(Celastrus_Count_NB_Manage_Models, rank=TRUE)
plot(compare_performance(Celastrus_Count_NB_Manage_Models))

#Clear Unneeded Items
rm(list=c("Celastrus_Count_NB_Manage_Models"))
```

##### Combining Variable Groups

```{r Celastrus NB Count Combined Model Selection, echo=TRUE}
#Run Models
Celastrus_Count_NB_Combined_Models<-list(
  "Random"=glmer.nb(Celastrus_Count ~ (1|Year) + (1|Transect), data=Modeling_Variables),
  "Precip+Freeze"=glmer.nb(Celastrus_Count ~ Total_Spring_Precip + Last_Freeze + (1|Year) + (1|Transect), data=Modeling_Variables),
  "Burn"=glmer.nb(Celastrus_Count ~ Years_Since_Burn + (1|Year) + (1|Transect), data=Modeling_Variables),
  "(Precip+Freeze)+Burn"=glmer.nb(Celastrus_Count ~ (Total_Spring_Precip + Last_Freeze) + Years_Since_Burn + (1|Year) + (1|Transect), data=Modeling_Variables),
  "(Precip+Freeze)*Burn"=glmer.nb(Celastrus_Count ~ (Total_Spring_Precip + Last_Freeze) * Years_Since_Burn + (1|Year) + (1|Transect), data=Modeling_Variables))

#Compare Models
compare_performance(Celastrus_Count_NB_Combined_Models, rank=TRUE)
plot(compare_performance(Celastrus_Count_NB_Combined_Models))

#Select Best Model
Best_Celastrus_Count_NB_Model<-glmer.nb(Celastrus_Count ~ (Total_Spring_Precip + Last_Freeze) * Years_Since_Burn + (1|Year) + (1|Transect), data=Modeling_Variables)

#Clear Unneeded Items
rm(list=c("Celastrus_Count_NB_Combined_Models"))
```

### Binomial Proportion

#### Model Structure

Models were run using the functions `glm()` and `glmer()` from the R package [lme4](https://cran.r-project.org/web/packages/lme4/lme4.pdf) with family=Binomial, as the response variable is a proportion.

##### Random Effect Selection

Transect, Zone, and Year are grouping variables that may need to be accounted for as mixed effects when running models. Zone has fewer than five levels so it should not be used as a random effect on its own, however, each Transect is nested within a Zone. To determine the best structure of random effects, possible random effect structures based on the study design were modeled and the model with the best fixed effect structure of the group was selected using the R package [performance](https://cran.r-project.org/web/packages/performance/performance.pdf) function `compare_performance()`.

```{r Celastrus Binomial Proportion Random Model Selection, echo=TRUE}
#Run Models
Celastrus_Binom_Prop_Random_Models<-list(
  "Intercept"=glm(cbind(Celastrus_Count, Total_Count-Celastrus_Count) ~ 1, data=Modeling_Variables, family=binomial),
  "Year"=glmer(cbind(Celastrus_Count, Total_Count-Celastrus_Count) ~ (1|Year), data=Modeling_Variables, family=binomial),
  "Transect"=glmer(cbind(Celastrus_Count, Total_Count-Celastrus_Count) ~ (1|Transect), data=Modeling_Variables, family=binomial),
  "Zone/Transect"=glmer(cbind(Celastrus_Count, Total_Count-Celastrus_Count) ~ (1|Zone/Transect), data=Modeling_Variables, family=binomial),
  "Year+Transect"=glmer(cbind(Celastrus_Count, Total_Count-Celastrus_Count) ~ (1|Year) + (1|Transect), data=Modeling_Variables, family=binomial),
  "Year+Zone/Transect"=glmer(cbind(Celastrus_Count, Total_Count-Celastrus_Count) ~ (1|Year) + (1|Zone/Transect), data=Modeling_Variables, family=binomial))

#Compare Models
compare_performance(Celastrus_Binom_Prop_Random_Models, rank=TRUE)
plot(compare_performance(Celastrus_Binom_Prop_Random_Models))

#Clear Unneeded Items
rm(list=c("Celastrus_Binom_Prop_Random_Models"))
```

##### Fixed Effect Selection

Additive model selection was conducted after splitting the predictor variables into two groups: the "Climate" variables "Total Spring Precipitation" and "Date of Last Freeze" and the "Management" predictor variables "Years Since Last Burn" and "Years Since Last Mow".

For all variable groups, all possible fixed effect structures (including models of two-way interactions for the Climate and Management variables) were modeled, and the model with the best fixed effect structure of the group was selected using the R package [performance](https://cran.r-project.org/web/packages/performance/performance.pdf) function `compare_performance()`. To build a final model, all additive combinations of the best fixed effect structures from each group were modeled and the best model was selected.

##### Weather Variables

```{r Celastrus Binomial Proportion Weather Model Selection, echo=TRUE}
#Run Models
Celastrus_Binom_Prop_Weather_Models<-list(
  "Random"=glmer(cbind(Celastrus_Count, Total_Count-Celastrus_Count) ~ (1|Year) + (1|Transect), data=Modeling_Variables, family=binomial),
  "Precip"=glmer(cbind(Celastrus_Count, Total_Count-Celastrus_Count) ~ Total_Spring_Precip + (1|Year) + (1|Transect), data=Modeling_Variables, family=binomial),
  "Freeze"=glmer(cbind(Celastrus_Count, Total_Count-Celastrus_Count) ~ Last_Freeze + (1|Year) + (1|Transect), data=Modeling_Variables, family=binomial),
  "Precip+Freeze"=glmer(cbind(Celastrus_Count, Total_Count-Celastrus_Count) ~ Total_Spring_Precip + Last_Freeze + (1|Year) + (1|Transect), data=Modeling_Variables, family=binomial),
  "Precip*Freeze"=glmer(cbind(Celastrus_Count, Total_Count-Celastrus_Count) ~ Total_Spring_Precip * Last_Freeze + (1|Year) + (1|Transect), data=Modeling_Variables, family=binomial))

#Compare Models
compare_performance(Celastrus_Binom_Prop_Weather_Models, rank=TRUE)
plot(compare_performance(Celastrus_Binom_Prop_Weather_Models))

#Clear Unneeded Items
rm(list=c("Celastrus_Binom_Prop_Weather_Models"))
```

##### Management Variables

```{r Celastrus Binomial Proportion Management Model Selection, echo=TRUE}
#Run Models
Celastrus_Binom_Prop_Manage_Models<-list(
  "Random"=glmer(cbind(Celastrus_Count, Total_Count-Celastrus_Count) ~ (1|Year) + (1|Transect), data=Modeling_Variables, family=binomial),
  "Burn"=glmer(cbind(Celastrus_Count, Total_Count-Celastrus_Count) ~ Years_Since_Burn + (1|Year) + (1|Transect), data=Modeling_Variables, family=binomial),
  "Mow"=glmer(cbind(Celastrus_Count, Total_Count-Celastrus_Count) ~ Years_Since_Mow + (1|Year) + (1|Transect), data=Modeling_Variables, family=binomial),
  "Burn+Mow"=glmer(cbind(Celastrus_Count, Total_Count-Celastrus_Count) ~ Years_Since_Burn + Years_Since_Mow + (1|Year) + (1|Transect), data=Modeling_Variables, family=binomial),
  "Burn*Mow"=glmer(cbind(Celastrus_Count, Total_Count-Celastrus_Count) ~ Years_Since_Burn * Years_Since_Mow + (1|Year) + (1|Transect), data=Modeling_Variables, family=binomial))

#Compare Models
compare_performance(Celastrus_Binom_Prop_Manage_Models, rank=TRUE)
plot(compare_performance(Celastrus_Binom_Prop_Manage_Models))

#Clear Unneeded Items
rm(list=c("Celastrus_Binom_Prop_Manage_Models"))
```

##### Combining Variable Groups

```{r Celastrus Binomial Proportion Combined Model Selection, echo=TRUE}
#Run Models
Celastrus_Binom_Prop_Combined_Models<-list(
  "Random"=glmer(cbind(Celastrus_Count, Total_Count-Celastrus_Count) ~ (1|Year) + (1|Transect), data=Modeling_Variables, family=binomial),
  "Precip+Freeze"=glmer(cbind(Celastrus_Count, Total_Count-Celastrus_Count) ~ Total_Spring_Precip + Last_Freeze + (1|Year) + (1|Transect), data=Modeling_Variables, family=binomial),
  "Burn"=glmer(cbind(Celastrus_Count, Total_Count-Celastrus_Count) ~ Years_Since_Burn + (1|Year) + (1|Transect), data=Modeling_Variables, family=binomial),
  "(Precip+Freeze)+Burn"=glmer(cbind(Celastrus_Count, Total_Count-Celastrus_Count) ~ (Total_Spring_Precip + Last_Freeze) + Years_Since_Burn + (1|Year) + (1|Transect), data=Modeling_Variables, family=binomial),
  "(Precip+Freeze)*Burn"=glmer(cbind(Celastrus_Count, Total_Count-Celastrus_Count) ~ (Total_Spring_Precip + Last_Freeze) * Years_Since_Burn + (1|Year) + (1|Transect), data=Modeling_Variables, family=binomial))

#Compare Models
compare_performance(Celastrus_Binom_Prop_Combined_Models, rank=TRUE)
plot(compare_performance(Celastrus_Binom_Prop_Combined_Models))

#Select Best Model
Best_Celastrus_Binom_Prop_Model<-glmer(cbind(Celastrus_Count, Total_Count-Celastrus_Count) ~ (Total_Spring_Precip + Last_Freeze) * Years_Since_Burn + (1|Year) + (1|Transect), data=Modeling_Variables, family=binomial)

#Clear Unneeded Items
rm(list=c("Celastrus_Binom_Prop_Combined_Models"))
```

### Overall Best Celastrus Model

#### Model Selection

```{r Best Overall Celastrus Model, echo=TRUE}
#Run Models
Celastrus_All_Models<-list(
  "Linear Percentage"=Best_Celastrus_Percent_Model,
  "Poisson Count"=Best_Celastrus_Count_P_Model,
  "Negative Binomial Count"=Best_Celastrus_Count_NB_Model,
  "Binomial Proportion"=Best_Celastrus_Binom_Prop_Model)

#Compare Models
compare_performance(Celastrus_All_Models, rank=TRUE)
plot(compare_performance(Celastrus_All_Models))
```

#### Model Summary

```{r Overall Best Celastrus Model}
#Select Best Model
Best_Celastrus_Model<-Best_Celastrus_Binom_Prop_Model

#Model Summary
summary(Best_Celastrus_Model)
model_performance(Best_Celastrus_Model)

#Fancy Model Table
tab_model(Best_Celastrus_Model, dv.labels="Proportion Celastrus")

#Best Model Report
report(Best_Celastrus_Model)

#Clear Unneeded Items
rm(list=c("Celastrus_All_Models", "Best_Celastrus_Percent_Model", "Best_Celastrus_Count_P_Model", "Best_Celastrus_Count_NB_Model", "Best_Celastrus_Binom_Prop_Model"))
```

#### Model Diagnostics

```{r Best Celastrus Model Diagnostics}
#Diagnostic Tests
plot(simulateResiduals(fittedModel=Best_Celastrus_Model), title="Proportion of Celastrus")

#Save DHARMa Plot
tiff("Output/Celastrus_DHARMa.tif", width=8, height=4, units="in", res=300)
plot(simulateResiduals(fittedModel=Best_Celastrus_Model), title="H Proportion of Celastrus")
invisible(dev.off())
```

#### Effect Plots

```{r Best Celastrus Model Effects Plots}
#Fixed Effects Coefficients Plot
Celastrus_Effects<-plot(parameters(Best_Celastrus_Model, effects="fixed"))
Celastrus_Effects

#Effects Plot
plot(allEffects(Best_Celastrus_Model), main="")

#Print Effects Plot
tiff("Output/Celastrus_Model_Effects.tif", width=10, height=5, units="in", res=300, bg="transparent")
plot(allEffects(Best_Celastrus_Model), main="")
invisible(dev.off())
```
```{r Plot All Residuals}
#Import DHARMA Plots
Woody_DHARMa<-grid::rasterGrob(tiff::readTIFF("Output/Woody_DHARMa.tif"))
Forb_DHARMa<-grid::rasterGrob(tiff::readTIFF("Output/Forb_DHARMa.tif"))
Graminoid_DHARMa<-grid::rasterGrob(tiff::readTIFF("Output/Graminoid_DHARMa.tif"))
Rare_DHARMa<-grid::rasterGrob(tiff::readTIFF("Output/Rare_DHARMa.tif"))
Exotic_DHARMa<-grid::rasterGrob(tiff::readTIFF("Output/Exotic_DHARMa.tif"))
Robinia_DHARMa<-grid::rasterGrob(tiff::readTIFF("Output/Robinia_DHARMa.tif"))
Rubus_DHARMa<-grid::rasterGrob(tiff::readTIFF("Output/Rubus_DHARMa.tif"))
Celastrus_DHARMa<-grid::rasterGrob(tiff::readTIFF("Output/Celastrus_DHARMa.tif"))

#Create DHARMa Panel Chart
tiff("Output/DHARMa_Panel.tif", width=6, height=6, units="in", res=300)
grid.arrange(Woody_DHARMa,
             Forb_DHARMa,
             Graminoid_DHARMa,
             Rare_DHARMa,
             Exotic_DHARMa,
             Robinia_DHARMa,
             Rubus_DHARMa,
             Celastrus_DHARMa,
             layout_matrix=rbind(c(1,2), c(3,4), c(5,6), c(7,8)))
invisible(dev.off())
```
```{r Plot All Effects}
#Create Fixed Effects Panel Chart
tiff("Output/Effects_Panel.tif", width=12, height=12, units="in", res=300)
grid.arrange(Woody_Effects+ggtitle("Percent Woody Plants")+theme(plot.title=element_text(hjust=0.5))+labs(tag="A"), 
             Forb_Effects+ggtitle("Percent Forbs")+theme(plot.title=element_text(hjust=0.5))+labs(tag="B"), 
             Graminoid_Effects+ggtitle("Percent Graminoids")+theme(plot.title=element_text(hjust=0.5))+labs(tag="C"), 
             Rare_Effects+ggtitle("Percent Rare Plants")+theme(plot.title=element_text(hjust=0.5))+labs(tag="D"),
             Exotic_Effects+ggtitle("Number of Exotic Plants")+theme(plot.title=element_text(hjust=0.5))+labs(tag="E"),
             Robinia_Effects+ggtitle("Proportion of Robinia")+theme(plot.title=element_text(hjust=0.5))+labs(tag="F"),
             Rubus_Effects+ggtitle("Number of Rubus")+theme(plot.title=element_text(hjust=0.5))+labs(tag="G"),
             Celastrus_Effects+ggtitle("Proportion of Celastrus")+theme(plot.title=element_text(hjust=0.5))+labs(tag="H"),
             layout_matrix=rbind(c(1,1,1,1,NA,2,2,2,2,2), c(1,1,1,1,NA,2,2,2,2,2), c(1,1,1,1,NA,2,2,2,2,2), c(3,3,3,3,NA,4,4,4,4,NA), c(3,3,3,3,NA,4,4,4,4,NA), c(3,3,3,3,NA,4,4,4,4,NA), c(5,5,5,5,NA,6,6,6,6,6), c(5,5,5,5,NA,6,6,6,6,6), c(5,5,5,5,NA,6,6,6,6,6), c(7,7,7,7,NA,8,8,8,8,8), c(7,7,7,7,NA,8,8,8,8,8), c(7,7,7,7,NA,8,8,8,8,8)))
invisible(dev.off())
```